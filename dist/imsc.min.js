var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.owns=function(c,p){return Object.prototype.hasOwnProperty.call(c,p)};$jscomp.assign="function"==typeof Object.assign?Object.assign:function(c,p){for(var f=1;f<arguments.length;f++){var b=arguments[f];if(b)for(var n in b)$jscomp.owns(b,n)&&(c[n]=b[n])}return c};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,p,f){c!=Array.prototype&&c!=Object.prototype&&(c[p]=f.value)};$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(c,p,f,b){if(p){f=$jscomp.global;c=c.split(".");for(b=0;b<c.length-1;b++){var n=c[b];n in f||(f[n]={});f=f[n]}c=c[c.length-1];b=f[c];p=p(b);p!=b&&null!=p&&$jscomp.defineProperty(f,c,{configurable:!0,writable:!0,value:p})}};$jscomp.polyfill("Object.assign",function(c){return c||$jscomp.assign},"es6","es3");$jscomp.polyfill("Object.entries",function(c){return c?c:function(c){var f=[],b;for(b in c)$jscomp.owns(c,b)&&f.push([b,c[b]]);return f}},"es8","es3");
$jscomp.polyfill("Math.sign",function(c){return c?c:function(c){c=Number(c);return 0===c||isNaN(c)?c:0<c?1:-1}},"es6","es3");$jscomp.checkEs6ConformanceViaProxy=function(){try{var c={},p=Object.create(new $jscomp.global.Proxy(c,{get:function(f,b,n){return f==c&&"q"==b&&n==p}}));return!0===p.q}catch(f){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var c=0;return function(p){return $jscomp.SYMBOL_PREFIX+(p||"")+c++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.iterator;c||(c=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[c]&&$jscomp.defineProperty(Array.prototype,c,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.asyncIterator;c||(c=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.arrayIterator=function(c){var p=0;return $jscomp.iteratorPrototype(function(){return p<c.length?{done:!1,value:c[p++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(c){$jscomp.initSymbolIterator();c={next:c};c[$jscomp.global.Symbol.iterator]=function(){return this};return c};$jscomp.makeIterator=function(c){$jscomp.initSymbolIterator();var p=c[Symbol.iterator];return p?p.call(c):$jscomp.arrayIterator(c)};
$jscomp.polyfill("WeakMap",function(c){function p(){if(!c||!Object.seal)return!1;try{var b=Object.seal({}),k=Object.seal({}),a=new c([[b,2],[k,3]]);if(2!=a.get(b)||3!=a.get(k))return!1;a.delete(b);a.set(k,4);return!a.has(b)&&4==a.get(k)}catch(l){return!1}}function f(b){$jscomp.owns(b,n)||$jscomp.defineProperty(b,n,{value:{}})}function b(b){var k=Object[b];k&&(Object[b]=function(a){f(a);return k(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(c&&$jscomp.ES6_CONFORMANCE)return c}else if(p())return c;
var n="$jscomp_hidden_"+Math.random();b("freeze");b("preventExtensions");b("seal");var k=0,r=function(b){this.id_=(k+=Math.random()+1).toString();if(b){$jscomp.initSymbol();$jscomp.initSymbolIterator();b=$jscomp.makeIterator(b);for(var c;!(c=b.next()).done;)c=c.value,this.set(c[0],c[1])}};r.prototype.set=function(b,k){f(b);if(!$jscomp.owns(b,n))throw Error("WeakMap key fail: "+b);b[n][this.id_]=k;return this};r.prototype.get=function(b){return $jscomp.owns(b,n)?b[n][this.id_]:void 0};r.prototype.has=
function(b){return $jscomp.owns(b,n)&&$jscomp.owns(b[n],this.id_)};r.prototype.delete=function(b){return $jscomp.owns(b,n)&&$jscomp.owns(b[n],this.id_)?delete b[n][this.id_]:!1};return r},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(c){function p(){if($jscomp.ASSUME_NO_NATIVE_MAP||!c||"function"!=typeof c||!c.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),a=new c($jscomp.makeIterator([[b,"s"]]));if("s"!=a.get(b)||1!=a.size||a.get({x:4})||a.set({x:4},"t")!=a||2!=a.size)return!1;var l=a.entries(),k=l.next();if(k.done||k.value[0]!=b||"s"!=k.value[1])return!1;k=l.next();return k.done||4!=k.value[0].x||"t"!=k.value[1]||!l.next().done?!1:!0}catch(m){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(c&&$jscomp.ES6_CONFORMANCE)return c}else if(p())return c;$jscomp.initSymbol();$jscomp.initSymbolIterator();var f=new WeakMap,b=function(b){this.data_={};this.head_=r();this.size=0;if(b){b=$jscomp.makeIterator(b);for(var a;!(a=b.next()).done;)a=a.value,this.set(a[0],a[1])}};b.prototype.set=function(b,a){b=0===b?0:b;var l=n(this,b);l.list||(l.list=this.data_[l.id]=[]);l.entry?l.entry.value=a:(l.entry={next:this.head_,previous:this.head_.previous,head:this.head_,
key:b,value:a},l.list.push(l.entry),this.head_.previous.next=l.entry,this.head_.previous=l.entry,this.size++);return this};b.prototype.delete=function(b){b=n(this,b);return b.entry&&b.list?(b.list.splice(b.index,1),b.list.length||delete this.data_[b.id],b.entry.previous.next=b.entry.next,b.entry.next.previous=b.entry.previous,b.entry.head=null,this.size--,!0):!1};b.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=r();this.size=0};b.prototype.has=function(b){return!!n(this,b).entry};
b.prototype.get=function(b){return(b=n(this,b).entry)&&b.value};b.prototype.entries=function(){return k(this,function(b){return[b.key,b.value]})};b.prototype.keys=function(){return k(this,function(b){return b.key})};b.prototype.values=function(){return k(this,function(b){return b.value})};b.prototype.forEach=function(b,a){for(var l=this.entries(),k;!(k=l.next()).done;)k=k.value,b.call(a,k[1],k[0],this)};b.prototype[Symbol.iterator]=b.prototype.entries;var n=function(b,a){var l=a&&typeof a;"object"==
l||"function"==l?f.has(a)?l=f.get(a):(l=""+ ++L,f.set(a,l)):l="p_"+a;var k=b.data_[l];if(k&&$jscomp.owns(b.data_,l))for(b=0;b<k.length;b++){var m=k[b];if(a!==a&&m.key!==m.key||a===m.key)return{id:l,list:k,index:b,entry:m}}return{id:l,list:k,index:-1,entry:void 0}},k=function(b,a){var l=b.head_;return $jscomp.iteratorPrototype(function(){if(l){for(;l.head!=b.head_;)l=l.previous;for(;l.next!=l.head;)return l=l.next,{done:!1,value:a(l)};l=null}return{done:!0,value:void 0}})},r=function(){var b={};return b.previous=
b.next=b.head=b},L=0;return b},"es6","es3");
$jscomp.polyfill("Set",function(c){function p(){if($jscomp.ASSUME_NO_NATIVE_SET||!c||"function"!=typeof c||!c.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),n=new c($jscomp.makeIterator([b]));if(!n.has(b)||1!=n.size||n.add(b)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var k=n.entries(),r=k.next();if(r.done||r.value[0]!=b||r.value[1]!=b)return!1;r=k.next();return r.done||r.value[0]==b||4!=r.value[0].x||r.value[1]!=r.value[0]?!1:k.next().done}catch(L){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(c&&$jscomp.ES6_CONFORMANCE)return c}else if(p())return c;$jscomp.initSymbol();$jscomp.initSymbolIterator();var f=function(b){this.map_=new Map;if(b){b=$jscomp.makeIterator(b);for(var c;!(c=b.next()).done;)this.add(c.value)}this.size=this.map_.size};f.prototype.add=function(b){b=0===b?0:b;this.map_.set(b,b);this.size=this.map_.size;return this};f.prototype.delete=function(b){b=this.map_.delete(b);this.size=this.map_.size;return b};f.prototype.clear=
function(){this.map_.clear();this.size=0};f.prototype.has=function(b){return this.map_.has(b)};f.prototype.entries=function(){return this.map_.entries()};f.prototype.values=function(){return this.map_.values()};f.prototype.keys=f.prototype.values;f.prototype[Symbol.iterator]=f.prototype.values;f.prototype.forEach=function(b,c){var k=this;this.map_.forEach(function(n){return b.call(c,n,n,k)})};return f},"es6","es3");
(function(c){"object"===typeof exports&&"undefined"!==typeof module?module.exports=c():"function"===typeof define&&define.amd?define([],c):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).imsc=c()})(function(){return function(){function c(p,f,b){function n(r,I){if(!f[r]){if(!p[r]){var a="function"==typeof require&&require;if(!I&&a)return a(r,!0);if(k)return k(r,!0);I=Error("Cannot find module '"+r+"'");throw I.code="MODULE_NOT_FOUND",I;}I=
f[r]={exports:{}};p[r][0].call(I.exports,function(a){return n(p[r][1][a]||a)},I,I.exports,c,p,f,b)}return f[r].exports}for(var k="function"==typeof require&&require,r=0;r<b.length;r++)n(b[r]);return n}return c}()({1:[function(c,p,f){(function(b,c,k,r,f){function n(a,g){var d=a.styleAttrs&&a.styleAttrs["http://www.w3.org/ns/ttml#styling backgroundColor"];if("span"===a.kind)!d&&g&&(a.styleAttrs||(a.styleAttrs={}),a.styleAttrs["http://www.w3.org/ns/ttml#styling backgroundColor"]=g);else if(d&&delete a.styleAttrs["http://www.w3.org/ns/ttml#styling backgroundColor"],
a.contents)for(var e=0;e<a.contents.length;e++)n(a.contents[e],d||g)}function a(g){if("contents"in g){var d="styleAttrs"in g?g.styleAttrs[r.byName.ruby.qname]:null;d="span"===g.kind&&("container"===d||"textContainer"===d||"baseContainer"===d);for(var e=g.contents.length-1;0<=e;e--)!d||"styleAttrs"in g.contents[e]&&r.byName.ruby.qname in g.contents[e].styleAttrs?a(g.contents[e]):delete g.contents[e]}}function l(g,a,d,e){var b=e&&"seq"===e.timeContainer,h=0;e&&(h=b&&d?d.end:e.begin);a.begin=a.explicit_begin?
a.explicit_begin+h:h;d=a.begin;e=null;for(var y in a.sets)l(g,a.sets[y],e,a),d="seq"===a.timeContainer?a.sets[y].end:Math.max(d,a.sets[y].end),e=a.sets[y];if("contents"in a)for(var k in a.contents)l(g,a.contents[k],e,a),d="seq"===a.timeContainer?a.contents[k].end:Math.max(d,a.contents[k].end),e=a.contents[k];else d=b?a.begin:Number.POSITIVE_INFINITY;a.end=null!==a.explicit_end&&null!==a.explicit_dur?Math.min(a.begin+a.explicit_dur,h+a.explicit_end):null===a.explicit_end&&null!==a.explicit_dur?a.begin+
a.explicit_dur:null!==a.explicit_end&&null===a.explicit_dur?h+a.explicit_end:d;delete a.explicit_begin;delete a.explicit_dur;delete a.explicit_end;g._registerEvent(a)}function E(a){this.node=a}function m(){this.events=[];this.head=new q;this.body=null}function q(){this.styling=new C;this.layout=new B}function C(){this.styles={};this.initials={}}function w(){this.styleRefs=this.styleAttrs=this.id=null}function p(){this.styleAttrs=null}function B(){this.regions={}}function u(a,g){this.kind="image";
this.src=a;this.type=g}function F(a){this.id=a}function g(a){this.regionID=a}function h(a){this.styleAttrs=a}function d(a){this.sets=a}function e(a){this.contents=a}function t(a,g,d){this.explicit_begin=a;this.explicit_end=g;this.explicit_dur=d}function v(){this.kind="body"}function P(){this.kind="div"}function x(){this.kind="p"}function M(){this.kind="span"}function R(){this.kind="span"}function A(){this.kind="br"}function N(){}function z(){}function L(a){var g=null;a&&(a=a.attributes["xml:id"]||
a.attributes.id)&&(g=a.value||null);return g}function G(a){return a&&"style"in a.attributes?a.attributes.style.value.split(" "):[]}function S(a,g){var d={};if(null!==a)for(var e in a.attributes){var b=a.attributes[e].uri+" "+a.attributes[e].local,l=r.byQName[b];if(void 0!==l){var h=l.parse(a.attributes[e].value);null!==h?(d[b]=h,l===r.byName.zIndex&&K(g,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):J(g,"Cannot parse styling attribute "+b+" --\x3e "+a.attributes[e].value)}}return d}
function O(a,g,d){for(var e in a.attributes)if(a.attributes[e].uri===g&&a.attributes[e].local===d)return a.attributes[e].value;return null}function Z(a,g){a=O(a,k.ns_tts,"extent");if(null===a)return null;var d=a.split(" ");if(2!==d.length)return K(g,"Malformed extent (ignoring)"),null;a=f.parseLength(d[0]);d=f.parseLength(d[1]);return d&&a?{h:d,w:a}:(K(g,"Malformed extent values (ignoring)"),null)}function U(a,g,d){var e=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/,b=/^(\d{2,}):(\d\d):(\d\d):(\d{2,})$/,l=
/^(\d+(?:\.\d+)?)t$/,h=/^(\d+(?:\.\d+)?)ms$/,k=/^(\d+(?:\.\d+)?)s$/,m=/^(\d+(?:\.\d+)?)h$/,c=/^(\d+(?:\.\d+)?)m$/,t,y=null;null!==(t=/^(\d+(?:\.\d+)?)f$/.exec(d))?null!==g&&(y=parseFloat(t[1])/g):null!==(t=l.exec(d))?null!==a&&(y=parseFloat(t[1])/a):null!==(t=h.exec(d))?y=parseFloat(t[1])/1E3:null!==(t=k.exec(d))?y=parseFloat(t[1]):null!==(t=m.exec(d))?y=3600*parseFloat(t[1]):null!==(t=c.exec(d))?y=60*parseFloat(t[1]):null!==(t=e.exec(d))?y=3600*parseInt(t[1])+60*parseInt(t[2])+parseFloat(t[3]):null!==
(t=b.exec(d))&&null!==g&&(y=3600*parseInt(t[1])+60*parseInt(t[2])+parseInt(t[3])+(null===t[4]?0:parseInt(t[4])/g));return y}function W(a,g,d){for(;0<g.styleRefs.length;){var e=g.styleRefs.pop();e in a.styles?(W(a,a.styles[e],d),V(a.styles[e].styleAttrs,g.styleAttrs)):J(d,"Non-existant style id referenced")}}function X(a,g,d,e){for(var b=g.length-1;0<=b;b--){var l=g[b];l in a.styles?V(a.styles[l].styleAttrs,d):J(e,"Non-existant style id referenced")}}function V(a,g){for(var d in a)d in g||(g[d]=a[d])}
function K(a,g){if(a&&a.warn&&a.warn(g))throw g;}function J(a,g){if(a&&a.error&&a.error(g))throw g;}function D(a,g){a&&a.fatal&&a.fatal(g);throw g;}function Y(a,g){for(var d=0,e=a.length-1,b;d<=e;){b=Math.floor((d+e)/2);var l=a[b];if(l<g)d=b+1;else if(l>g)e=b-1;else return{found:!0,index:b}}return{found:!1,index:d}}b.fromXML=function(g,d,e){var b=c.parser(!0,{xmlns:!0}),h=[],t=[],y=[],Q=0,f=null;b.onclosetag=function(a){if(h[0]instanceof N)null!==f.head&&null!==f.head.styling&&X(f.head.styling,h[0].styleRefs,
h[0].styleAttrs,d),delete h[0].styleRefs;else if(h[0]instanceof C)for(var g in h[0].styles)W(h[0],h[0].styles[g],d);else if(h[0]instanceof x||h[0]instanceof M){if(1<h[0].contents.length){a=[h[0].contents[0]];for(g=1;g<h[0].contents.length;g++)h[0].contents[g]instanceof R&&a[a.length-1]instanceof R?a[a.length-1].text+=h[0].contents[g].text:a.push(h[0].contents[g]);h[0].contents=a}h[0]instanceof M&&1===h[0].contents.length&&h[0].contents[0]instanceof R&&(h[0].text=h[0].contents[0].text,delete h[0].contents)}else if(h[0]instanceof
E)if(h[0].node.uri===k.ns_tt&&"metadata"===h[0].node.local)Q--;else if(0<Q&&e&&"onCloseTag"in e)e.onCloseTag();y.shift();t.shift();h.shift()};b.ontext=function(a){if(void 0!==h[0])if(h[0]instanceof M||h[0]instanceof x){if(h[0]instanceof M){var g=h[0].styleAttrs[r.byName.ruby.qname];if("container"===g||"textContainer"===g||"baseContainer"===g)return}g=new R;g.initFromText(f,h[0],a,y[0],d);h[0].contents.push(g)}else if(h[0]instanceof E&&0<Q&&e&&"onText"in e)e.onText(a)};b.onopentag=function(a){function g(a){k.ttaf_map[a.uri]&&
(a.uri=k.ttaf_map[a.uri])}var b=a.attributes["xml:space"];b?y.unshift(b.value):0===y.length?y.unshift("default"):y.unshift(y[0]);(b=a.attributes["xml:lang"])?t.unshift(b.value):0===t.length?t.unshift(""):t.unshift(t[0]);g(a);if(a.attributes)for(var l in a.attributes)a.attributes.hasOwnProperty(l)&&g(a.attributes[l]);if(a.uri===k.ns_tt)if("tt"===a.local)null!==f&&D(d,"Two <tt> elements at ("+this.line+","+this.column+")"),f=new m,f.initFromNode(a,d),h.unshift(f);else if("head"===a.local)h[0]instanceof
m||D(d,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),h.unshift(f.head);else if("styling"===a.local)h[0]instanceof q||D(d,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),h.unshift(f.head.styling);else if("style"===a.local)if(h[0]instanceof C){var c=new w;c.initFromNode(a,d);c.id?f.head.styling.styles[c.id]=c:J(d,"<style> element missing @id attribute");h.unshift(c)}else h[0]instanceof N?(c=new w,c.initFromNode(a,d),V(c.styleAttrs,h[0].styleAttrs),
h.unshift(c)):D(d,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")");else if("initial"===a.local)if(h[0]instanceof C){l=new p;l.initFromNode(a,d);for(c in l.styleAttrs)f.head.styling.initials[c]=l.styleAttrs[c];h.unshift(l)}else D(d,"Parent of <initial> element is not <styling> at ("+this.line+","+this.column+")");else if("layout"===a.local)h[0]instanceof q||D(d,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),h.unshift(f.head.layout);
else if("region"===a.local)h[0]instanceof B||D(d,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")"),c=new N,c.initFromNode(f,a,d),!c.id||c.id in f.head.layout.regions?J(d,"Ignoring <region> with duplicate or missing @id at "+this.line+","+this.column+")"):f.head.layout.regions[c.id]=c,h.unshift(c);else if("body"===a.local)h[0]instanceof m||D(d,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),null!==f.body&&D(d,"Second <body> element at "+this.line+
","+this.column+")"),c=new v,c.initFromNode(f,a,d),f.body=c,h.unshift(c);else if("div"===a.local){h[0]instanceof P||h[0]instanceof v||D(d,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")");c=new P;c.initFromNode(f,h[0],a,d);if(l=c.styleAttrs[r.byName.backgroundImage.qname])c.contents.push(new u(l)),delete c.styleAttrs[r.byName.backgroundImage.qname];h[0].contents.push(c);h.unshift(c)}else"image"===a.local?(h[0]instanceof P||D(d,"Parent of <image> element is not <div> at "+
this.line+","+this.column+")"),c=new u,c.initFromNode(f,h[0],a,d),h[0].contents.push(c),h.unshift(c)):"p"===a.local?(h[0]instanceof P||D(d,"Parent of <p> element is not <div> at "+this.line+","+this.column+")"),c=new x,c.initFromNode(f,h[0],a,d),h[0].contents.push(c),h.unshift(c)):"span"===a.local?(h[0]instanceof M||h[0]instanceof x||D(d,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")"),c=new M,c.initFromNode(f,h[0],a,y[0],d),h[0].contents.push(c),h.unshift(c)):"br"===
a.local?(h[0]instanceof M||h[0]instanceof x||D(d,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")"),c=new A,c.initFromNode(f,h[0],a,d),h[0].contents.push(c),h.unshift(c)):"set"===a.local?(h[0]instanceof M||h[0]instanceof x||h[0]instanceof P||h[0]instanceof v||h[0]instanceof N||h[0]instanceof A||D(d,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")"),c=new z,c.initFromNode(f,h[0],a,d),h[0].sets.push(c),h.unshift(c)):h.unshift(new E(a));
else h.unshift(new E(a));if(h[0]instanceof E)if(a.uri===k.ns_tt&&"metadata"===a.local)Q++;else if(0<Q&&e&&"onOpenTag"in e){c=[];for(var n in a.attributes)c[a.attributes[n].uri+" "+a.attributes[n].local]={uri:a.attributes[n].uri,local:a.attributes[n].local,value:a.attributes[n].value};e.onOpenTag(a.uri,a.local,c)}};b.write(g).close();delete f.head.styling.styles;g=!1;for(var T in f.head.layout.regions){g=!0;break}g||(T=N.prototype.createDefaultRegion(f,d),f.head.layout.regions[T.id]=T);for(var F in f.head.layout.regions)l(f,
f.head.layout.regions[F],null,null);f.body&&l(f,f.body,null,null);f.body&&a(f.body);f.body&&n(f.body);return f};m.prototype.initFromNode=function(a,g){var d=O(a,k.ns_ttp,"cellResolution"),h=15;var e=32;null!==d&&(d=/(\d+) (\d+)/.exec(d),null!==d?(e=parseInt(d[1]),h=parseInt(d[2])):K(g,"Malformed cellResolution value (using initial value instead)"));this.cellLength={h:new f.ComputedLength(0,1/h),w:new f.ComputedLength(1/e,0)};h=O(a,k.ns_ttp,"frameRate");d=30;null!==h&&(e=/(\d+)/.exec(h),null!==e?d=
parseInt(e[1]):K(g,"Malformed frame rate attribute (using initial value instead)"));e=O(a,k.ns_ttp,"frameRateMultiplier");var b=1;null!==e&&(e=/(\d+) (\d+)/.exec(e),null!==e?b=parseInt(e[1])/parseInt(e[2]):K(g,"Malformed frame rate multiplier attribute (using initial value instead)"));d*=b;b=1;e=O(a,k.ns_ttp,"tickRate");null===e?null!==h&&(b=d):(e=/(\d+)/.exec(e),null!==e?b=parseInt(e[1]):K(g,"Malformed tick rate attribute (using initial value instead)"));this.effectiveFrameRate=d;this.tickRate=b;
e=O(a,k.ns_ittp,"aspectRatio");null===e&&(e=O(a,k.ns_ttp,"displayAspectRatio"));h=null;null!==e&&(d=/(\d+)\s+(\d+)/.exec(e),null!==d?(e=parseInt(d[1]),d=parseInt(d[2]),0!==e&&0!==d?h=e/d:J(g,"Illegal aspectRatio values (ignoring)")):J(g,"Malformed aspectRatio attribute (ignoring)"));this.aspectRatio=h;h=O(a,k.ns_ttp,"timeBase");null!==h&&"media"!==h&&D(g,"Unsupported time base");a=Z(a,g);null===a?this.pxLength={h:null,w:null}:("px"===a.h.unit&&"px"===a.w.unit||D(g,"Extent on TT must be in px or absent"),
this.pxLength={h:new f.ComputedLength(0,1/a.h.value),w:new f.ComputedLength(1/a.w.value,0)});this.dimensions={h:new f.ComputedLength(0,1),w:new f.ComputedLength(1,0)}};m.prototype._registerEvent=function(a){if(!(a.end<=a.begin)){var g=Y(this.events,a.begin);g.found||this.events.splice(g.index,0,a.begin);a.end!==Number.POSITIVE_INFINITY&&(g=Y(this.events,a.end),g.found||this.events.splice(g.index,0,a.end))}};m.prototype.getMediaTimeRange=function(){return[this.events[0],this.events[this.events.length-
1]]};m.prototype.getMediaTimeEvents=function(){return this.events};w.prototype.initFromNode=function(a,g){this.id=L(a);this.styleAttrs=S(a,g);this.styleRefs=G(a)};p.prototype.initFromNode=function(a,g){this.styleAttrs={};for(var d in a.attributes)if(a.attributes[d].uri===k.ns_itts||a.attributes[d].uri===k.ns_ebutts||a.attributes[d].uri===k.ns_tts)this.styleAttrs[a.attributes[d].uri+" "+a.attributes[d].local]=a.attributes[d].value};u.prototype.initFromNode=function(a,e,b,l){(this.src="src"in b.attributes?
b.attributes.src.value:null)||J(l,"Invalid image@src attribute");(this.type="type"in b.attributes?b.attributes.type.value:null)||J(l,"Invalid image@type attribute");h.prototype.initFromNode.call(this,a,e,b,l);t.prototype.initFromNode.call(this,a,e,b,l);d.prototype.initFromNode.call(this,a,e,b,l);g.prototype.initFromNode.call(this,a,e,b,l)};F.prototype.initFromNode=function(a,g,d,e){this.id=L(d)};g.prototype.initFromNode=function(a,g,d,e){this.regionID=d&&"region"in d.attributes?d.attributes.region.value:
""};h.prototype.initFromNode=function(a,g,d,e){this.styleAttrs=S(d,e);null!==a.head&&null!==a.head.styling&&X(a.head.styling,G(d),this.styleAttrs,e)};d.prototype.initFromNode=function(a,g,d,e){this.sets=[]};e.prototype.initFromNode=function(a,g,d,e){this.contents=[]};t.prototype.initFromNode=function(a,g,d,e){g=null;d&&"begin"in d.attributes&&(g=U(a.tickRate,a.effectiveFrameRate,d.attributes.begin.value),null===g&&K(e,"Malformed begin value "+d.attributes.begin.value+" (using 0)"));var h=null;d&&
"dur"in d.attributes&&(h=U(a.tickRate,a.effectiveFrameRate,d.attributes.dur.value),null===h&&K(e,"Malformed dur value "+d.attributes.dur.value+" (ignoring)"));var b=null;d&&"end"in d.attributes&&(b=U(a.tickRate,a.effectiveFrameRate,d.attributes.end.value),null===b&&K(e,"Malformed end value (ignoring)"));this.explicit_begin=g;this.explicit_end=b;this.explicit_dur=h;(a=d&&"timeContainer"in d.attributes?d.attributes.timeContainer.value:null)&&"par"!==a?"seq"===a?e="seq":(J(e,"Illegal value of timeContainer (assuming 'par')"),
e="par"):e="par";this.timeContainer=e};v.prototype.initFromNode=function(a,b,l){h.prototype.initFromNode.call(this,a,null,b,l);t.prototype.initFromNode.call(this,a,null,b,l);d.prototype.initFromNode.call(this,a,null,b,l);g.prototype.initFromNode.call(this,a,null,b,l);e.prototype.initFromNode.call(this,a,null,b,l)};P.prototype.initFromNode=function(a,b,l,c){h.prototype.initFromNode.call(this,a,b,l,c);t.prototype.initFromNode.call(this,a,b,l,c);d.prototype.initFromNode.call(this,a,b,l,c);g.prototype.initFromNode.call(this,
a,b,l,c);e.prototype.initFromNode.call(this,a,b,l,c)};x.prototype.initFromNode=function(a,b,l,c){h.prototype.initFromNode.call(this,a,b,l,c);t.prototype.initFromNode.call(this,a,b,l,c);d.prototype.initFromNode.call(this,a,b,l,c);g.prototype.initFromNode.call(this,a,b,l,c);e.prototype.initFromNode.call(this,a,b,l,c)};M.prototype.initFromNode=function(a,b,l,c,k){h.prototype.initFromNode.call(this,a,b,l,k);t.prototype.initFromNode.call(this,a,b,l,k);d.prototype.initFromNode.call(this,a,b,l,k);g.prototype.initFromNode.call(this,
a,b,l,k);e.prototype.initFromNode.call(this,a,b,l,k);this.space=c};R.prototype.initFromText=function(a,d,g,e,h){t.prototype.initFromNode.call(this,a,d,null,h);this.text=g;this.space=e};A.prototype.initFromNode=function(a,d,e,h){g.prototype.initFromNode.call(this,a,d,e,h);t.prototype.initFromNode.call(this,a,d,e,h)};N.prototype.createDefaultRegion=function(a,d){var g=new N;g.id="";h.prototype.initFromNode.call(g,a,null,{name:"region",attributes:{"tts:displayAlign":{name:"tts:displayAlign",value:"after",
prefix:"tts",local:"displayAlign",uri:"http://www.w3.org/ns/ttml#styling"},"tts:extent":{name:"tts:extent",value:"80% 20%",prefix:"tts",local:"extent",uri:"http://www.w3.org/ns/ttml#styling"},"tts:origin":{name:"tts:origin",value:"10% 70%",prefix:"tts",local:"origin",uri:"http://www.w3.org/ns/ttml#styling"},"tts:overflow":{name:"tts:overflow",value:"visible",prefix:"tts",local:"overflow",uri:"http://www.w3.org/ns/ttml#styling"}},ns:{"":"http://www.w3.org/ns/ttml",ebuttm:"urn:ebu:tt:metadata",ebutts:"urn:ebu:tt:style",
ittp:"http://www.w3.org/ns/ttml/profile/imsc1#parameter",itts:"http://www.w3.org/ns/ttml/profile/imsc1#styling",ttm:"http://www.w3.org/ns/ttml#metadata",ttp:"http://www.w3.org/ns/ttml#parameter",tts:"http://www.w3.org/ns/ttml#styling",xml:"http://www.w3.org/XML/1998/namespace"},prefix:"",local:"region",uri:"http://www.w3.org/ns/ttml",isSelfClosing:!0},d);g.sets=[];t.call(g,0,Number.POSITIVE_INFINITY,null);return g};N.prototype.initFromNode=function(a,g,e){F.prototype.initFromNode.call(this,a,null,
g,e);t.prototype.initFromNode.call(this,a,null,g,e);d.prototype.initFromNode.call(this,a,null,g,e);this.styleAttrs=S(g,e);this.styleRefs=G(g)};z.prototype.initFromNode=function(a,g,d,e){t.prototype.initFromNode.call(this,a,g,d,e);a=S(d,e);this.value=this.qname=null;for(var h in a){if(this.qname){J(e,"More than one style specified on set");break}this.qname=h;this.value=a[h]}}})("undefined"===typeof f?this.imscDoc={}:f,"undefined"===typeof sax?c("sax"):sax,"undefined"===typeof imscNames?c("./names"):
imscNames,"undefined"===typeof imscStyles?c("./styles"):imscStyles,"undefined"===typeof imscUtils?c("./utils"):imscUtils)},{"./names":5,"./styles":6,"./utils":7,sax:void 0}],2:[function(c,p,f){(function(b,c,k,f){function n(a){var g={};a=Object.entries(a);for(var d in a){var e=f.parseColor(a[d][0]),b=f.parseColor(a[d][1]);e&&b&&(g[e.toString()]=b)}return g}function r(g,h,d){if("region"===d.kind){var e=document.createElement("div");e.style.position="absolute"}else if("body"===d.kind)e=document.createElement("div");
else if("div"===d.kind)e=document.createElement("div");else if("image"===d.kind){if(e=document.createElement("img"),null!==g.imgResolver&&null!==d.src){var b=g.imgResolver(d.src,e);b&&(e.src=b);e.height=g.regionH;e.width=g.regionW}}else if("p"===d.kind)e=document.createElement("p");else if("span"===d.kind)if("container"===d.styleAttrs[k.byName.ruby.qname])e=document.createElement("ruby"),g.ruby=!0;else if("base"===d.styleAttrs[k.byName.ruby.qname])e=document.createElement("rb");else if("text"===d.styleAttrs[k.byName.ruby.qname])e=
document.createElement("rt");else if("baseContainer"===d.styleAttrs[k.byName.ruby.qname])e=document.createElement("rbc");else if("textContainer"===d.styleAttrs[k.byName.ruby.qname])e=document.createElement("rtc");else{if("delimiter"===d.styleAttrs[k.byName.ruby.qname])return;e=document.createElement("span")}else"br"===d.kind&&(e=document.createElement("br"));if(e){h.appendChild(e);e.style.margin="0";if("region"===d.kind)if(h=d.styleAttrs[k.byName.writingMode.qname],"lrtb"===h||"lr"===h)g.ipd="lr",
g.bpd="tb";else if("rltb"===h||"rl"===h)g.ipd="rl",g.bpd="tb";else if("tblr"===h)g.ipd="tb",g.bpd="lr";else{if("tbrl"===h||"tb"===h)g.ipd="tb",g.bpd="rl"}else"p"===d.kind&&"tb"===g.bpd&&(g.ipd="ltr"===d.styleAttrs[k.byName.direction.qname]?"lr":"rl");for(var c in C)h=C[c],b=d.styleAttrs[h.qname],void 0!==b&&null!==h.map&&h.map(g,e,d,b);c=e;(h=d.styleAttrs[k.byName.linePadding.qname])&&!h.isZero()&&(b=h.multiply(h.toUsedLength(g.w,g.h),g.options.sizeAdjust),0<b&&(b=Math.ceil(b)+"px","tb"===g.bpd?(c.style.paddingLeft=
b,c.style.paddingRight=b):(c.style.paddingTop=b,c.style.paddingBottom=b),g.lp=h));(h=d.styleAttrs[k.byName.multiRowAlign.qname])&&"auto"!==h&&(c=document.createElement("span"),c.style.display="inline-block",c.style.textAlign=h,e.appendChild(c),g.mra=h);(h=d.styleAttrs[k.byName.rubyReserve.qname])&&"none"!==h[0]&&(g.rubyReserve=h);d.styleAttrs[k.byName.fillLineGap.qname]&&(g.flg=!0);if("span"===d.kind&&d.text)if((h=d.styleAttrs[k.byName.textEmphasis.qname])&&"none"!==h.style&&(g.textEmphasis=!0),k.byName.textCombine.qname in
d.styleAttrs&&"all"===d.styleAttrs[k.byName.textCombine.qname][0])e.textContent=d.text,h&&m(g,e,d,h);else{b="";for(var f=0;f<d.text.length;f++){b+=d.text.charAt(f);var n=d.text.charCodeAt(f);if(55296>n||56319<n||f===d.text.length)n=document.createElement("span"),n.textContent=b,h&&m(g,n,d,h),e.appendChild(n),b=""}}for(var q in d.contents)r(g,c,d.contents[q]);q=[];if((g.lp||g.mra||g.flg||g.ruby||g.textEmphasis||g.rubyReserve)&&"p"===d.kind){E(g,c,q,null);if(g.rubyReserve){for(h=0;h<q.length;h++){b=
document.createElement("ruby");f=document.createElement("rb");f.textContent="\u200b";b.appendChild(f);var p=g.rubyReserve[1].toUsedLength(g.w,g.h)+"px";"both"===g.rubyReserve[0]||"outside"===g.rubyReserve[0]&&1==q.length?(f=document.createElement("rtc"),f.style[B]=H?"after":"under",f.textContent="\u200b",f.style.fontSize=p,n=document.createElement("rtc"),n.style[B]=H?"before":"over",n.textContent="\u200b",n.style.fontSize=p,b.appendChild(f),b.appendChild(n)):(f=document.createElement("rtc"),f.textContent=
"\u200b",f.style.fontSize=p,f.style[B]="after"===g.rubyReserve[0]||"outside"===g.rubyReserve[0]&&0<h?H?"after":"tb"===g.bpd||"rl"===g.bpd?"under":"over":H?"before":"tb"===g.bpd||"rl"===g.bpd?"over":"under",b.appendChild(f));f=null;for(n=0;n<q[h].rbc.length;n++)if("ruby"===q[h].rbc[n].localName){f=q[h].rbc[n];for(n=0;n<f.style.length;n++)b.style.setProperty(f.style.item(n),f.style.getPropertyValue(f.style.item(n)));break}f=f||q[h].elements[0].node;f.parentElement.insertBefore(b,f)}g.rubyReserve=null}if(g.ruby||
g.rubyReserve){for(h=0;h<q.length;h++)for(b=0;b<q[h].rbc.length;b++)q[h].rbc[b].style[B]||(q[h].rbc[b].style[B]=H?0===h?"before":"after":"tb"===g.bpd?0===h?"over":"under":"rl"===g.bpd?0===h?"over":"under":0===h?"under":"over");g.ruby=null}if(g.textEmphasis){for(h=0;h<q.length;h++)for(b=0;b<q[h].te.length;b++)q[h].te[b].style[F]&&"none"!==q[h].te[b].style[F]||(q[h].te[b].style[F]="tb"===g.bpd?0===h?"left over":"left under":"rl"===g.bpd?0===h?"right under":"left under":0===h?"left under":"right under");
g.textEmphasis=null}if(g.mra){for(h=0;h<q.length-1;h++)f=q[h].elements.length,0!==f&&!1===q[h].br&&(b=document.createElement("br"),f=q[h].elements[f-1].node,f.parentElement.insertBefore(b,f.nextSibling));g.mra=null}if(g.lp){h=g.lp.multiply(g.lp.toUsedLength(g.w,g.h),g.options.sizeAdjust);for(var u in q)b=q[u].elements[q[u].start_elem],f=q[u].elements[q[u].end_elem],n=Math.ceil(h)+"px",p="-"+Math.ceil(h)+"px",0!==q[u].elements.length&&("lr"===g.ipd?(b.node.style.borderLeftColor=b.bgcolor||"#00000000",
b.node.style.borderLeftStyle="solid",b.node.style.borderLeftWidth=n,b.node.style.marginLeft=p):"rl"===g.ipd?(b.node.style.borderRightColor=b.bgcolor||"#00000000",b.node.style.borderRightStyle="solid",b.node.style.borderRightWidth=n,b.node.style.marginRight=p):"tb"===g.ipd&&(b.node.style.borderTopColor=b.bgcolor||"#00000000",b.node.style.borderTopStyle="solid",b.node.style.borderTopWidth=n,b.node.style.marginTop=p),"lr"===g.ipd?(f.node.style.borderRightColor=f.bgcolor||"#00000000",f.node.style.borderRightStyle=
"solid",f.node.style.borderRightWidth=n,f.node.style.marginRight=p):"rl"===g.ipd?(f.node.style.borderLeftColor=f.bgcolor||"#00000000",f.node.style.borderLeftStyle="solid",f.node.style.borderLeftWidth=n,f.node.style.marginLeft=p):"tb"===g.ipd&&(f.node.style.borderBottomColor=f.bgcolor||"#00000000",f.node.style.borderBottomStyle="solid",f.node.style.borderBottomWidth=n,f.node.style.marginBottom=p));g.lp=null}if(g.flg){h=l(c.getBoundingClientRect(),g);u=h.before;h=h.after;b=Math.sign(h-u);for(f=0;f<=
q.length;f++){n=0===f?u:f===q.length?h:(q[f].before+q[f-1].after)/2;if(0<f)for(var w=0;w<q[f-1].elements.length;w++)if(null!==q[f-1].elements[w].bgcolor){var z=q[f-1].elements[w];0>b*(z.after-n)&&(p=Math.ceil(Math.abs(n-z.after))+"px",z.node.style.backgroundColor=z.bgcolor,"lr"===g.bpd?z.node.style.paddingRight=p:"rl"===g.bpd?z.node.style.paddingLeft=p:"tb"===g.bpd&&(z.node.style.paddingBottom=p))}if(f<q.length)for(w=0;w<q[f].elements.length;w++)z=q[f].elements[w],null!==z.bgcolor&&0<b*(z.before-
n)&&(p=Math.ceil(Math.abs(z.before-n))+"px",z.node.style.backgroundColor=z.bgcolor,"lr"===g.bpd?z.node.style.paddingLeft=p:"rl"===g.bpd?z.node.style.paddingRight=p:"tb"===g.bpd&&(z.node.style.paddingTop=p))}g.flg=null}}"region"===d.kind&&(E(g,c,q),"tb"===g.bpd&&g.enableRollUp&&0<d.contents.length&&"after"===d.styleAttrs[k.byName.displayAlign.qname]&&(d=new a(""===d.id?"_":d.id,q),g.currentISDState[d.id]=d,g.previousISDState&&d.id in g.previousISDState&&0<g.previousISDState[d.id].plist.length&&1<d.plist.length&&
d.plist[d.plist.length-2].text===g.previousISDState[d.id].plist[g.previousISDState[d.id].plist.length-1].text&&(g=e.firstElementChild,d=d.plist[d.plist.length-1].after-d.plist[d.plist.length-1].before,g.style.bottom="-"+d+"px",g.style.transition="transform 0.4s",g.style.position="relative",g.style.transform="translateY(-"+d+"px)")))}else if(g=g.errorHandler,d="Error processing ISD element kind: "+d.kind,g&&g.error&&g.error(d))throw d;}function a(a,b){this.id=a;this.plist=b}function l(a,b){var d={before:null,
after:null,start:null,end:null};"tb"===b.bpd?(d.before=a.top,d.after=a.bottom,"lr"===b.ipd?(d.start=a.left,d.end=a.right):(d.start=a.right,d.end=a.left)):"lr"===b.bpd?(d.before=a.left,d.after=a.right,d.start=a.top,d.end=a.bottom):"rl"===b.bpd&&(d.before=a.right,d.after=a.left,d.start=a.top,d.end=a.bottom);return d}function E(a,b,d,e){if("rt"!==b.localName&&"rtc"!==b.localName)if(e=b.style.backgroundColor||e,0===b.childElementCount)if("span"===b.localName||"rb"===b.localName){var g=b.getBoundingClientRect();
if(0!==g.height&&0!==g.width){a=l(g,a);if(!(g=0===d.length)){g=a.before;var h=a.after,c=d[d.length-1].before,f=d[d.length-1].after;g=!(h<f&&g>c||f<=h&&c>=g)}g?d.push({before:a.before,after:a.after,start:a.start,end:a.end,start_elem:0,end_elem:0,elements:[],rbc:[],te:[],text:"",br:!1}):(g=Math.sign(a.after-a.before),h=Math.sign(a.end-a.start),0>g*(a.before-d[d.length-1].before)&&(d[d.length-1].before=a.before),0<g*(a.after-d[d.length-1].after)&&(d[d.length-1].after=a.after),0>h*(a.start-d[d.length-
1].start)&&(d[d.length-1].start=a.start,d[d.length-1].start_elem=d[d.length-1].elements.length),0<h*(a.end-d[d.length-1].end)&&(d[d.length-1].end=a.end,d[d.length-1].end_elem=d[d.length-1].elements.length));d[d.length-1].text+=b.textContent;d[d.length-1].elements.push({node:b,bgcolor:e,before:a.before,after:a.after})}}else"br"===b.localName&&0!==d.length&&(d[d.length-1].br=!0);else for(b=b.firstChild;b;)b.nodeType===Node.ELEMENT_NODE&&(E(a,b,d,e),"ruby"===b.localName||"rtc"===b.localName?0<d.length&&
d[d.length-1].rbc.push(b):"span"===b.localName&&b.style[u]&&"none"!==b.style[u]&&0<d.length&&d[d.length-1].te.push(b)),b=b.nextSibling}function m(a,b,d,e){if("none"===e.style)b.style[u]="none";else if(b.style[u]="auto"===e.style?"filled":e.style+" "+e.symbol,"before"===e.position||"after"===e.position)b.style[F]="tb"===a.bpd?"before"===e.position?"left over":"left under":"rl"===a.bpd?"before"===e.position?"right under":"left under":"before"===e.position?"left under":"right under"}function q(a,b){this.qname=
a;this.map=b}b.render=function(a,b,d,e,l,c,f,k,m,q){e=e||b.clientHeight;var g=l||b.clientWidth;null!==a.aspectRatio&&(l=e*a.aspectRatio,l>g?e=Math.round(g/a.aspectRatio):g=l);l=document.createElement("div");l.style.position="relative";l.style.width=g+"px";l.style.height=e+"px";l.style.margin="auto";l.style.top=0;l.style.bottom=0;l.style.left=0;l.style.right=0;l.style.zIndex=0;d={h:e,w:g,regionH:null,regionW:null,imgResolver:d,displayForcedOnlyMode:c||!1,isd:a,errorHandler:f,previousISDState:k,enableRollUp:m||
!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null,ruby:null,textEmphasis:null,rubyReserve:null,options:Object.assign({},q)||{}};d.options.colorAdjust&&(d.options.colorAdjust=n(d.options.colorAdjust));c=["region","body","div","p","span"];for(var h in c)f=c[h]+"BackgroundColorAdjust",d.options[f]&&(d.options[f]=n(d.options[f]));b.appendChild(l);for(var E in a.contents)r(d,l,a.contents[E]);return d.currentISDState};var C=[new q("http://www.w3.org/ns/ttml#styling backgroundColor",function(a,
b,d,e){(d=(d=a.options[d.kind+"BackgroundColorAdjust"])&&d[e.toString()])&&(e=d);d=e[3];0!==d&&(void 0!=a.options.backgroundOpacityScale&&(d*=a.options.backgroundOpacityScale),b.style.backgroundColor="rgba("+e[0].toString()+","+e[1].toString()+","+e[2].toString()+","+(d/255).toString()+")")}),new q("http://www.w3.org/ns/ttml#styling color",function(a,b,d,e){d=a.options.colorOpacityScale||1;a=a.options.colorAdjust;void 0!=a&&(a=a[e.toString()])&&(e=a);b.style.color="rgba("+e[0].toString()+","+e[1].toString()+
","+e[2].toString()+","+(d*e[3]/255).toString()+")"}),new q("http://www.w3.org/ns/ttml#styling direction",function(a,b,d,e){b.style.direction=e}),new q("http://www.w3.org/ns/ttml#styling display",function(a,b,d,e){}),new q("http://www.w3.org/ns/ttml#styling displayAlign",function(a,b,d,e){b.style.display="flex";b.style.flexDirection="column";"before"===e?b.style.justifyContent="flex-start":"center"===e?b.style.justifyContent="center":"after"===e&&(b.style.justifyContent="flex-end")}),new q("http://www.w3.org/ns/ttml#styling extent",
function(a,b,d,e){a.regionH=e.h.toUsedLength(a.w,a.h);a.regionW=e.w.toUsedLength(a.w,a.h);var g=e=0;if(d=d.styleAttrs["http://www.w3.org/ns/ttml#styling padding"])e=d[0].toUsedLength(a.w,a.h)+d[2].toUsedLength(a.w,a.h),g=d[1].toUsedLength(a.w,a.h)+d[3].toUsedLength(a.w,a.h);b.style.height=a.regionH-e+"px";b.style.width=a.regionW-g+"px"}),new q("http://www.w3.org/ns/ttml#styling fontFamily",function(a,b,d,e){d=[];a.options.fontFamily&&(e=a.options.fontFamily.split(","));for(var g in e)e[g]=e[g].trim(),
"monospaceSerif"===e[g]?(d.push("Courier New"),d.push('"Liberation Mono"'),d.push("Courier"),d.push("monospace")):"proportionalSansSerif"===e[g]||"default"===e[g]?(d.push("Arial"),d.push("Helvetica"),d.push('"Liberation Sans"'),d.push("sans-serif")):"monospace"===e[g]?d.push("monospace"):"sansSerif"===e[g]?d.push("sans-serif"):"serif"===e[g]?d.push("serif"):"monospaceSansSerif"===e[g]?(d.push("Consolas"),d.push("monospace")):"proportionalSerif"===e[g]?d.push("serif"):d.push(e[g]);if(0<d.length){a=
[d[0]];for(e=1;e<d.length;e++)-1==a.indexOf(d[e])&&a.push(d[e]);d=a}b.style.fontFamily=d.join(",")}),new q("http://www.w3.org/ns/ttml#styling shear",function(a,b,d,e){0!==e&&(d=-.9*e,b.style.transform="tb"===a.bpd?"skewX("+d+"deg)":"skewY("+d+"deg)")}),new q("http://www.w3.org/ns/ttml#styling fontSize",function(a,b,d,e){b.style.fontSize=e.multiply(e.toUsedLength(a.w,a.h),a.options.sizeAdjust)+"px"}),new q("http://www.w3.org/ns/ttml#styling fontStyle",function(a,b,d,e){b.style.fontStyle=e}),new q("http://www.w3.org/ns/ttml#styling fontWeight",
function(a,b,d,e){b.style.fontWeight=e}),new q("http://www.w3.org/ns/ttml#styling lineHeight",function(a,b,d,e){b.style.lineHeight="normal"===e?"normal":e.multiply(e.multiply(e.toUsedLength(a.w,a.h),a.options.sizeAdjust),a.options.lineHeightAdjust)+"px"}),new q("http://www.w3.org/ns/ttml#styling opacity",function(a,b,d,e){d=e;void 0!=a.options.regionOpacityScale&&(d*=a.options.regionOpacityScale);b.style.opacity=d}),new q("http://www.w3.org/ns/ttml#styling origin",function(a,b,d,e){b.style.top=e.h.toUsedLength(a.w,
a.h)+"px";b.style.left=e.w.toUsedLength(a.w,a.h)+"px"}),new q("http://www.w3.org/ns/ttml#styling overflow",function(a,b,d,e){b.style.overflow=e}),new q("http://www.w3.org/ns/ttml#styling padding",function(a,b,d,e){d=[];d[0]=e[0].toUsedLength(a.w,a.h)+"px";d[1]=e[3].toUsedLength(a.w,a.h)+"px";d[2]=e[2].toUsedLength(a.w,a.h)+"px";d[3]=e[1].toUsedLength(a.w,a.h)+"px";b.style.padding=d.join(" ")}),new q("http://www.w3.org/ns/ttml#styling position",function(a,b,d,e){b.style.top=e.h.toUsedLength(a.w,a.h)+
"px";b.style.left=e.w.toUsedLength(a.w,a.h)+"px"}),new q("http://www.w3.org/ns/ttml#styling rubyAlign",function(a,b,d,e){b.style.rubyAlign="spaceAround"===e?"space-around":"center"}),new q("http://www.w3.org/ns/ttml#styling rubyPosition",function(a,b,d,e){if("before"===e||"after"===e)b.parentElement.style[B]=H?e:"tb"===a.bpd?"before"===e?"over":"under":"rl"===a.bpd?"before"===e?"over":"under":"before"===e?"under":"over"}),new q("http://www.w3.org/ns/ttml#styling showBackground",null),new q("http://www.w3.org/ns/ttml#styling textAlign",
function(a,b,d,e){b.style.textAlign="start"===e?"rl"===a.ipd?"right":"left":"end"===e?"rl"===a.ipd?"left":"right":e}),new q("http://www.w3.org/ns/ttml#styling textDecoration",function(a,b,d,e){b.style.textDecoration=e.join(" ").replace("lineThrough","line-through")}),new q("http://www.w3.org/ns/ttml#styling textOutline",function(a,b,d,e){}),new q("http://www.w3.org/ns/ttml#styling textShadow",function(a,b,d,e){d=d.styleAttrs[k.byName.textOutline.qname];var g=a.options.textOutline;if(g)if("none"===
g)d=g;else{var l={};g=g.split(" ");if(0!==g.length&&2>=g.length){var h=f.parseColor(g[0]);l.color=h;null!==h&&g.shift();1===g.length&&(g=f.parseLength(g[0]))&&(l.thickness=g,d=l)}}if("none"===e&&"none"===d)b.style.textShadow="";else{l=[];"none"!==d&&(d="rgba("+d.color[0].toString()+","+d.color[1].toString()+","+d.color[2].toString()+","+(d.color[3]/255).toString()+")",l.push("1px 1px 1px "+d),l.push("-1px 1px 1px "+d),l.push("1px -1px 1px "+d),l.push("-1px -1px 1px "+d));if("none"!==e)for(var c in e)l.push(e[c].x_off.toUsedLength(a.w,
a.h)+"px "+e[c].y_off.toUsedLength(a.w,a.h)+"px "+e[c].b_radius.toUsedLength(a.w,a.h)+"px rgba("+e[c].color[0].toString()+","+e[c].color[1].toString()+","+e[c].color[2].toString()+","+(e[c].color[3]/255).toString()+")");b.style.textShadow=l.join(",")}}),new q("http://www.w3.org/ns/ttml#styling textCombine",function(a,b,d,e){b.style.textCombineUpright=e.join(" ")}),new q("http://www.w3.org/ns/ttml#styling textEmphasis",function(a,b,d,e){}),new q("http://www.w3.org/ns/ttml#styling unicodeBidi",function(a,
b,d,e){b.style.unicodeBidi="bidiOverride"===e?"bidi-override":e}),new q("http://www.w3.org/ns/ttml#styling visibility",function(a,b,d,e){b.style.visibility=e}),new q("http://www.w3.org/ns/ttml#styling wrapOption",function(a,b,d,e){b.style.whiteSpace="wrap"===e?"preserve"===d.space?"pre-wrap":"normal":"preserve"===d.space?"pre":"noWrap"}),new q("http://www.w3.org/ns/ttml#styling writingMode",function(a,b,d,e){if("lrtb"===e||"lr"===e)b.style.writingMode="horizontal-tb";else if("rltb"===e||"rl"===e)b.style.writingMode=
"horizontal-tb";else if("tblr"===e)b.style.writingMode="vertical-lr";else if("tbrl"===e||"tb"===e)b.style.writingMode="vertical-rl"}),new q("http://www.w3.org/ns/ttml#styling zIndex",function(a,b,d,e){b.style.zIndex=e}),new q("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",function(a,b,d,e){a.displayForcedOnlyMode&&!1===e&&(b.style.visibility="hidden")})],p;for(p in C);var H="webkitRubyPosition"in window.getComputedStyle(document.documentElement),B=H?"webkitRubyPosition":"rubyPosition",
u="webkitTextEmphasisStyle"in window.getComputedStyle(document.documentElement)?"webkitTextEmphasisStyle":"textEmphasisStyle",F="webkitTextEmphasisPosition"in window.getComputedStyle(document.documentElement)?"webkitTextEmphasisPosition":"textEmphasisPosition"})("undefined"===typeof f?this.imscHTML={}:f,"undefined"===typeof imscNames?c("./names"):imscNames,"undefined"===typeof imscStyles?c("./styles"):imscStyles,"undefined"===typeof imscUtils?c("./utils"):imscUtils)},{"./names":5,"./styles":6,"./utils":7}],
3:[function(c,p,f){(function(b,c,f,r){function k(b,c,E,p,u,F,g,h,d){if(c<g.begin||c>=g.end)return null;F="regionID"in g&&""!==g.regionID?g.regionID:F;if(null!==u&&F!==E.id&&(!("contents"in g)||"contents"in g&&0===g.contents.length||""!==F))return null;var e=new m(g);for(C in g.sets)c<g.sets[C].begin||c>=g.sets[C].end||(e.styleAttrs[g.sets[C].qname]=g.sets[C].value);var C={};for(var v in e.styleAttrs)if(C[v]=!0,"region"===e.kind&&v===f.byName.writingMode.qname&&!(f.byName.direction.qname in e.styleAttrs)){var w=
e.styleAttrs[v];if("lrtb"===w||"lr"===w)e.styleAttrs[f.byName.direction.qname]="ltr";else if("rltb"===w||"rl"===w)e.styleAttrs[f.byName.direction.qname]="rtl"}if(null!==u)for(var x in f.all)if(v=f.all[x],v.qname===f.byName.textDecoration.qname){w=u.styleAttrs[v.qname];var B=e.styleAttrs[v.qname],H=[];void 0===B?H=w:-1===B.indexOf("none")?((-1===B.indexOf("noUnderline")&&-1!==w.indexOf("underline")||-1!==B.indexOf("underline"))&&H.push("underline"),(-1===B.indexOf("noLineThrough")&&-1!==w.indexOf("lineThrough")||
-1!==B.indexOf("lineThrough"))&&H.push("lineThrough"),(-1===B.indexOf("noOverline")&&-1!==w.indexOf("overline")||-1!==B.indexOf("overline"))&&H.push("overline")):H.push("none");e.styleAttrs[v.qname]=H}else v.qname!==f.byName.fontSize.qname||v.qname in e.styleAttrs||"span"!==e.kind||"textContainer"!==e.styleAttrs[f.byName.ruby.qname]?v.qname!==f.byName.fontSize.qname||v.qname in e.styleAttrs||"span"!==e.kind||"text"!==e.styleAttrs[f.byName.ruby.qname]?v.inherit&&v.qname in u.styleAttrs&&!(v.qname in
e.styleAttrs)&&(e.styleAttrs[v.qname]=u.styleAttrs[v.qname]):(w=u.styleAttrs[f.byName.fontSize.qname],e.styleAttrs[v.qname]="textContainer"===u.styleAttrs[f.byName.ruby.qname]?w:new r.ComputedLength(.5*w.rw,.5*w.rh)):(w=u.styleAttrs[f.byName.fontSize.qname],e.styleAttrs[v.qname]=new r.ComputedLength(.5*w.rw,.5*w.rh));for(var A in f.all)if(x=f.all[A],!(x.qname in e.styleAttrs||x.qname===f.byName.position.qname&&f.byName.origin.qname in e.styleAttrs||x.qname===f.byName.origin.qname&&f.byName.position.qname in
e.styleAttrs)&&(v=b.head.styling.initials[x.qname]||x.initial,null!==v&&("region"===e.kind||!1===x.inherit&&null!==v)))if(v=x.parse(v),null!==v)e.styleAttrs[x.qname]=v,C[x.qname]=!0;else if(x="Invalid initial value for '"+x.qname+"' on element '"+e.kind,h&&h.error&&h.error(x))throw x;for(var I in f.all)if(A=f.all[I],A.qname in C&&null!==A.compute)if(x=A.compute(b,u,e,e.styleAttrs[A.qname],d),null!==x)e.styleAttrs[A.qname]=x;else if(e.styleAttrs[A.qname]=A.compute(b,u,e,A.parse(A.initial),d),A="Style '"+
A.qname+"' on element '"+e.kind+"' cannot be computed",h&&h.error&&h.error(A))throw A;if("none"===e.styleAttrs[f.byName.display.qname])return null;if(null===u)var z=null===p?[]:[p];else"contents"in g&&(z=g.contents);for(var L in z)u=k(b,c,E,p,e,F,z[L],h,d),null!==u&&e.contents.push(u.element);for(var G in e.styleAttrs)b=!1,"span"===e.kind&&(c=e.styleAttrs[f.byName.ruby.qname],(b=("container"===c||"textContainer"===c||"baseContainer"===c)&&-1!==q.indexOf(G))||(b="container"!==c&&G===f.byName.rubyAlign.qname),
b||(b=!("textContainer"===c||"text"===c)&&G===f.byName.rubyPosition.qname)),b||(b=-1===f.byQName[G].applies.indexOf(e.kind)),b&&delete e.styleAttrs[G];G=e.styleAttrs[f.byName.ruby.qname];if("p"===e.kind||"span"===e.kind&&("textContainer"===G||"text"===G))G=[],a(e,G),n(G),l(e);return"div"===e.kind&&f.byName.backgroundImage.qname in e.styleAttrs||"br"===e.kind||"image"===e.kind||"contents"in e&&0<e.contents.length||"span"===e.kind&&null!==e.text||"region"===e.kind&&"always"===e.styleAttrs[f.byName.showBackground.qname]?
{region_id:F,element:e}:null}function n(a){function b(a){return"br"===a.kind||/[\r\n\t ]$/.test(a.text)}function l(a){return"br"===a.kind||"preserve"===a.space&&/^[\r\n]/.test(a.text)}for(var c,f=0;f<a.length;)if(c=a[f],"br"===c.kind||"preserve"===c.space)f++;else{var m=c.text.replace(/[\t\r\n ]+/g," ");/^[ ]/.test(m)&&(0===f||b(a[f-1]))&&(m=m.substring(1));c.text=m;0===m.length?a.splice(f,1):f++}for(f=0;f<a.length;f++)c=a[f],"br"===c.kind||"preserve"===c.space?f++:/[ ]$/.test(c.text)&&(f===a.length-
1||l(a[f+1]))&&(c.text=c.text.slice(0,-1))}function a(b,l){for(var c in b.contents){var m=b.contents[c],k=m.styleAttrs[f.byName.ruby.qname];if("span"!==m.kind||"textContainer"!==k&&"text"!==k)"contents"in m?a(m,l):("span"===m.kind&&0!==m.text.length||"br"===m.kind)&&l.push(m)}}function l(a){if("br"===a.kind)return!1;if("text"in a)return 0===a.text.length;if("contents"in a){for(var b=a.contents.length;b--;)l(a.contents[b])&&a.contents.splice(b,1);return 0===a.contents.length}}function E(a){this.contents=
[];this.aspectRatio=a.aspectRatio}function m(a){this.kind=a.kind||"region";a.id&&(this.id=a.id);this.styleAttrs={};for(var b in a.styleAttrs)this.styleAttrs[b]=a.styleAttrs[b];"src"in a&&(this.src=a.src);"type"in a&&(this.type=a.type);if("text"in a)this.text=a.text;else if("region"===this.kind||"contents"in a)this.contents=[];"space"in a&&(this.space=a.space)}b.generateISD=function(a,b,l){function c(a,b){function d(b){return!(a<b.begin||a>=b.end)}if(b.contents){var e={},l;for(l in b)e[l]=b[l];e.contents=
[];b.contents.filter(d).forEach(function(b){b=c(a,b);b.regionID&&h.add(b.regionID);null!==b&&e.contents.push(b)});return e}return b}var f=new E(a),m={},g={},h=new Set;g=c(b,a.body);0===h.size&&a.head.layout.regions.hasOwnProperty("")&&h.add("");h.forEach(function(d){d=k(a,b,a.head.layout.regions[d],g,null,"",a.head.layout.regions[d],l,m);null!==d&&f.contents.push(d.element)});return f};var q=[f.byName.color.qname,f.byName.textCombine.qname,f.byName.textDecoration.qname,f.byName.textEmphasis.qname,
f.byName.textOutline.qname,f.byName.textShadow.qname]})("undefined"===typeof f?this.imscISD={}:f,"undefined"===typeof imscNames?c("./names"):imscNames,"undefined"===typeof imscStyles?c("./styles"):imscStyles,"undefined"===typeof imscUtils?c("./utils"):imscUtils)},{"./names":5,"./styles":6,"./utils":7}],4:[function(c,p,f){f.generateISD=c("./isd").generateISD;f.fromXML=c("./doc").fromXML;f.renderHTML=c("./html").render},{"./doc":1,"./html":2,"./isd":3}],5:[function(c,p,f){c="undefined"===typeof f?this.imscNames=
{}:f;c.ns_tt="http://www.w3.org/ns/ttml";c.ns_tts="http://www.w3.org/ns/ttml#styling";c.ns_ttp="http://www.w3.org/ns/ttml#parameter";c.ns_xml="http://www.w3.org/XML/1998/namespace";c.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling";c.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter";c.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt";c.ns_ebutts="urn:ebu:tt:style";c.ttaf_map={"http://www.w3.org/2006/10/ttaf1":c.ns_tt,"http://www.w3.org/2006/10/ttaf1#style":c.ns_tts,
"http://www.w3.org/2006/10/ttaf1#parameter":c.ns_ttp}},{}],6:[function(c,p,f){(function(b,c,f){function k(a,b,c,f,k,n,p,r){this.name=b;this.ns=a;this.qname=a+" "+b;this.inherit=k;this.animatable=n;this.initial=c;this.applies=f;this.parse=p;this.compute=r}b.all=[new k(c.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,f.parseColor,null),new k(c.ns_tts,"color","white",["span"],!0,!0,f.parseColor,null),new k(c.ns_tts,"direction","ltr",["p","span"],!0,!0,function(a){return a},
null),new k(c.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,function(a){return a},null),new k(c.ns_tts,"displayAlign","before",["region"],!1,!0,function(a){return a},null),new k(c.ns_tts,"extent","auto",["tt","region"],!1,!0,function(a){if("auto"===a)return a;var b=a.split(" ");if(2!==b.length)return null;a=f.parseLength(b[0]);return(b=f.parseLength(b[1]))&&a?{h:b,w:a}:null},function(a,b,c,m,k){if("auto"===m)b=new f.ComputedLength(0,1);else if(b=f.toComputedLength(m.h.value,m.h.unit,
null,a.dimensions.h,null,a.pxLength.h),null===b)return null;if("auto"===m)a=new f.ComputedLength(1,0);else if(a=f.toComputedLength(m.w.value,m.w.unit,null,a.dimensions.w,null,a.pxLength.w),null===a)return null;return{h:b,w:a}}),new k(c.ns_tts,"fontFamily","default",["p","span"],!0,!0,function(a){a=a.split(",");var b=[],c;for(c in a)"'"!==a[c].charAt(0)&&'"'!==a[c].charAt(0)?"default"===a[c]?b.push("monospaceSerif"):b.push(a[c]):b.push(a[c]);return b},null),new k(c.ns_tts,"shear","0%",["p"],!0,!0,
f.parseLength,function(a,b,c,f){if("%"===f.unit)a=100<Math.abs(f.value)?100*Math.sign(f.value):f.value;else return null;return a}),new k(c.ns_tts,"fontSize","1c",["p","span"],!0,!0,f.parseLength,function(a,c,k,m,q){return f.toComputedLength(m.value,m.unit,null!==c?c.styleAttrs[b.byName.fontSize.qname]:a.cellLength.h,null!==c?c.styleAttrs[b.byName.fontSize.qname]:a.cellLength.h,a.cellLength.h,a.pxLength.h)}),new k(c.ns_tts,"fontStyle","normal",["span"],!0,!0,function(a){return a},null),new k(c.ns_tts,
"fontWeight","normal",["span"],!0,!0,function(a){return a},null),new k(c.ns_tts,"lineHeight","normal",["p"],!0,!0,function(a){return"normal"===a?a:f.parseLength(a)},function(a,c,k,m,q){if("normal"===m)a=m;else if(a=f.toComputedLength(m.value,m.unit,k.styleAttrs[b.byName.fontSize.qname],k.styleAttrs[b.byName.fontSize.qname],a.cellLength.h,a.pxLength.h),null===a)return null;return a}),new k(c.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new k(c.ns_tts,"origin","auto",["region"],!1,!0,function(a){if("auto"===
a)return a;var b=a.split(" ");if(2!==b.length)return null;a=f.parseLength(b[0]);return(b=f.parseLength(b[1]))&&a?{h:b,w:a}:null},function(a,b,c,m,k){if("auto"===m)b=new f.ComputedLength(0,0);else if(b=f.toComputedLength(m.h.value,m.h.unit,null,a.dimensions.h,null,a.pxLength.h),null===b)return null;if("auto"===m)a=new f.ComputedLength(0,0);else if(a=f.toComputedLength(m.w.value,m.w.unit,null,a.dimensions.w,null,a.pxLength.w),null===a)return null;return{h:b,w:a}}),new k(c.ns_tts,"overflow","hidden",
["region"],!1,!0,function(a){return a},null),new k(c.ns_tts,"padding","0px",["region"],!1,!0,function(a){a=a.split(" ");if(4<a.length)return null;var b=[],c;for(c in a){var m=f.parseLength(a[c]);if(!m)return null;b.push(m)}return b},function(a,c,k,m,q){if(1===m.length)c=[m[0],m[0],m[0],m[0]];else if(2===m.length)c=[m[0],m[1],m[0],m[1]];else if(3===m.length)c=[m[0],m[1],m[2],m[1]];else if(4===m.length)c=[m[0],m[1],m[2],m[3]];else return null;m=k.styleAttrs[b.byName.writingMode.qname];if("lrtb"===m||
"lr"===m)c=[c[0],c[3],c[2],c[1]];else if("rltb"===m||"rl"===m)c=[c[0],c[1],c[2],c[3]];else if("tblr"===m)c=[c[3],c[0],c[1],c[2]];else if("tbrl"===m||"tb"===m)c=[c[3],c[2],c[1],c[0]];else return null;m=[];for(var l in c)if(0===c[l].value)m[l]=new f.ComputedLength(0,0);else if(m[l]=f.toComputedLength(c[l].value,c[l].unit,k.styleAttrs[b.byName.fontSize.qname],"0"===l||"2"===l?k.styleAttrs[b.byName.extent.qname].h:k.styleAttrs[b.byName.extent.qname].w,"0"===l||"2"===l?a.cellLength.h:a.cellLength.w,"0"===
l||"2"===l?a.pxLength.h:a.pxLength.w),null===m[l])return null;return m}),new k(c.ns_tts,"position","top left",["region"],!1,!0,function(a){return f.parsePosition(a)},function(a,c,k,m){c=f.toComputedLength(m.v.offset.value,m.v.offset.unit,null,new f.ComputedLength(-k.styleAttrs[b.byName.extent.qname].h.rw,a.dimensions.h.rh-k.styleAttrs[b.byName.extent.qname].h.rh),null,a.pxLength.h);if(null===c)return null;"bottom"===m.v.edge&&(c=new f.ComputedLength(-c.rw-k.styleAttrs[b.byName.extent.qname].h.rw,
a.dimensions.h.rh-c.rh-k.styleAttrs[b.byName.extent.qname].h.rh));var l=f.toComputedLength(m.h.offset.value,m.h.offset.unit,null,new f.ComputedLength(a.dimensions.w.rw-k.styleAttrs[b.byName.extent.qname].w.rw,-k.styleAttrs[b.byName.extent.qname].w.rh),null,a.pxLength.w);if(null===c)return null;"right"===m.h.edge&&(l=new f.ComputedLength(a.dimensions.w.rw-l.rw-k.styleAttrs[b.byName.extent.qname].w.rw,-l.rh-k.styleAttrs[b.byName.extent.qname].w.rh));return{h:c,w:l}}),new k(c.ns_tts,"ruby","none",["span"],
!1,!0,function(a){return a},null),new k(c.ns_tts,"rubyAlign","center",["span"],!0,!0,function(a){return"center"!==a&&"spaceAround"!==a?null:a},null),new k(c.ns_tts,"rubyPosition","outside",["span"],!0,!0,function(a){return a},null),new k(c.ns_tts,"rubyReserve","none",["p"],!0,!0,function(a){var b=a.split(" ");a=[null,null];if(0===b.length||2<b.length||"none"!==b[0]&&"both"!==b[0]&&"after"!==b[0]&&"before"!==b[0]&&"outside"!==b[0])return null;a[0]=b[0];if(2===b.length&&"none"!==b[0])if(b=f.parseLength(b[1]))a[1]=
b;else return null;return a},function(a,c,k,m,q){if("none"===m[0])return m;a=null===m[1]?new f.ComputedLength(.5*k.styleAttrs[b.byName.fontSize.qname].rw,.5*k.styleAttrs[b.byName.fontSize.qname].rh):f.toComputedLength(m[1].value,m[1].unit,k.styleAttrs[b.byName.fontSize.qname],k.styleAttrs[b.byName.fontSize.qname],a.cellLength.h,a.pxLength.h);return null===a?null:[m[0],a]}),new k(c.ns_tts,"showBackground","whenActive",["region"],!1,!0,function(a){return a},null),new k(c.ns_tts,"textAlign","start",
["p"],!0,!0,function(a){return a},function(a,b,c,f,k){return"left"===f?"start":"right"===f?"end":f}),new k(c.ns_tts,"textCombine","none",["span"],!0,!0,function(a){a=a.split(" ");return 1!==a.length||"none"!==a[0]&&"all"!==a[0]?null:[a[0]]},null),new k(c.ns_tts,"textDecoration","none",["span"],!0,!0,function(a){return a.split(" ")},null),new k(c.ns_tts,"textEmphasis","none",["span"],!0,!0,function(a){a=a.split(" ");var b={style:null,symbol:null,color:null,position:null},c;for(c in a)if("none"===a[c]||
"auto"===a[c])b.style=a[c];else if("filled"===a[c]||"open"===a[c])b.style=a[c];else if("circle"===a[c]||"dot"===a[c]||"sesame"===a[c])b.symbol=a[c];else if("current"===a[c])b.color=a[c];else if("outside"===a[c]||"before"===a[c]||"after"===a[c])b.position=a[c];else if(b.color=f.parseColor(a[c]),null===b.color)return null;null==b.style&&null==b.symbol?b.style="auto":(b.symbol=b.symbol||"circle",b.style=b.style||"filled");b.position=b.position||"outside";b.color=b.color||"current";return b},null),new k(c.ns_tts,
"textOutline","none",["span"],!0,!0,function(a){if("none"===a)return a;var b={};a=a.split(" ");if(0===a.length||2<a.length)return null;var c=f.parseColor(a[0]);b.color=c;null!==c&&a.shift();if(1!==a.length)return null;a=f.parseLength(a[0]);if(!a)return null;b.thickness=a;return b},function(a,c,k,m,q){if("none"===m)return m;c={};c.color=null===m.color?k.styleAttrs[b.byName.color.qname]:m.color;c.thickness=f.toComputedLength(m.thickness.value,m.thickness.unit,k.styleAttrs[b.byName.fontSize.qname],k.styleAttrs[b.byName.fontSize.qname],
a.cellLength.h,a.pxLength.h);return null===c.thickness?null:c}),new k(c.ns_tts,"textShadow","none",["span"],!0,!0,f.parseTextShadow,function(a,c,k,m){if("none"===m)return m;c=[];for(var l in m){var n={};n.x_off=f.toComputedLength(m[l][0].value,m[l][0].unit,null,k.styleAttrs[b.byName.fontSize.qname],null,a.pxLength.w);if(null===n.x_off)return null;n.y_off=f.toComputedLength(m[l][1].value,m[l][1].unit,null,k.styleAttrs[b.byName.fontSize.qname],null,a.pxLength.h);if(null===n.y_off)return null;if(null===
m[l][2])n.b_radius=0;else if(n.b_radius=f.toComputedLength(m[l][2].value,m[l][2].unit,null,k.styleAttrs[b.byName.fontSize.qname],null,a.pxLength.h),null===n.b_radius)return null;n.color=null===m[l][3]?k.styleAttrs[b.byName.color.qname]:m[l][3];c.push(n)}return c}),new k(c.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,function(a){return a},null),new k(c.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,function(a){return a},null),new k(c.ns_tts,"wrapOption","wrap",["span"],
!0,!0,function(a){return a},null),new k(c.ns_tts,"writingMode","lrtb",["region"],!1,!0,function(a){return a},null),new k(c.ns_tts,"zIndex","auto",["region"],!1,!0,function(a){"auto"!==a&&(a=parseInt(a),isNaN(a)&&(a=null));return a},null),new k(c.ns_ebutts,"linePadding","0c",["p"],!0,!1,f.parseLength,function(a,b,c,k,n){return f.toComputedLength(k.value,k.unit,null,null,a.cellLength.w,null)}),new k(c.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,function(a){return a},null),new k(c.ns_smpte,"backgroundImage",
null,["div"],!1,!1,function(a){return a},null),new k(c.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,function(a){return"true"===a?!0:!1},null),new k(c.ns_itts,"fillLineGap","true",["p"],!0,!0,function(a){return"true"===a?!0:!1},null)];b.byQName={};for(var n in b.all)b.byQName[b.all[n].qname]=b.all[n];b.byName={};for(var p in b.all)b.byName[b.all[p].name]=b.all[p]})("undefined"===typeof f?this.imscStyles={}:f,"undefined"===typeof imscNames?c("./names"):imscNames,"undefined"===
typeof imscUtils?c("./utils"):imscUtils)},{"./names":5,"./utils":7}],7:[function(c,p,f){(function(b){var c=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,f=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,p=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,L={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],
green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};b.parseColor=function(a){var b,k=null,m=L[a.toLowerCase()];void 0!==m?k=m:null!==(b=c.exec(a))?k=[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16),void 0!==b[4]?parseInt(b[4],16):255]:null!==(b=f.exec(a))?k=[parseInt(b[1]),parseInt(b[2]),parseInt(b[3]),255]:null!==(b=p.exec(a))&&(k=[parseInt(b[1]),parseInt(b[2]),
parseInt(b[3]),parseInt(b[4])]);return k};var I=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%|rh|rw)$/;b.parseLength=function(a){var b,c=null;null!==(b=I.exec(a))&&(c={value:parseFloat(b[1]),unit:b[2]});return c};b.parseTextShadow=function(a){a=a.split(",");var c=[],f;for(f in a){var k=a[f].split(" ");if(1===k.length&&"none"===k[0])return"none";if(1<k.length&&5>k.length){var n=[null,null,null,null],p=b.parseLength(k.shift());if(null===p)return null;n[0]=p;p=b.parseLength(k.shift());if(null===p)return null;
n[1]=p;if(0!==k.length&&(p=b.parseLength(k[0]),null!==p&&(n[2]=p,k.shift()),0!==k.length)){k=b.parseColor(k[0]);if(null===k)return null;n[3]=k}c.push(n)}}return c};b.parsePosition=function(a){a=a.split(" ");var c=function(a){return"center"===a||"left"===a||"top"===a||"bottom"===a||"right"===a};if(4<a.length)return null;for(var f in a)if(!c(a[f])){var k=b.parseLength(a[f]);if(null===k)return null;a[f]=k}f={h:{edge:"left",offset:{value:50,unit:"%"}},v:{edge:"top",offset:{value:50,unit:"%"}}};for(k=
0;k<a.length;){var n=a[k++];if(c(n)){var p={value:0,unit:"%"};2!==a.length&&k<a.length&&!c(a[k])&&(p=a[k++]);"right"===n?(f.h.edge=n,f.h.offset=p):"bottom"===n?(f.v.edge=n,f.v.offset=p):"left"===n?f.h.offset=p:"top"===n&&(f.v.offset=p)}else if(1===a.length||2===a.length)1===k?f.h.offset=n:f.v.offset=n;else return null}return f};b.ComputedLength=function(a,b){this.rw=a;this.rh=b};b.ComputedLength.prototype.toUsedLength=function(a,b){return a*this.rw+b*this.rh};b.ComputedLength.prototype.multiply=function(a,
b){return b?a*b:a};b.ComputedLength.prototype.isZero=function(){return 0===this.rw&&0===this.rh};b.toComputedLength=function(a,c,f,k,n,p){return"%"===c&&k?new b.ComputedLength(k.rw*a/100,k.rh*a/100):"em"===c&&f?new b.ComputedLength(f.rw*a,f.rh*a):"c"===c&&n?new b.ComputedLength(a*n.rw,a*n.rh):"px"===c&&p?new b.ComputedLength(a*p.rw,a*p.rh):"rh"===c?new b.ComputedLength(0,a/100):"rw"===c?new b.ComputedLength(a/100,0):null}})("undefined"===typeof f?this.imscUtils={}:f)},{}]},{},[4])(4)});
