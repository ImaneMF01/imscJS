var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.owns=function(d,p){return Object.prototype.hasOwnProperty.call(d,p)};$jscomp.assign="function"==typeof Object.assign?Object.assign:function(d,p){for(var f=1;f<arguments.length;f++){var b=arguments[f];if(b)for(var n in b)$jscomp.owns(b,n)&&(d[n]=b[n])}return d};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(d,p,f){d!=Array.prototype&&d!=Object.prototype&&(d[p]=f.value)};$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(d,p,f,b){if(p){f=$jscomp.global;d=d.split(".");for(b=0;b<d.length-1;b++){var n=d[b];n in f||(f[n]={});f=f[n]}d=d[d.length-1];b=f[d];p=p(b);p!=b&&null!=p&&$jscomp.defineProperty(f,d,{configurable:!0,writable:!0,value:p})}};$jscomp.polyfill("Object.assign",function(d){return d||$jscomp.assign},"es6","es3");$jscomp.polyfill("Object.entries",function(d){return d?d:function(d){var f=[],b;for(b in d)$jscomp.owns(d,b)&&f.push([b,d[b]]);return f}},"es8","es3");
$jscomp.polyfill("Math.sign",function(d){return d?d:function(d){d=Number(d);return 0===d||isNaN(d)?d:0<d?1:-1}},"es6","es3");$jscomp.checkEs6ConformanceViaProxy=function(){try{var d={},p=Object.create(new $jscomp.global.Proxy(d,{get:function(f,b,n){return f==d&&"q"==b&&n==p}}));return!0===p.q}catch(f){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var d=0;return function(p){return $jscomp.SYMBOL_PREFIX+(p||"")+d++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var d=$jscomp.global.Symbol.iterator;d||(d=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[d]&&$jscomp.defineProperty(Array.prototype,d,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var d=$jscomp.global.Symbol.asyncIterator;d||(d=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.arrayIterator=function(d){var p=0;return $jscomp.iteratorPrototype(function(){return p<d.length?{done:!1,value:d[p++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(d){$jscomp.initSymbolIterator();d={next:d};d[$jscomp.global.Symbol.iterator]=function(){return this};return d};$jscomp.makeIterator=function(d){$jscomp.initSymbolIterator();var p=d[Symbol.iterator];return p?p.call(d):$jscomp.arrayIterator(d)};
$jscomp.polyfill("WeakMap",function(d){function p(){if(!d||!Object.seal)return!1;try{var b=Object.seal({}),k=Object.seal({}),a=new d([[b,2],[k,3]]);if(2!=a.get(b)||3!=a.get(k))return!1;a.delete(b);a.set(k,4);return!a.has(b)&&4==a.get(k)}catch(l){return!1}}function f(b){$jscomp.owns(b,n)||$jscomp.defineProperty(b,n,{value:{}})}function b(b){var k=Object[b];k&&(Object[b]=function(a){f(a);return k(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(d&&$jscomp.ES6_CONFORMANCE)return d}else if(p())return d;
var n="$jscomp_hidden_"+Math.random();b("freeze");b("preventExtensions");b("seal");var k=0,r=function(b){this.id_=(k+=Math.random()+1).toString();if(b){$jscomp.initSymbol();$jscomp.initSymbolIterator();b=$jscomp.makeIterator(b);for(var d;!(d=b.next()).done;)d=d.value,this.set(d[0],d[1])}};r.prototype.set=function(b,k){f(b);if(!$jscomp.owns(b,n))throw Error("WeakMap key fail: "+b);b[n][this.id_]=k;return this};r.prototype.get=function(b){return $jscomp.owns(b,n)?b[n][this.id_]:void 0};r.prototype.has=
function(b){return $jscomp.owns(b,n)&&$jscomp.owns(b[n],this.id_)};r.prototype.delete=function(b){return $jscomp.owns(b,n)&&$jscomp.owns(b[n],this.id_)?delete b[n][this.id_]:!1};return r},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(d){function p(){if($jscomp.ASSUME_NO_NATIVE_MAP||!d||"function"!=typeof d||!d.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),a=new d($jscomp.makeIterator([[b,"s"]]));if("s"!=a.get(b)||1!=a.size||a.get({x:4})||a.set({x:4},"t")!=a||2!=a.size)return!1;var l=a.entries(),k=l.next();if(k.done||k.value[0]!=b||"s"!=k.value[1])return!1;k=l.next();return k.done||4!=k.value[0].x||"t"!=k.value[1]||!l.next().done?!1:!0}catch(m){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(d&&$jscomp.ES6_CONFORMANCE)return d}else if(p())return d;$jscomp.initSymbol();$jscomp.initSymbolIterator();var f=new WeakMap,b=function(b){this.data_={};this.head_=r();this.size=0;if(b){b=$jscomp.makeIterator(b);for(var a;!(a=b.next()).done;)a=a.value,this.set(a[0],a[1])}};b.prototype.set=function(b,a){b=0===b?0:b;var l=n(this,b);l.list||(l.list=this.data_[l.id]=[]);l.entry?l.entry.value=a:(l.entry={next:this.head_,previous:this.head_.previous,head:this.head_,
key:b,value:a},l.list.push(l.entry),this.head_.previous.next=l.entry,this.head_.previous=l.entry,this.size++);return this};b.prototype.delete=function(b){b=n(this,b);return b.entry&&b.list?(b.list.splice(b.index,1),b.list.length||delete this.data_[b.id],b.entry.previous.next=b.entry.next,b.entry.next.previous=b.entry.previous,b.entry.head=null,this.size--,!0):!1};b.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=r();this.size=0};b.prototype.has=function(b){return!!n(this,b).entry};
b.prototype.get=function(b){return(b=n(this,b).entry)&&b.value};b.prototype.entries=function(){return k(this,function(b){return[b.key,b.value]})};b.prototype.keys=function(){return k(this,function(b){return b.key})};b.prototype.values=function(){return k(this,function(b){return b.value})};b.prototype.forEach=function(b,a){for(var l=this.entries(),k;!(k=l.next()).done;)k=k.value,b.call(a,k[1],k[0],this)};b.prototype[Symbol.iterator]=b.prototype.entries;var n=function(b,a){var l=a&&typeof a;"object"==
l||"function"==l?f.has(a)?l=f.get(a):(l=""+ ++L,f.set(a,l)):l="p_"+a;var k=b.data_[l];if(k&&$jscomp.owns(b.data_,l))for(b=0;b<k.length;b++){var m=k[b];if(a!==a&&m.key!==m.key||a===m.key)return{id:l,list:k,index:b,entry:m}}return{id:l,list:k,index:-1,entry:void 0}},k=function(b,a){var l=b.head_;return $jscomp.iteratorPrototype(function(){if(l){for(;l.head!=b.head_;)l=l.previous;for(;l.next!=l.head;)return l=l.next,{done:!1,value:a(l)};l=null}return{done:!0,value:void 0}})},r=function(){var b={};return b.previous=
b.next=b.head=b},L=0;return b},"es6","es3");
$jscomp.polyfill("Set",function(d){function p(){if($jscomp.ASSUME_NO_NATIVE_SET||!d||"function"!=typeof d||!d.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),n=new d($jscomp.makeIterator([b]));if(!n.has(b)||1!=n.size||n.add(b)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var k=n.entries(),r=k.next();if(r.done||r.value[0]!=b||r.value[1]!=b)return!1;r=k.next();return r.done||r.value[0]==b||4!=r.value[0].x||r.value[1]!=r.value[0]?!1:k.next().done}catch(L){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(d&&$jscomp.ES6_CONFORMANCE)return d}else if(p())return d;$jscomp.initSymbol();$jscomp.initSymbolIterator();var f=function(b){this.map_=new Map;if(b){b=$jscomp.makeIterator(b);for(var d;!(d=b.next()).done;)this.add(d.value)}this.size=this.map_.size};f.prototype.add=function(b){b=0===b?0:b;this.map_.set(b,b);this.size=this.map_.size;return this};f.prototype.delete=function(b){b=this.map_.delete(b);this.size=this.map_.size;return b};f.prototype.clear=
function(){this.map_.clear();this.size=0};f.prototype.has=function(b){return this.map_.has(b)};f.prototype.entries=function(){return this.map_.entries()};f.prototype.values=function(){return this.map_.values()};f.prototype.keys=f.prototype.values;f.prototype[Symbol.iterator]=f.prototype.values;f.prototype.forEach=function(b,d){var k=this;this.map_.forEach(function(n){return b.call(d,n,n,k)})};return f},"es6","es3");
(function(d){"object"===typeof exports&&"undefined"!==typeof module?module.exports=d():"function"===typeof define&&define.amd?define([],d):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).imsc=d()})(function(){return function(){function d(p,f,b){function n(r,I){if(!f[r]){if(!p[r]){var a="function"==typeof require&&require;if(!I&&a)return a(r,!0);if(k)return k(r,!0);I=Error("Cannot find module '"+r+"'");throw I.code="MODULE_NOT_FOUND",I;}I=
f[r]={exports:{}};p[r][0].call(I.exports,function(a){return n(p[r][1][a]||a)},I,I.exports,d,p,f,b)}return f[r].exports}for(var k="function"==typeof require&&require,r=0;r<b.length;r++)n(b[r]);return n}return d}()({1:[function(d,p,f){(function(b,d,k,r,f){function n(a,c){var e=a.styleAttrs&&a.styleAttrs["http://www.w3.org/ns/ttml#styling backgroundColor"];if("span"===a.kind)!e&&c&&(a.styleAttrs||(a.styleAttrs={}),a.styleAttrs["http://www.w3.org/ns/ttml#styling backgroundColor"]=c);else if(e&&delete a.styleAttrs["http://www.w3.org/ns/ttml#styling backgroundColor"],
a.contents)for(var g=0;g<a.contents.length;g++)n(a.contents[g],e||c)}function a(c){if("contents"in c){var e="styleAttrs"in c?c.styleAttrs[r.byName.ruby.qname]:null;e="span"===c.kind&&("container"===e||"textContainer"===e||"baseContainer"===e);for(var g=c.contents.length-1;0<=g;g--)!e||"styleAttrs"in c.contents[g]&&r.byName.ruby.qname in c.contents[g].styleAttrs?a(c.contents[g]):delete c.contents[g]}}function l(a,c,e,g){var b=g&&"seq"===g.timeContainer,h=0;g&&(h=b&&e?e.end:g.begin);c.begin=c.explicit_begin?
c.explicit_begin+h:h;e=c.begin;g=null;for(var y in c.sets)l(a,c.sets[y],g,c),e="seq"===c.timeContainer?c.sets[y].end:Math.max(e,c.sets[y].end),g=c.sets[y];if("contents"in c)for(var k in c.contents)l(a,c.contents[k],g,c),e="seq"===c.timeContainer?c.contents[k].end:Math.max(e,c.contents[k].end),g=c.contents[k];else e=b?c.begin:Number.POSITIVE_INFINITY;c.end=null!==c.explicit_end&&null!==c.explicit_dur?Math.min(c.begin+c.explicit_dur,h+c.explicit_end):null===c.explicit_end&&null!==c.explicit_dur?c.begin+
c.explicit_dur:null!==c.explicit_end&&null===c.explicit_dur?h+c.explicit_end:e;delete c.explicit_begin;delete c.explicit_dur;delete c.explicit_end;a._registerEvent(c)}function E(c){this.node=c}function m(){this.events=[];this.head=new q;this.body=null}function q(){this.styling=new C;this.layout=new B}function C(){this.styles={};this.initials={}}function w(){this.styleRefs=this.styleAttrs=this.id=null}function p(){this.styleAttrs=null}function B(){this.regions={}}function u(c,a){this.kind="image";
this.src=c;this.type=a}function F(c){this.id=c}function c(c){this.regionID=c}function h(c){this.styleAttrs=c}function e(c){this.sets=c}function g(c){this.contents=c}function t(c,a,e){this.explicit_begin=c;this.explicit_end=a;this.explicit_dur=e}function v(){this.kind="body"}function P(){this.kind="div"}function x(){this.kind="p"}function M(){this.kind="span"}function R(){this.kind="span"}function A(){this.kind="br"}function N(){}function z(){}function L(c){var a=null;c&&(c=c.attributes["xml:id"]||
c.attributes.id)&&(a=c.value||null);return a}function G(c){return c&&"style"in c.attributes?c.attributes.style.value.split(" "):[]}function S(c,a){var e={};if(null!==c)for(var g in c.attributes){var b=c.attributes[g].uri+" "+c.attributes[g].local,l=r.byQName[b];if(void 0!==l){var h=l.parse(c.attributes[g].value);null!==h?(e[b]=h,l===r.byName.zIndex&&K(a,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):J(a,"Cannot parse styling attribute "+b+" --\x3e "+c.attributes[g].value)}}return e}
function O(c,a,e){for(var g in c.attributes)if(c.attributes[g].uri===a&&c.attributes[g].local===e)return c.attributes[g].value;return null}function Z(c,a){c=O(c,k.ns_tts,"extent");if(null===c)return null;var e=c.split(" ");if(2!==e.length)return K(a,"Malformed extent (ignoring)"),null;c=f.parseLength(e[0]);e=f.parseLength(e[1]);return e&&c?{h:e,w:c}:(K(a,"Malformed extent values (ignoring)"),null)}function U(c,a,e){var g=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/,b=/^(\d{2,}):(\d\d):(\d\d):(\d{2,})$/,l=
/^(\d+(?:\.\d+)?)t$/,h=/^(\d+(?:\.\d+)?)ms$/,k=/^(\d+(?:\.\d+)?)s$/,m=/^(\d+(?:\.\d+)?)h$/,d=/^(\d+(?:\.\d+)?)m$/,t,y=null;null!==(t=/^(\d+(?:\.\d+)?)f$/.exec(e))?null!==a&&(y=parseFloat(t[1])/a):null!==(t=l.exec(e))?null!==c&&(y=parseFloat(t[1])/c):null!==(t=h.exec(e))?y=parseFloat(t[1])/1E3:null!==(t=k.exec(e))?y=parseFloat(t[1]):null!==(t=m.exec(e))?y=3600*parseFloat(t[1]):null!==(t=d.exec(e))?y=60*parseFloat(t[1]):null!==(t=g.exec(e))?y=3600*parseInt(t[1])+60*parseInt(t[2])+parseFloat(t[3]):null!==
(t=b.exec(e))&&null!==a&&(y=3600*parseInt(t[1])+60*parseInt(t[2])+parseInt(t[3])+(null===t[4]?0:parseInt(t[4])/a));return y}function W(c,a,e){for(;0<a.styleRefs.length;){var g=a.styleRefs.pop();g in c.styles?(W(c,c.styles[g],e),V(c.styles[g].styleAttrs,a.styleAttrs)):J(e,"Non-existant style id referenced")}}function X(c,a,e,g){for(var b=a.length-1;0<=b;b--){var l=a[b];l in c.styles?V(c.styles[l].styleAttrs,e):J(g,"Non-existant style id referenced")}}function V(c,a){for(var e in c)e in a||(a[e]=c[e])}
function K(c,a){if(c&&c.warn&&c.warn(a))throw a;}function J(c,a){if(c&&c.error&&c.error(a))throw a;}function D(c,a){c&&c.fatal&&c.fatal(a);throw a;}function Y(c,a){for(var e=0,g=c.length-1,b;e<=g;){b=Math.floor((e+g)/2);var l=c[b];if(l<a)e=b+1;else if(l>a)g=b-1;else return{found:!0,index:b}}return{found:!1,index:e}}b.fromXML=function(c,e,g){var b=d.parser(!0,{xmlns:!0}),h=[],t=[],y=[],Q=0,f=null;b.onclosetag=function(c){if(h[0]instanceof N)null!==f.head&&null!==f.head.styling&&X(f.head.styling,h[0].styleRefs,
h[0].styleAttrs,e),delete h[0].styleRefs;else if(h[0]instanceof C)for(var a in h[0].styles)W(h[0],h[0].styles[a],e);else if(h[0]instanceof x||h[0]instanceof M){if(1<h[0].contents.length){c=[h[0].contents[0]];for(a=1;a<h[0].contents.length;a++)h[0].contents[a]instanceof R&&c[c.length-1]instanceof R?c[c.length-1].text+=h[0].contents[a].text:c.push(h[0].contents[a]);h[0].contents=c}h[0]instanceof M&&1===h[0].contents.length&&h[0].contents[0]instanceof R&&(h[0].text=h[0].contents[0].text,delete h[0].contents)}else if(h[0]instanceof
E)if(h[0].node.uri===k.ns_tt&&"metadata"===h[0].node.local)Q--;else if(0<Q&&g&&"onCloseTag"in g)g.onCloseTag();y.shift();t.shift();h.shift()};b.ontext=function(c){if(void 0!==h[0])if(h[0]instanceof M||h[0]instanceof x){if(h[0]instanceof M){var a=h[0].styleAttrs[r.byName.ruby.qname];if("container"===a||"textContainer"===a||"baseContainer"===a)return}a=new R;a.initFromText(f,h[0],c,y[0],e);h[0].contents.push(a)}else if(h[0]instanceof E&&0<Q&&g&&"onText"in g)g.onText(c)};b.onopentag=function(c){function a(c){k.ttaf_map[c.uri]&&
(c.uri=k.ttaf_map[c.uri])}var b=c.attributes["xml:space"];b?y.unshift(b.value):0===y.length?y.unshift("default"):y.unshift(y[0]);(b=c.attributes["xml:lang"])?t.unshift(b.value):0===t.length?t.unshift(""):t.unshift(t[0]);a(c);if(c.attributes)for(var l in c.attributes)c.attributes.hasOwnProperty(l)&&a(c.attributes[l]);if(c.uri===k.ns_tt)if("tt"===c.local)null!==f&&D(e,"Two <tt> elements at ("+this.line+","+this.column+")"),f=new m,f.initFromNode(c,e),h.unshift(f);else if("head"===c.local)h[0]instanceof
m||D(e,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),h.unshift(f.head);else if("styling"===c.local)h[0]instanceof q||D(e,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),h.unshift(f.head.styling);else if("style"===c.local)if(h[0]instanceof C){var d=new w;d.initFromNode(c,e);d.id?f.head.styling.styles[d.id]=d:J(e,"<style> element missing @id attribute");h.unshift(d)}else h[0]instanceof N?(d=new w,d.initFromNode(c,e),V(d.styleAttrs,h[0].styleAttrs),
h.unshift(d)):D(e,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")");else if("initial"===c.local)if(h[0]instanceof C){l=new p;l.initFromNode(c,e);for(d in l.styleAttrs)f.head.styling.initials[d]=l.styleAttrs[d];h.unshift(l)}else D(e,"Parent of <initial> element is not <styling> at ("+this.line+","+this.column+")");else if("layout"===c.local)h[0]instanceof q||D(e,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),h.unshift(f.head.layout);
else if("region"===c.local)h[0]instanceof B||D(e,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")"),d=new N,d.initFromNode(f,c,e),!d.id||d.id in f.head.layout.regions?J(e,"Ignoring <region> with duplicate or missing @id at "+this.line+","+this.column+")"):f.head.layout.regions[d.id]=d,h.unshift(d);else if("body"===c.local)h[0]instanceof m||D(e,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),null!==f.body&&D(e,"Second <body> element at "+this.line+
","+this.column+")"),d=new v,d.initFromNode(f,c,e),f.body=d,h.unshift(d);else if("div"===c.local){h[0]instanceof P||h[0]instanceof v||D(e,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")");d=new P;d.initFromNode(f,h[0],c,e);if(l=d.styleAttrs[r.byName.backgroundImage.qname])d.contents.push(new u(l)),delete d.styleAttrs[r.byName.backgroundImage.qname];h[0].contents.push(d);h.unshift(d)}else"image"===c.local?(h[0]instanceof P||D(e,"Parent of <image> element is not <div> at "+
this.line+","+this.column+")"),d=new u,d.initFromNode(f,h[0],c,e),h[0].contents.push(d),h.unshift(d)):"p"===c.local?(h[0]instanceof P||D(e,"Parent of <p> element is not <div> at "+this.line+","+this.column+")"),d=new x,d.initFromNode(f,h[0],c,e),h[0].contents.push(d),h.unshift(d)):"span"===c.local?(h[0]instanceof M||h[0]instanceof x||D(e,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")"),d=new M,d.initFromNode(f,h[0],c,y[0],e),h[0].contents.push(d),h.unshift(d)):"br"===
c.local?(h[0]instanceof M||h[0]instanceof x||D(e,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")"),d=new A,d.initFromNode(f,h[0],c,e),h[0].contents.push(d),h.unshift(d)):"set"===c.local?(h[0]instanceof M||h[0]instanceof x||h[0]instanceof P||h[0]instanceof v||h[0]instanceof N||h[0]instanceof A||D(e,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")"),d=new z,d.initFromNode(f,h[0],c,e),h[0].sets.push(d),h.unshift(d)):h.unshift(new E(c));
else h.unshift(new E(c));if(h[0]instanceof E)if(c.uri===k.ns_tt&&"metadata"===c.local)Q++;else if(0<Q&&g&&"onOpenTag"in g){d=[];for(var n in c.attributes)d[c.attributes[n].uri+" "+c.attributes[n].local]={uri:c.attributes[n].uri,local:c.attributes[n].local,value:c.attributes[n].value};g.onOpenTag(c.uri,c.local,d)}};b.write(c).close();delete f.head.styling.styles;c=!1;for(var T in f.head.layout.regions){c=!0;break}c||(T=N.prototype.createDefaultRegion(f,e),f.head.layout.regions[T.id]=T);for(var F in f.head.layout.regions)l(f,
f.head.layout.regions[F],null,null);f.body&&l(f,f.body,null,null);f.body&&a(f.body);f.body&&n(f.body);return f};m.prototype.initFromNode=function(c,a){var e=O(c,k.ns_ttp,"cellResolution"),h=15;var g=32;null!==e&&(e=/(\d+) (\d+)/.exec(e),null!==e?(g=parseInt(e[1]),h=parseInt(e[2])):K(a,"Malformed cellResolution value (using initial value instead)"));this.cellLength={h:new f.ComputedLength(0,1/h),w:new f.ComputedLength(1/g,0)};h=O(c,k.ns_ttp,"frameRate");e=30;null!==h&&(g=/(\d+)/.exec(h),null!==g?e=
parseInt(g[1]):K(a,"Malformed frame rate attribute (using initial value instead)"));g=O(c,k.ns_ttp,"frameRateMultiplier");var b=1;null!==g&&(g=/(\d+) (\d+)/.exec(g),null!==g?b=parseInt(g[1])/parseInt(g[2]):K(a,"Malformed frame rate multiplier attribute (using initial value instead)"));e*=b;b=1;g=O(c,k.ns_ttp,"tickRate");null===g?null!==h&&(b=e):(g=/(\d+)/.exec(g),null!==g?b=parseInt(g[1]):K(a,"Malformed tick rate attribute (using initial value instead)"));this.effectiveFrameRate=e;this.tickRate=b;
g=O(c,k.ns_ittp,"aspectRatio");null===g&&(g=O(c,k.ns_ttp,"displayAspectRatio"));h=null;null!==g&&(e=/(\d+)\s+(\d+)/.exec(g),null!==e?(g=parseInt(e[1]),e=parseInt(e[2]),0!==g&&0!==e?h=g/e:J(a,"Illegal aspectRatio values (ignoring)")):J(a,"Malformed aspectRatio attribute (ignoring)"));this.aspectRatio=h;h=O(c,k.ns_ttp,"timeBase");null!==h&&"media"!==h&&D(a,"Unsupported time base");c=Z(c,a);null===c?this.pxLength={h:null,w:null}:("px"===c.h.unit&&"px"===c.w.unit||D(a,"Extent on TT must be in px or absent"),
this.pxLength={h:new f.ComputedLength(0,1/c.h.value),w:new f.ComputedLength(1/c.w.value,0)});this.dimensions={h:new f.ComputedLength(0,1),w:new f.ComputedLength(1,0)}};m.prototype._registerEvent=function(c){if(!(c.end<=c.begin)){var a=Y(this.events,c.begin);a.found||this.events.splice(a.index,0,c.begin);c.end!==Number.POSITIVE_INFINITY&&(a=Y(this.events,c.end),a.found||this.events.splice(a.index,0,c.end))}};m.prototype.getMediaTimeRange=function(){return[this.events[0],this.events[this.events.length-
1]]};m.prototype.getMediaTimeEvents=function(){return this.events};w.prototype.initFromNode=function(c,a){this.id=L(c);this.styleAttrs=S(c,a);this.styleRefs=G(c)};p.prototype.initFromNode=function(c,a){this.styleAttrs={};for(var e in c.attributes)if(c.attributes[e].uri===k.ns_itts||c.attributes[e].uri===k.ns_ebutts||c.attributes[e].uri===k.ns_tts)this.styleAttrs[c.attributes[e].uri+" "+c.attributes[e].local]=c.attributes[e].value};u.prototype.initFromNode=function(a,g,b,l){(this.src="src"in b.attributes?
b.attributes.src.value:null)||J(l,"Invalid image@src attribute");(this.type="type"in b.attributes?b.attributes.type.value:null)||J(l,"Invalid image@type attribute");h.prototype.initFromNode.call(this,a,g,b,l);t.prototype.initFromNode.call(this,a,g,b,l);e.prototype.initFromNode.call(this,a,g,b,l);c.prototype.initFromNode.call(this,a,g,b,l)};F.prototype.initFromNode=function(c,a,e,h){this.id=L(e)};c.prototype.initFromNode=function(c,a,e,h){this.regionID=e&&"region"in e.attributes?e.attributes.region.value:
""};h.prototype.initFromNode=function(c,a,e,h){this.styleAttrs=S(e,h);null!==c.head&&null!==c.head.styling&&X(c.head.styling,G(e),this.styleAttrs,h)};e.prototype.initFromNode=function(c,a,e,h){this.sets=[]};g.prototype.initFromNode=function(c,a,e,h){this.contents=[]};t.prototype.initFromNode=function(c,a,e,h){a=null;e&&"begin"in e.attributes&&(a=U(c.tickRate,c.effectiveFrameRate,e.attributes.begin.value),null===a&&K(h,"Malformed begin value "+e.attributes.begin.value+" (using 0)"));var g=null;e&&
"dur"in e.attributes&&(g=U(c.tickRate,c.effectiveFrameRate,e.attributes.dur.value),null===g&&K(h,"Malformed dur value "+e.attributes.dur.value+" (ignoring)"));var b=null;e&&"end"in e.attributes&&(b=U(c.tickRate,c.effectiveFrameRate,e.attributes.end.value),null===b&&K(h,"Malformed end value (ignoring)"));this.explicit_begin=a;this.explicit_end=b;this.explicit_dur=g;(c=e&&"timeContainer"in e.attributes?e.attributes.timeContainer.value:null)&&"par"!==c?"seq"===c?h="seq":(J(h,"Illegal value of timeContainer (assuming 'par')"),
h="par"):h="par";this.timeContainer=h};v.prototype.initFromNode=function(a,b,l){h.prototype.initFromNode.call(this,a,null,b,l);t.prototype.initFromNode.call(this,a,null,b,l);e.prototype.initFromNode.call(this,a,null,b,l);c.prototype.initFromNode.call(this,a,null,b,l);g.prototype.initFromNode.call(this,a,null,b,l)};P.prototype.initFromNode=function(a,b,l,d){h.prototype.initFromNode.call(this,a,b,l,d);t.prototype.initFromNode.call(this,a,b,l,d);e.prototype.initFromNode.call(this,a,b,l,d);c.prototype.initFromNode.call(this,
a,b,l,d);g.prototype.initFromNode.call(this,a,b,l,d)};x.prototype.initFromNode=function(a,b,l,d){h.prototype.initFromNode.call(this,a,b,l,d);t.prototype.initFromNode.call(this,a,b,l,d);e.prototype.initFromNode.call(this,a,b,l,d);c.prototype.initFromNode.call(this,a,b,l,d);g.prototype.initFromNode.call(this,a,b,l,d)};M.prototype.initFromNode=function(a,b,l,d,k){h.prototype.initFromNode.call(this,a,b,l,k);t.prototype.initFromNode.call(this,a,b,l,k);e.prototype.initFromNode.call(this,a,b,l,k);c.prototype.initFromNode.call(this,
a,b,l,k);g.prototype.initFromNode.call(this,a,b,l,k);this.space=d};R.prototype.initFromText=function(c,a,e,h,g){t.prototype.initFromNode.call(this,c,a,null,g);this.text=e;this.space=h};A.prototype.initFromNode=function(a,e,h,g){c.prototype.initFromNode.call(this,a,e,h,g);t.prototype.initFromNode.call(this,a,e,h,g)};N.prototype.createDefaultRegion=function(c,a){var e=new N;e.id="";h.prototype.initFromNode.call(e,c,null,{name:"region",attributes:{"tts:displayAlign":{name:"tts:displayAlign",value:"after",
prefix:"tts",local:"displayAlign",uri:"http://www.w3.org/ns/ttml#styling"},"tts:extent":{name:"tts:extent",value:"80% 20%",prefix:"tts",local:"extent",uri:"http://www.w3.org/ns/ttml#styling"},"tts:origin":{name:"tts:origin",value:"10% 70%",prefix:"tts",local:"origin",uri:"http://www.w3.org/ns/ttml#styling"},"tts:overflow":{name:"tts:overflow",value:"visible",prefix:"tts",local:"overflow",uri:"http://www.w3.org/ns/ttml#styling"}},ns:{"":"http://www.w3.org/ns/ttml",ebuttm:"urn:ebu:tt:metadata",ebutts:"urn:ebu:tt:style",
ittp:"http://www.w3.org/ns/ttml/profile/imsc1#parameter",itts:"http://www.w3.org/ns/ttml/profile/imsc1#styling",ttm:"http://www.w3.org/ns/ttml#metadata",ttp:"http://www.w3.org/ns/ttml#parameter",tts:"http://www.w3.org/ns/ttml#styling",xml:"http://www.w3.org/XML/1998/namespace"},prefix:"",local:"region",uri:"http://www.w3.org/ns/ttml",isSelfClosing:!0},a);e.sets=[];t.call(e,0,Number.POSITIVE_INFINITY,null);return e};N.prototype.initFromNode=function(c,a,h){F.prototype.initFromNode.call(this,c,null,
a,h);t.prototype.initFromNode.call(this,c,null,a,h);e.prototype.initFromNode.call(this,c,null,a,h);this.styleAttrs=S(a,h);this.styleRefs=G(a)};z.prototype.initFromNode=function(c,a,e,h){t.prototype.initFromNode.call(this,c,a,e,h);c=S(e,h);this.value=this.qname=null;for(var g in c){if(this.qname){J(h,"More than one style specified on set");break}this.qname=g;this.value=c[g]}}})("undefined"===typeof f?this.imscDoc={}:f,"undefined"===typeof sax?d("sax"):sax,"undefined"===typeof imscNames?d("./names"):
imscNames,"undefined"===typeof imscStyles?d("./styles"):imscStyles,"undefined"===typeof imscUtils?d("./utils"):imscUtils)},{"./names":5,"./styles":6,"./utils":7,sax:void 0}],2:[function(d,p,f){(function(b,d,k,f){function n(c){var a={};c=Object.entries(c);for(var e in c){var g=f.parseColor(c[e][0]),b=f.parseColor(c[e][1]);g&&b&&(a[g.toString()]=b)}return a}function r(c,h,e){if("region"===e.kind){var g=document.createElement("div");g.style.position="absolute"}else if("body"===e.kind)g=document.createElement("div");
else if("div"===e.kind)g=document.createElement("div");else if("image"===e.kind){if(g=document.createElement("img"),null!==c.imgResolver&&null!==e.src){var b=c.imgResolver(e.src,g);b&&(g.src=b);g.height=c.regionH;g.width=c.regionW}}else if("p"===e.kind)g=document.createElement("p");else if("span"===e.kind)if("container"===e.styleAttrs[k.byName.ruby.qname])g=document.createElement("ruby"),c.ruby=!0;else if("base"===e.styleAttrs[k.byName.ruby.qname])g=document.createElement("rb");else if("text"===e.styleAttrs[k.byName.ruby.qname])g=
document.createElement("rt");else if("baseContainer"===e.styleAttrs[k.byName.ruby.qname])g=document.createElement("rbc");else if("textContainer"===e.styleAttrs[k.byName.ruby.qname])g=document.createElement("rtc");else{if("delimiter"===e.styleAttrs[k.byName.ruby.qname])return;g=document.createElement("span")}else"br"===e.kind&&(g=document.createElement("br"));if(g){h.appendChild(g);g.style.margin="0";if("region"===e.kind)if(h=e.styleAttrs[k.byName.writingMode.qname],"lrtb"===h||"lr"===h)c.ipd="lr",
c.bpd="tb";else if("rltb"===h||"rl"===h)c.ipd="rl",c.bpd="tb";else if("tblr"===h)c.ipd="tb",c.bpd="lr";else{if("tbrl"===h||"tb"===h)c.ipd="tb",c.bpd="rl"}else"p"===e.kind&&"tb"===c.bpd&&(c.ipd="ltr"===e.styleAttrs[k.byName.direction.qname]?"lr":"rl");for(var d in C)h=C[d],b=e.styleAttrs[h.qname],void 0!==b&&null!==h.map&&h.map(c,g,e,b);d=g;(h=e.styleAttrs[k.byName.linePadding.qname])&&!h.isZero()&&(b=h.multiply(h.toUsedLength(c.w,c.h),c.options.sizeAdjust),0<b&&(b=Math.ceil(b)+"px","tb"===c.bpd?(d.style.paddingLeft=
b,d.style.paddingRight=b):(d.style.paddingTop=b,d.style.paddingBottom=b),c.lp=h));(h=e.styleAttrs[k.byName.multiRowAlign.qname])&&"auto"!==h&&(d=document.createElement("span"),d.style.display="inline-block",d.style.textAlign=h,g.appendChild(d),c.mra=h);(h=e.styleAttrs[k.byName.rubyReserve.qname])&&"none"!==h[0]&&(c.rubyReserve=h);e.styleAttrs[k.byName.fillLineGap.qname]&&(c.flg=!0);if("span"===e.kind&&e.text)if((h=e.styleAttrs[k.byName.textEmphasis.qname])&&"none"!==h.style&&(c.textEmphasis=!0),k.byName.textCombine.qname in
e.styleAttrs&&"all"===e.styleAttrs[k.byName.textCombine.qname][0])g.textContent=e.text,h&&m(c,g,e,h);else{b="";for(var f=0;f<e.text.length;f++){b+=e.text.charAt(f);var n=e.text.charCodeAt(f);if(55296>n||56319<n||f===e.text.length)n=document.createElement("span"),n.textContent=b,h&&m(c,n,e,h),g.appendChild(n),b=""}}for(var q in e.contents)r(c,d,e.contents[q]);q=[];if((c.lp||c.mra||c.flg||c.ruby||c.textEmphasis||c.rubyReserve)&&"p"===e.kind){E(c,d,q,null);if(c.rubyReserve){for(h=0;h<q.length;h++){b=
document.createElement("ruby");f=document.createElement("rb");f.textContent="\u200b";b.appendChild(f);var p=c.rubyReserve[1].toUsedLength(c.w,c.h)+"px";"both"===c.rubyReserve[0]||"outside"===c.rubyReserve[0]&&1==q.length?(f=document.createElement("rtc"),f.style[B]=H?"after":"under",f.textContent="\u200b",f.style.fontSize=p,n=document.createElement("rtc"),n.style[B]=H?"before":"over",n.textContent="\u200b",n.style.fontSize=p,b.appendChild(f),b.appendChild(n)):(f=document.createElement("rtc"),f.textContent=
"\u200b",f.style.fontSize=p,f.style[B]="after"===c.rubyReserve[0]||"outside"===c.rubyReserve[0]&&0<h?H?"after":"tb"===c.bpd||"rl"===c.bpd?"under":"over":H?"before":"tb"===c.bpd||"rl"===c.bpd?"over":"under",b.appendChild(f));f=null;for(n=0;n<q[h].rbc.length;n++)if("ruby"===q[h].rbc[n].localName){f=q[h].rbc[n];for(n=0;n<f.style.length;n++)b.style.setProperty(f.style.item(n),f.style.getPropertyValue(f.style.item(n)));break}f=f||q[h].elements[0].node;f.parentElement.insertBefore(b,f)}c.rubyReserve=null}if(c.ruby||
c.rubyReserve){for(h=0;h<q.length;h++)for(b=0;b<q[h].rbc.length;b++)q[h].rbc[b].style[B]||(q[h].rbc[b].style[B]=H?0===h?"before":"after":"tb"===c.bpd?0===h?"over":"under":"rl"===c.bpd?0===h?"over":"under":0===h?"under":"over");c.ruby=null}if(c.textEmphasis){for(h=0;h<q.length;h++)for(b=0;b<q[h].te.length;b++)q[h].te[b].style[F]&&"none"!==q[h].te[b].style[F]||(q[h].te[b].style[F]="tb"===c.bpd?0===h?"left over":"left under":"rl"===c.bpd?0===h?"right under":"left under":0===h?"left under":"right under");
c.textEmphasis=null}if(c.mra){for(h=0;h<q.length-1;h++)f=q[h].elements.length,0!==f&&!1===q[h].br&&(b=document.createElement("br"),f=q[h].elements[f-1].node,f.parentElement.insertBefore(b,f.nextSibling));c.mra=null}if(c.lp){h=c.lp.multiply(c.lp.toUsedLength(c.w,c.h),c.options.sizeAdjust);for(var u in q)b=q[u].elements[q[u].start_elem],f=q[u].elements[q[u].end_elem],n=Math.ceil(h)+"px",p="-"+Math.ceil(h)+"px",0!==q[u].elements.length&&("lr"===c.ipd?(b.node.style.borderLeftColor=b.bgcolor||"#00000000",
b.node.style.borderLeftStyle="solid",b.node.style.borderLeftWidth=n,b.node.style.marginLeft=p):"rl"===c.ipd?(b.node.style.borderRightColor=b.bgcolor||"#00000000",b.node.style.borderRightStyle="solid",b.node.style.borderRightWidth=n,b.node.style.marginRight=p):"tb"===c.ipd&&(b.node.style.borderTopColor=b.bgcolor||"#00000000",b.node.style.borderTopStyle="solid",b.node.style.borderTopWidth=n,b.node.style.marginTop=p),"lr"===c.ipd?(f.node.style.borderRightColor=f.bgcolor||"#00000000",f.node.style.borderRightStyle=
"solid",f.node.style.borderRightWidth=n,f.node.style.marginRight=p):"rl"===c.ipd?(f.node.style.borderLeftColor=f.bgcolor||"#00000000",f.node.style.borderLeftStyle="solid",f.node.style.borderLeftWidth=n,f.node.style.marginLeft=p):"tb"===c.ipd&&(f.node.style.borderBottomColor=f.bgcolor||"#00000000",f.node.style.borderBottomStyle="solid",f.node.style.borderBottomWidth=n,f.node.style.marginBottom=p));c.lp=null}if(c.flg){h=l(d.getBoundingClientRect(),c);u=h.before;h=h.after;b=Math.sign(h-u);for(f=0;f<=
q.length;f++){n=0===f?u:f===q.length?h:(q[f].before+q[f-1].after)/2;if(0<f)for(var w=0;w<q[f-1].elements.length;w++)if(null!==q[f-1].elements[w].bgcolor){var z=q[f-1].elements[w];0>b*(z.after-n)&&(p=Math.ceil(Math.abs(n-z.after))+"px",z.node.style.backgroundColor=z.bgcolor,"lr"===c.bpd?z.node.style.paddingRight=p:"rl"===c.bpd?z.node.style.paddingLeft=p:"tb"===c.bpd&&(z.node.style.paddingBottom=p))}if(f<q.length)for(w=0;w<q[f].elements.length;w++)z=q[f].elements[w],null!==z.bgcolor&&0<b*(z.before-
n)&&(p=Math.ceil(Math.abs(z.before-n))+"px",z.node.style.backgroundColor=z.bgcolor,"lr"===c.bpd?z.node.style.paddingLeft=p:"rl"===c.bpd?z.node.style.paddingRight=p:"tb"===c.bpd&&(z.node.style.paddingTop=p))}c.flg=null}}"region"===e.kind&&(E(c,d,q),"tb"===c.bpd&&c.enableRollUp&&0<e.contents.length&&"after"===e.styleAttrs[k.byName.displayAlign.qname]&&(e=new a(""===e.id?"_":e.id,q),c.currentISDState[e.id]=e,c.previousISDState&&e.id in c.previousISDState&&0<c.previousISDState[e.id].plist.length&&1<e.plist.length&&
e.plist[e.plist.length-2].text===c.previousISDState[e.id].plist[c.previousISDState[e.id].plist.length-1].text&&(c=g.firstElementChild,e=e.plist[e.plist.length-1].after-e.plist[e.plist.length-1].before,c.style.bottom="-"+e+"px",c.style.transition="transform 0.4s",c.style.position="relative",c.style.transform="translateY(-"+e+"px)")))}else if(c=c.errorHandler,e="Error processing ISD element kind: "+e.kind,c&&c.error&&c.error(e))throw e;}function a(c,a){this.id=c;this.plist=a}function l(c,a){var e={before:null,
after:null,start:null,end:null};"tb"===a.bpd?(e.before=c.top,e.after=c.bottom,"lr"===a.ipd?(e.start=c.left,e.end=c.right):(e.start=c.right,e.end=c.left)):"lr"===a.bpd?(e.before=c.left,e.after=c.right,e.start=c.top,e.end=c.bottom):"rl"===a.bpd&&(e.before=c.right,e.after=c.left,e.start=c.top,e.end=c.bottom);return e}function E(c,a,e,b){if("rt"!==a.localName&&"rtc"!==a.localName)if(b=a.style.backgroundColor||b,0===a.childElementCount)if("span"===a.localName||"rb"===a.localName){var g=a.getBoundingClientRect();
if(0!==g.height&&0!==g.width){c=l(g,c);if(!(g=0===e.length)){g=c.before;var h=c.after,d=e[e.length-1].before,f=e[e.length-1].after;g=!(h<f&&g>d||f<=h&&d>=g)}g?e.push({before:c.before,after:c.after,start:c.start,end:c.end,start_elem:0,end_elem:0,elements:[],rbc:[],te:[],text:"",br:!1}):(g=Math.sign(c.after-c.before),h=Math.sign(c.end-c.start),0>g*(c.before-e[e.length-1].before)&&(e[e.length-1].before=c.before),0<g*(c.after-e[e.length-1].after)&&(e[e.length-1].after=c.after),0>h*(c.start-e[e.length-
1].start)&&(e[e.length-1].start=c.start,e[e.length-1].start_elem=e[e.length-1].elements.length),0<h*(c.end-e[e.length-1].end)&&(e[e.length-1].end=c.end,e[e.length-1].end_elem=e[e.length-1].elements.length));e[e.length-1].text+=a.textContent;e[e.length-1].elements.push({node:a,bgcolor:b,before:c.before,after:c.after})}}else"br"===a.localName&&0!==e.length&&(e[e.length-1].br=!0);else for(a=a.firstChild;a;)a.nodeType===Node.ELEMENT_NODE&&(E(c,a,e,b),"ruby"===a.localName||"rtc"===a.localName?0<e.length&&
e[e.length-1].rbc.push(a):"span"===a.localName&&a.style[u]&&"none"!==a.style[u]&&0<e.length&&e[e.length-1].te.push(a)),a=a.nextSibling}function m(c,a,e,b){if("none"===b.style)a.style[u]="none";else if(a.style[u]="auto"===b.style?"filled":b.style+" "+b.symbol,"before"===b.position||"after"===b.position)a.style[F]="tb"===c.bpd?"before"===b.position?"left over":"left under":"rl"===c.bpd?"before"===b.position?"right under":"left under":"before"===b.position?"left under":"right under"}function q(c,a){this.qname=
c;this.map=a}b.render=function(c,a,e,b,l,d,f,k,m,q){b=b||a.clientHeight;var g=l||a.clientWidth;null!==c.aspectRatio&&(l=b*c.aspectRatio,l>g?b=Math.round(g/c.aspectRatio):g=l);l=document.createElement("div");l.style.position="relative";l.style.width=g+"px";l.style.height=b+"px";l.style.margin="auto";l.style.top=0;l.style.bottom=0;l.style.left=0;l.style.right=0;l.style.zIndex=0;e={h:b,w:g,regionH:null,regionW:null,imgResolver:e,displayForcedOnlyMode:d||!1,isd:c,errorHandler:f,previousISDState:k,enableRollUp:m||
!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null,ruby:null,textEmphasis:null,rubyReserve:null,options:Object.assign({},q)||{}};e.options.colorAdjust&&(e.options.colorAdjust=n(e.options.colorAdjust));d=["region","body","div","p","span"];for(var h in d)f=d[h]+"BackgroundColorAdjust",e.options[f]&&(e.options[f]=n(e.options[f]));a.appendChild(l);for(var E in c.contents)r(e,l,c.contents[E]);return e.currentISDState};var C=[new q("http://www.w3.org/ns/ttml#styling backgroundColor",function(c,
a,e,b){(e=(e=c.options[e.kind+"BackgroundColorAdjust"])&&e[b.toString()])&&(b=e);e=b[3];0!==e&&(void 0!=c.options.backgroundOpacityScale&&(e*=c.options.backgroundOpacityScale),a.style.backgroundColor="rgba("+b[0].toString()+","+b[1].toString()+","+b[2].toString()+","+(e/255).toString()+")")}),new q("http://www.w3.org/ns/ttml#styling color",function(c,a,e,b){e=c.options.colorOpacityScale||1;c=c.options.colorAdjust;void 0!=c&&(c=c[b.toString()])&&(b=c);a.style.color="rgba("+b[0].toString()+","+b[1].toString()+
","+b[2].toString()+","+(e*b[3]/255).toString()+")"}),new q("http://www.w3.org/ns/ttml#styling direction",function(c,a,e,b){a.style.direction=b}),new q("http://www.w3.org/ns/ttml#styling display",function(c,a,e,b){}),new q("http://www.w3.org/ns/ttml#styling displayAlign",function(c,a,e,b){a.style.display="flex";a.style.flexDirection="column";"before"===b?a.style.justifyContent="flex-start":"center"===b?a.style.justifyContent="center":"after"===b&&(a.style.justifyContent="flex-end")}),new q("http://www.w3.org/ns/ttml#styling extent",
function(c,a,e,b){c.regionH=b.h.toUsedLength(c.w,c.h);c.regionW=b.w.toUsedLength(c.w,c.h);var g=b=0;if(e=e.styleAttrs["http://www.w3.org/ns/ttml#styling padding"])b=e[0].toUsedLength(c.w,c.h)+e[2].toUsedLength(c.w,c.h),g=e[1].toUsedLength(c.w,c.h)+e[3].toUsedLength(c.w,c.h);a.style.height=c.regionH-b+"px";a.style.width=c.regionW-g+"px"}),new q("http://www.w3.org/ns/ttml#styling fontFamily",function(c,a,e,b){e=[];c.options.fontFamily&&(b=c.options.fontFamily.split(","));for(var h in b)b[h]=b[h].trim(),
"monospaceSerif"===b[h]?(e.push("Courier New"),e.push('"Liberation Mono"'),e.push("Courier"),e.push("monospace")):"proportionalSansSerif"===b[h]||"default"===b[h]?(e.push("Arial"),e.push("Helvetica"),e.push('"Liberation Sans"'),e.push("sans-serif")):"monospace"===b[h]?e.push("monospace"):"sansSerif"===b[h]?e.push("sans-serif"):"serif"===b[h]?e.push("serif"):"monospaceSansSerif"===b[h]?(e.push("Consolas"),e.push("monospace")):"proportionalSerif"===b[h]?e.push("serif"):e.push(b[h]);a.style.fontFamily=
e.join(",")}),new q("http://www.w3.org/ns/ttml#styling shear",function(c,a,b,g){0!==g&&(b=-.9*g,a.style.transform="tb"===c.bpd?"skewX("+b+"deg)":"skewY("+b+"deg)")}),new q("http://www.w3.org/ns/ttml#styling fontSize",function(c,a,b,g){a.style.fontSize=g.multiply(g.toUsedLength(c.w,c.h),c.options.sizeAdjust)+"px"}),new q("http://www.w3.org/ns/ttml#styling fontStyle",function(c,a,b,g){a.style.fontStyle=g}),new q("http://www.w3.org/ns/ttml#styling fontWeight",function(c,a,b,g){a.style.fontWeight=g}),
new q("http://www.w3.org/ns/ttml#styling lineHeight",function(c,a,b,g){a.style.lineHeight="normal"===g?"normal":g.multiply(g.multiply(g.toUsedLength(c.w,c.h),c.options.sizeAdjust),c.options.lineHeightAdjust)+"px"}),new q("http://www.w3.org/ns/ttml#styling opacity",function(c,a,b,g){b=g;void 0!=c.options.regionOpacityScale&&(b*=c.options.regionOpacityScale);a.style.opacity=b}),new q("http://www.w3.org/ns/ttml#styling origin",function(c,a,b,g){a.style.top=g.h.toUsedLength(c.w,c.h)+"px";a.style.left=
g.w.toUsedLength(c.w,c.h)+"px"}),new q("http://www.w3.org/ns/ttml#styling overflow",function(c,a,b,g){a.style.overflow=g}),new q("http://www.w3.org/ns/ttml#styling padding",function(c,a,b,g){b=[];b[0]=g[0].toUsedLength(c.w,c.h)+"px";b[1]=g[3].toUsedLength(c.w,c.h)+"px";b[2]=g[2].toUsedLength(c.w,c.h)+"px";b[3]=g[1].toUsedLength(c.w,c.h)+"px";a.style.padding=b.join(" ")}),new q("http://www.w3.org/ns/ttml#styling position",function(c,a,b,g){a.style.top=g.h.toUsedLength(c.w,c.h)+"px";a.style.left=g.w.toUsedLength(c.w,
c.h)+"px"}),new q("http://www.w3.org/ns/ttml#styling rubyAlign",function(c,a,b,g){a.style.rubyAlign="spaceAround"===g?"space-around":"center"}),new q("http://www.w3.org/ns/ttml#styling rubyPosition",function(c,a,b,g){if("before"===g||"after"===g)a.parentElement.style[B]=H?g:"tb"===c.bpd?"before"===g?"over":"under":"rl"===c.bpd?"before"===g?"over":"under":"before"===g?"under":"over"}),new q("http://www.w3.org/ns/ttml#styling showBackground",null),new q("http://www.w3.org/ns/ttml#styling textAlign",
function(c,a,b,g){a.style.textAlign="start"===g?"rl"===c.ipd?"right":"left":"end"===g?"rl"===c.ipd?"left":"right":g}),new q("http://www.w3.org/ns/ttml#styling textDecoration",function(c,a,b,g){a.style.textDecoration=g.join(" ").replace("lineThrough","line-through")}),new q("http://www.w3.org/ns/ttml#styling textOutline",function(c,a,b,g){}),new q("http://www.w3.org/ns/ttml#styling textShadow",function(c,a,b,g){b=b.styleAttrs[k.byName.textOutline.qname];var e=c.options.textOutline;if(e)if("none"===
e)b=e;else{var l={};e=e.split(" ");if(0!==e.length&&2>=e.length){var h=f.parseColor(e[0]);l.color=h;null!==h&&e.shift();1===e.length&&(e=f.parseLength(e[0]))&&(l.thickness=e,b=l)}}if("none"===g&&"none"===b)a.style.textShadow="";else{l=[];"none"!==b&&(b="rgba("+b.color[0].toString()+","+b.color[1].toString()+","+b.color[2].toString()+","+(b.color[3]/255).toString()+")",l.push("1px 1px 1px "+b),l.push("-1px 1px 1px "+b),l.push("1px -1px 1px "+b),l.push("-1px -1px 1px "+b));if("none"!==g)for(var d in g)l.push(g[d].x_off.toUsedLength(c.w,
c.h)+"px "+g[d].y_off.toUsedLength(c.w,c.h)+"px "+g[d].b_radius.toUsedLength(c.w,c.h)+"px rgba("+g[d].color[0].toString()+","+g[d].color[1].toString()+","+g[d].color[2].toString()+","+(g[d].color[3]/255).toString()+")");a.style.textShadow=l.join(",")}}),new q("http://www.w3.org/ns/ttml#styling textCombine",function(c,a,b,l){a.style.textCombineUpright=l.join(" ")}),new q("http://www.w3.org/ns/ttml#styling textEmphasis",function(c,a,b,l){}),new q("http://www.w3.org/ns/ttml#styling unicodeBidi",function(c,
a,b,l){a.style.unicodeBidi="bidiOverride"===l?"bidi-override":l}),new q("http://www.w3.org/ns/ttml#styling visibility",function(c,a,b,l){a.style.visibility=l}),new q("http://www.w3.org/ns/ttml#styling wrapOption",function(c,a,b,l){a.style.whiteSpace="wrap"===l?"preserve"===b.space?"pre-wrap":"normal":"preserve"===b.space?"pre":"noWrap"}),new q("http://www.w3.org/ns/ttml#styling writingMode",function(c,a,b,l){if("lrtb"===l||"lr"===l)a.style.writingMode="horizontal-tb";else if("rltb"===l||"rl"===l)a.style.writingMode=
"horizontal-tb";else if("tblr"===l)a.style.writingMode="vertical-lr";else if("tbrl"===l||"tb"===l)a.style.writingMode="vertical-rl"}),new q("http://www.w3.org/ns/ttml#styling zIndex",function(a,b,e,l){b.style.zIndex=l}),new q("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",function(a,b,e,l){a.displayForcedOnlyMode&&!1===l&&(b.style.visibility="hidden")})],p;for(p in C);var H="webkitRubyPosition"in window.getComputedStyle(document.documentElement),B=H?"webkitRubyPosition":"rubyPosition",
u="webkitTextEmphasisStyle"in window.getComputedStyle(document.documentElement)?"webkitTextEmphasisStyle":"textEmphasisStyle",F="webkitTextEmphasisPosition"in window.getComputedStyle(document.documentElement)?"webkitTextEmphasisPosition":"textEmphasisPosition"})("undefined"===typeof f?this.imscHTML={}:f,"undefined"===typeof imscNames?d("./names"):imscNames,"undefined"===typeof imscStyles?d("./styles"):imscStyles,"undefined"===typeof imscUtils?d("./utils"):imscUtils)},{"./names":5,"./styles":6,"./utils":7}],
3:[function(d,p,f){(function(b,d,f,r){function k(b,d,E,p,u,F,c,h,e){if(d<c.begin||d>=c.end)return null;F="regionID"in c&&""!==c.regionID?c.regionID:F;if(null!==u&&F!==E.id&&(!("contents"in c)||"contents"in c&&0===c.contents.length||""!==F))return null;var g=new m(c);for(C in c.sets)d<c.sets[C].begin||d>=c.sets[C].end||(g.styleAttrs[c.sets[C].qname]=c.sets[C].value);var C={};for(var v in g.styleAttrs)if(C[v]=!0,"region"===g.kind&&v===f.byName.writingMode.qname&&!(f.byName.direction.qname in g.styleAttrs)){var w=
g.styleAttrs[v];if("lrtb"===w||"lr"===w)g.styleAttrs[f.byName.direction.qname]="ltr";else if("rltb"===w||"rl"===w)g.styleAttrs[f.byName.direction.qname]="rtl"}if(null!==u)for(var x in f.all)if(v=f.all[x],v.qname===f.byName.textDecoration.qname){w=u.styleAttrs[v.qname];var B=g.styleAttrs[v.qname],H=[];void 0===B?H=w:-1===B.indexOf("none")?((-1===B.indexOf("noUnderline")&&-1!==w.indexOf("underline")||-1!==B.indexOf("underline"))&&H.push("underline"),(-1===B.indexOf("noLineThrough")&&-1!==w.indexOf("lineThrough")||
-1!==B.indexOf("lineThrough"))&&H.push("lineThrough"),(-1===B.indexOf("noOverline")&&-1!==w.indexOf("overline")||-1!==B.indexOf("overline"))&&H.push("overline")):H.push("none");g.styleAttrs[v.qname]=H}else v.qname!==f.byName.fontSize.qname||v.qname in g.styleAttrs||"span"!==g.kind||"textContainer"!==g.styleAttrs[f.byName.ruby.qname]?v.qname!==f.byName.fontSize.qname||v.qname in g.styleAttrs||"span"!==g.kind||"text"!==g.styleAttrs[f.byName.ruby.qname]?v.inherit&&v.qname in u.styleAttrs&&!(v.qname in
g.styleAttrs)&&(g.styleAttrs[v.qname]=u.styleAttrs[v.qname]):(w=u.styleAttrs[f.byName.fontSize.qname],g.styleAttrs[v.qname]="textContainer"===u.styleAttrs[f.byName.ruby.qname]?w:new r.ComputedLength(.5*w.rw,.5*w.rh)):(w=u.styleAttrs[f.byName.fontSize.qname],g.styleAttrs[v.qname]=new r.ComputedLength(.5*w.rw,.5*w.rh));for(var A in f.all)if(x=f.all[A],!(x.qname in g.styleAttrs||x.qname===f.byName.position.qname&&f.byName.origin.qname in g.styleAttrs||x.qname===f.byName.origin.qname&&f.byName.position.qname in
g.styleAttrs)&&(v=b.head.styling.initials[x.qname]||x.initial,null!==v&&("region"===g.kind||!1===x.inherit&&null!==v)))if(v=x.parse(v),null!==v)g.styleAttrs[x.qname]=v,C[x.qname]=!0;else if(x="Invalid initial value for '"+x.qname+"' on element '"+g.kind,h&&h.error&&h.error(x))throw x;for(var I in f.all)if(A=f.all[I],A.qname in C&&null!==A.compute)if(x=A.compute(b,u,g,g.styleAttrs[A.qname],e),null!==x)g.styleAttrs[A.qname]=x;else if(g.styleAttrs[A.qname]=A.compute(b,u,g,A.parse(A.initial),e),A="Style '"+
A.qname+"' on element '"+g.kind+"' cannot be computed",h&&h.error&&h.error(A))throw A;if("none"===g.styleAttrs[f.byName.display.qname])return null;if(null===u)var z=null===p?[]:[p];else"contents"in c&&(z=c.contents);for(var L in z)u=k(b,d,E,p,g,F,z[L],h,e),null!==u&&g.contents.push(u.element);for(var G in g.styleAttrs)b=!1,"span"===g.kind&&(d=g.styleAttrs[f.byName.ruby.qname],(b=("container"===d||"textContainer"===d||"baseContainer"===d)&&-1!==q.indexOf(G))||(b="container"!==d&&G===f.byName.rubyAlign.qname),
b||(b=!("textContainer"===d||"text"===d)&&G===f.byName.rubyPosition.qname)),b||(b=-1===f.byQName[G].applies.indexOf(g.kind)),b&&delete g.styleAttrs[G];G=g.styleAttrs[f.byName.ruby.qname];if("p"===g.kind||"span"===g.kind&&("textContainer"===G||"text"===G))G=[],a(g,G),n(G),l(g);return"div"===g.kind&&f.byName.backgroundImage.qname in g.styleAttrs||"br"===g.kind||"image"===g.kind||"contents"in g&&0<g.contents.length||"span"===g.kind&&null!==g.text||"region"===g.kind&&"always"===g.styleAttrs[f.byName.showBackground.qname]?
{region_id:F,element:g}:null}function n(a){function b(a){return"br"===a.kind||/[\r\n\t ]$/.test(a.text)}function l(a){return"br"===a.kind||"preserve"===a.space&&/^[\r\n]/.test(a.text)}for(var d,f=0;f<a.length;)if(d=a[f],"br"===d.kind||"preserve"===d.space)f++;else{var m=d.text.replace(/[\t\r\n ]+/g," ");/^[ ]/.test(m)&&(0===f||b(a[f-1]))&&(m=m.substring(1));d.text=m;0===m.length?a.splice(f,1):f++}for(f=0;f<a.length;f++)d=a[f],"br"===d.kind||"preserve"===d.space?f++:/[ ]$/.test(d.text)&&(f===a.length-
1||l(a[f+1]))&&(d.text=d.text.slice(0,-1))}function a(b,l){for(var d in b.contents){var m=b.contents[d],k=m.styleAttrs[f.byName.ruby.qname];if("span"!==m.kind||"textContainer"!==k&&"text"!==k)"contents"in m?a(m,l):("span"===m.kind&&0!==m.text.length||"br"===m.kind)&&l.push(m)}}function l(a){if("br"===a.kind)return!1;if("text"in a)return 0===a.text.length;if("contents"in a){for(var b=a.contents.length;b--;)l(a.contents[b])&&a.contents.splice(b,1);return 0===a.contents.length}}function E(a){this.contents=
[];this.aspectRatio=a.aspectRatio}function m(a){this.kind=a.kind||"region";a.id&&(this.id=a.id);this.styleAttrs={};for(var b in a.styleAttrs)this.styleAttrs[b]=a.styleAttrs[b];"src"in a&&(this.src=a.src);"type"in a&&(this.type=a.type);if("text"in a)this.text=a.text;else if("region"===this.kind||"contents"in a)this.contents=[];"space"in a&&(this.space=a.space)}b.generateISD=function(a,b,l){function d(a,c){function b(c){return!(a<c.begin||a>=c.end)}if(c.contents){var e={},l;for(l in c)e[l]=c[l];e.contents=
[];c.contents.filter(b).forEach(function(c){c=d(a,c);c.regionID&&h.add(c.regionID);null!==c&&e.contents.push(c)});return e}return c}var f=new E(a),m={},c={},h=new Set;c=d(b,a.body);0===h.size&&a.head.layout.regions.hasOwnProperty("")&&h.add("");h.forEach(function(e){e=k(a,b,a.head.layout.regions[e],c,null,"",a.head.layout.regions[e],l,m);null!==e&&f.contents.push(e.element)});return f};var q=[f.byName.color.qname,f.byName.textCombine.qname,f.byName.textDecoration.qname,f.byName.textEmphasis.qname,
f.byName.textOutline.qname,f.byName.textShadow.qname]})("undefined"===typeof f?this.imscISD={}:f,"undefined"===typeof imscNames?d("./names"):imscNames,"undefined"===typeof imscStyles?d("./styles"):imscStyles,"undefined"===typeof imscUtils?d("./utils"):imscUtils)},{"./names":5,"./styles":6,"./utils":7}],4:[function(d,p,f){f.generateISD=d("./isd").generateISD;f.fromXML=d("./doc").fromXML;f.renderHTML=d("./html").render},{"./doc":1,"./html":2,"./isd":3}],5:[function(d,p,f){d="undefined"===typeof f?this.imscNames=
{}:f;d.ns_tt="http://www.w3.org/ns/ttml";d.ns_tts="http://www.w3.org/ns/ttml#styling";d.ns_ttp="http://www.w3.org/ns/ttml#parameter";d.ns_xml="http://www.w3.org/XML/1998/namespace";d.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling";d.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter";d.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt";d.ns_ebutts="urn:ebu:tt:style";d.ttaf_map={"http://www.w3.org/2006/10/ttaf1":d.ns_tt,"http://www.w3.org/2006/10/ttaf1#style":d.ns_tts,
"http://www.w3.org/2006/10/ttaf1#parameter":d.ns_ttp}},{}],6:[function(d,p,f){(function(b,d,f){function k(a,b,d,f,k,n,p,r){this.name=b;this.ns=a;this.qname=a+" "+b;this.inherit=k;this.animatable=n;this.initial=d;this.applies=f;this.parse=p;this.compute=r}b.all=[new k(d.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,f.parseColor,null),new k(d.ns_tts,"color","white",["span"],!0,!0,f.parseColor,null),new k(d.ns_tts,"direction","ltr",["p","span"],!0,!0,function(a){return a},
null),new k(d.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,function(a){return a},null),new k(d.ns_tts,"displayAlign","before",["region"],!1,!0,function(a){return a},null),new k(d.ns_tts,"extent","auto",["tt","region"],!1,!0,function(a){if("auto"===a)return a;var b=a.split(" ");if(2!==b.length)return null;a=f.parseLength(b[0]);return(b=f.parseLength(b[1]))&&a?{h:b,w:a}:null},function(a,b,d,m,k){if("auto"===m)b=new f.ComputedLength(0,1);else if(b=f.toComputedLength(m.h.value,m.h.unit,
null,a.dimensions.h,null,a.pxLength.h),null===b)return null;if("auto"===m)a=new f.ComputedLength(1,0);else if(a=f.toComputedLength(m.w.value,m.w.unit,null,a.dimensions.w,null,a.pxLength.w),null===a)return null;return{h:b,w:a}}),new k(d.ns_tts,"fontFamily","default",["p","span"],!0,!0,function(a){a=a.split(",");var b=[],d;for(d in a)"'"!==a[d].charAt(0)&&'"'!==a[d].charAt(0)?"default"===a[d]?b.push("monospaceSerif"):b.push(a[d]):b.push(a[d]);return b},null),new k(d.ns_tts,"shear","0%",["p"],!0,!0,
f.parseLength,function(a,b,d,f){if("%"===f.unit)a=100<Math.abs(f.value)?100*Math.sign(f.value):f.value;else return null;return a}),new k(d.ns_tts,"fontSize","1c",["p","span"],!0,!0,f.parseLength,function(a,d,k,m,q){return f.toComputedLength(m.value,m.unit,null!==d?d.styleAttrs[b.byName.fontSize.qname]:a.cellLength.h,null!==d?d.styleAttrs[b.byName.fontSize.qname]:a.cellLength.h,a.cellLength.h,a.pxLength.h)}),new k(d.ns_tts,"fontStyle","normal",["span"],!0,!0,function(a){return a},null),new k(d.ns_tts,
"fontWeight","normal",["span"],!0,!0,function(a){return a},null),new k(d.ns_tts,"lineHeight","normal",["p"],!0,!0,function(a){return"normal"===a?a:f.parseLength(a)},function(a,d,k,m,q){if("normal"===m)a=m;else if(a=f.toComputedLength(m.value,m.unit,k.styleAttrs[b.byName.fontSize.qname],k.styleAttrs[b.byName.fontSize.qname],a.cellLength.h,a.pxLength.h),null===a)return null;return a}),new k(d.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new k(d.ns_tts,"origin","auto",["region"],!1,!0,function(a){if("auto"===
a)return a;var b=a.split(" ");if(2!==b.length)return null;a=f.parseLength(b[0]);return(b=f.parseLength(b[1]))&&a?{h:b,w:a}:null},function(a,b,d,m,k){if("auto"===m)b=new f.ComputedLength(0,0);else if(b=f.toComputedLength(m.h.value,m.h.unit,null,a.dimensions.h,null,a.pxLength.h),null===b)return null;if("auto"===m)a=new f.ComputedLength(0,0);else if(a=f.toComputedLength(m.w.value,m.w.unit,null,a.dimensions.w,null,a.pxLength.w),null===a)return null;return{h:b,w:a}}),new k(d.ns_tts,"overflow","hidden",
["region"],!1,!0,function(a){return a},null),new k(d.ns_tts,"padding","0px",["region"],!1,!0,function(a){a=a.split(" ");if(4<a.length)return null;var b=[],d;for(d in a){var m=f.parseLength(a[d]);if(!m)return null;b.push(m)}return b},function(a,d,k,m,q){if(1===m.length)d=[m[0],m[0],m[0],m[0]];else if(2===m.length)d=[m[0],m[1],m[0],m[1]];else if(3===m.length)d=[m[0],m[1],m[2],m[1]];else if(4===m.length)d=[m[0],m[1],m[2],m[3]];else return null;m=k.styleAttrs[b.byName.writingMode.qname];if("lrtb"===m||
"lr"===m)d=[d[0],d[3],d[2],d[1]];else if("rltb"===m||"rl"===m)d=[d[0],d[1],d[2],d[3]];else if("tblr"===m)d=[d[3],d[0],d[1],d[2]];else if("tbrl"===m||"tb"===m)d=[d[3],d[2],d[1],d[0]];else return null;m=[];for(var l in d)if(0===d[l].value)m[l]=new f.ComputedLength(0,0);else if(m[l]=f.toComputedLength(d[l].value,d[l].unit,k.styleAttrs[b.byName.fontSize.qname],"0"===l||"2"===l?k.styleAttrs[b.byName.extent.qname].h:k.styleAttrs[b.byName.extent.qname].w,"0"===l||"2"===l?a.cellLength.h:a.cellLength.w,"0"===
l||"2"===l?a.pxLength.h:a.pxLength.w),null===m[l])return null;return m}),new k(d.ns_tts,"position","top left",["region"],!1,!0,function(a){return f.parsePosition(a)},function(a,d,k,m){d=f.toComputedLength(m.v.offset.value,m.v.offset.unit,null,new f.ComputedLength(-k.styleAttrs[b.byName.extent.qname].h.rw,a.dimensions.h.rh-k.styleAttrs[b.byName.extent.qname].h.rh),null,a.pxLength.h);if(null===d)return null;"bottom"===m.v.edge&&(d=new f.ComputedLength(-d.rw-k.styleAttrs[b.byName.extent.qname].h.rw,
a.dimensions.h.rh-d.rh-k.styleAttrs[b.byName.extent.qname].h.rh));var l=f.toComputedLength(m.h.offset.value,m.h.offset.unit,null,new f.ComputedLength(a.dimensions.w.rw-k.styleAttrs[b.byName.extent.qname].w.rw,-k.styleAttrs[b.byName.extent.qname].w.rh),null,a.pxLength.w);if(null===d)return null;"right"===m.h.edge&&(l=new f.ComputedLength(a.dimensions.w.rw-l.rw-k.styleAttrs[b.byName.extent.qname].w.rw,-l.rh-k.styleAttrs[b.byName.extent.qname].w.rh));return{h:d,w:l}}),new k(d.ns_tts,"ruby","none",["span"],
!1,!0,function(a){return a},null),new k(d.ns_tts,"rubyAlign","center",["span"],!0,!0,function(a){return"center"!==a&&"spaceAround"!==a?null:a},null),new k(d.ns_tts,"rubyPosition","outside",["span"],!0,!0,function(a){return a},null),new k(d.ns_tts,"rubyReserve","none",["p"],!0,!0,function(a){var b=a.split(" ");a=[null,null];if(0===b.length||2<b.length||"none"!==b[0]&&"both"!==b[0]&&"after"!==b[0]&&"before"!==b[0]&&"outside"!==b[0])return null;a[0]=b[0];if(2===b.length&&"none"!==b[0])if(b=f.parseLength(b[1]))a[1]=
b;else return null;return a},function(a,d,k,m,q){if("none"===m[0])return m;a=null===m[1]?new f.ComputedLength(.5*k.styleAttrs[b.byName.fontSize.qname].rw,.5*k.styleAttrs[b.byName.fontSize.qname].rh):f.toComputedLength(m[1].value,m[1].unit,k.styleAttrs[b.byName.fontSize.qname],k.styleAttrs[b.byName.fontSize.qname],a.cellLength.h,a.pxLength.h);return null===a?null:[m[0],a]}),new k(d.ns_tts,"showBackground","whenActive",["region"],!1,!0,function(a){return a},null),new k(d.ns_tts,"textAlign","start",
["p"],!0,!0,function(a){return a},function(a,b,d,f,k){return"left"===f?"start":"right"===f?"end":f}),new k(d.ns_tts,"textCombine","none",["span"],!0,!0,function(a){a=a.split(" ");return 1!==a.length||"none"!==a[0]&&"all"!==a[0]?null:[a[0]]},null),new k(d.ns_tts,"textDecoration","none",["span"],!0,!0,function(a){return a.split(" ")},null),new k(d.ns_tts,"textEmphasis","none",["span"],!0,!0,function(a){a=a.split(" ");var b={style:null,symbol:null,color:null,position:null},d;for(d in a)if("none"===a[d]||
"auto"===a[d])b.style=a[d];else if("filled"===a[d]||"open"===a[d])b.style=a[d];else if("circle"===a[d]||"dot"===a[d]||"sesame"===a[d])b.symbol=a[d];else if("current"===a[d])b.color=a[d];else if("outside"===a[d]||"before"===a[d]||"after"===a[d])b.position=a[d];else if(b.color=f.parseColor(a[d]),null===b.color)return null;null==b.style&&null==b.symbol?b.style="auto":(b.symbol=b.symbol||"circle",b.style=b.style||"filled");b.position=b.position||"outside";b.color=b.color||"current";return b},null),new k(d.ns_tts,
"textOutline","none",["span"],!0,!0,function(a){if("none"===a)return a;var b={};a=a.split(" ");if(0===a.length||2<a.length)return null;var d=f.parseColor(a[0]);b.color=d;null!==d&&a.shift();if(1!==a.length)return null;a=f.parseLength(a[0]);if(!a)return null;b.thickness=a;return b},function(a,d,k,m,q){if("none"===m)return m;d={};d.color=null===m.color?k.styleAttrs[b.byName.color.qname]:m.color;d.thickness=f.toComputedLength(m.thickness.value,m.thickness.unit,k.styleAttrs[b.byName.fontSize.qname],k.styleAttrs[b.byName.fontSize.qname],
a.cellLength.h,a.pxLength.h);return null===d.thickness?null:d}),new k(d.ns_tts,"textShadow","none",["span"],!0,!0,f.parseTextShadow,function(a,d,k,m){if("none"===m)return m;d=[];for(var l in m){var n={};n.x_off=f.toComputedLength(m[l][0].value,m[l][0].unit,null,k.styleAttrs[b.byName.fontSize.qname],null,a.pxLength.w);if(null===n.x_off)return null;n.y_off=f.toComputedLength(m[l][1].value,m[l][1].unit,null,k.styleAttrs[b.byName.fontSize.qname],null,a.pxLength.h);if(null===n.y_off)return null;if(null===
m[l][2])n.b_radius=0;else if(n.b_radius=f.toComputedLength(m[l][2].value,m[l][2].unit,null,k.styleAttrs[b.byName.fontSize.qname],null,a.pxLength.h),null===n.b_radius)return null;n.color=null===m[l][3]?k.styleAttrs[b.byName.color.qname]:m[l][3];d.push(n)}return d}),new k(d.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,function(a){return a},null),new k(d.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,function(a){return a},null),new k(d.ns_tts,"wrapOption","wrap",["span"],
!0,!0,function(a){return a},null),new k(d.ns_tts,"writingMode","lrtb",["region"],!1,!0,function(a){return a},null),new k(d.ns_tts,"zIndex","auto",["region"],!1,!0,function(a){"auto"!==a&&(a=parseInt(a),isNaN(a)&&(a=null));return a},null),new k(d.ns_ebutts,"linePadding","0c",["p"],!0,!1,f.parseLength,function(a,b,d,k,n){return f.toComputedLength(k.value,k.unit,null,null,a.cellLength.w,null)}),new k(d.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,function(a){return a},null),new k(d.ns_smpte,"backgroundImage",
null,["div"],!1,!1,function(a){return a},null),new k(d.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,function(a){return"true"===a?!0:!1},null),new k(d.ns_itts,"fillLineGap","true",["p"],!0,!0,function(a){return"true"===a?!0:!1},null)];b.byQName={};for(var n in b.all)b.byQName[b.all[n].qname]=b.all[n];b.byName={};for(var p in b.all)b.byName[b.all[p].name]=b.all[p]})("undefined"===typeof f?this.imscStyles={}:f,"undefined"===typeof imscNames?d("./names"):imscNames,"undefined"===
typeof imscUtils?d("./utils"):imscUtils)},{"./names":5,"./utils":7}],7:[function(d,p,f){(function(b){var d=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,f=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,p=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,L={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],
green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};b.parseColor=function(a){var b,k=null,m=L[a.toLowerCase()];void 0!==m?k=m:null!==(b=d.exec(a))?k=[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16),void 0!==b[4]?parseInt(b[4],16):255]:null!==(b=f.exec(a))?k=[parseInt(b[1]),parseInt(b[2]),parseInt(b[3]),255]:null!==(b=p.exec(a))&&(k=[parseInt(b[1]),parseInt(b[2]),
parseInt(b[3]),parseInt(b[4])]);return k};var I=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%|rh|rw)$/;b.parseLength=function(a){var b,d=null;null!==(b=I.exec(a))&&(d={value:parseFloat(b[1]),unit:b[2]});return d};b.parseTextShadow=function(a){a=a.split(",");var d=[],f;for(f in a){var k=a[f].split(" ");if(1===k.length&&"none"===k[0])return"none";if(1<k.length&&5>k.length){var n=[null,null,null,null],p=b.parseLength(k.shift());if(null===p)return null;n[0]=p;p=b.parseLength(k.shift());if(null===p)return null;
n[1]=p;if(0!==k.length&&(p=b.parseLength(k[0]),null!==p&&(n[2]=p,k.shift()),0!==k.length)){k=b.parseColor(k[0]);if(null===k)return null;n[3]=k}d.push(n)}}return d};b.parsePosition=function(a){a=a.split(" ");var d=function(a){return"center"===a||"left"===a||"top"===a||"bottom"===a||"right"===a};if(4<a.length)return null;for(var f in a)if(!d(a[f])){var k=b.parseLength(a[f]);if(null===k)return null;a[f]=k}f={h:{edge:"left",offset:{value:50,unit:"%"}},v:{edge:"top",offset:{value:50,unit:"%"}}};for(k=
0;k<a.length;){var n=a[k++];if(d(n)){var p={value:0,unit:"%"};2!==a.length&&k<a.length&&!d(a[k])&&(p=a[k++]);"right"===n?(f.h.edge=n,f.h.offset=p):"bottom"===n?(f.v.edge=n,f.v.offset=p):"left"===n?f.h.offset=p:"top"===n&&(f.v.offset=p)}else if(1===a.length||2===a.length)1===k?f.h.offset=n:f.v.offset=n;else return null}return f};b.ComputedLength=function(a,b){this.rw=a;this.rh=b};b.ComputedLength.prototype.toUsedLength=function(a,b){return a*this.rw+b*this.rh};b.ComputedLength.prototype.multiply=function(a,
b){return b?a*b:a};b.ComputedLength.prototype.isZero=function(){return 0===this.rw&&0===this.rh};b.toComputedLength=function(a,d,f,k,n,p){return"%"===d&&k?new b.ComputedLength(k.rw*a/100,k.rh*a/100):"em"===d&&f?new b.ComputedLength(f.rw*a,f.rh*a):"c"===d&&n?new b.ComputedLength(a*n.rw,a*n.rh):"px"===d&&p?new b.ComputedLength(a*p.rw,a*p.rh):"rh"===d?new b.ComputedLength(0,a/100):"rw"===d?new b.ComputedLength(a/100,0):null}})("undefined"===typeof f?this.imscUtils={}:f)},{}]},{},[4])(4)});
