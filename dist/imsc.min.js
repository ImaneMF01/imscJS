var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.owns=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)};$jscomp.assign="function"==typeof Object.assign?Object.assign:function(e,r){for(var k=1;k<arguments.length;k++){var d=arguments[k];if(d)for(var q in d)$jscomp.owns(d,q)&&(e[q]=d[q])}return e};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,r,k){e!=Array.prototype&&e!=Object.prototype&&(e[r]=k.value)};$jscomp.getGlobal=function(e){return"undefined"!=typeof window&&window===e?e:"undefined"!=typeof global&&null!=global?global:e};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(e,r,k,d){if(r){k=$jscomp.global;e=e.split(".");for(d=0;d<e.length-1;d++){var q=e[d];q in k||(k[q]={});k=k[q]}e=e[e.length-1];d=k[e];r=r(d);r!=d&&null!=r&&$jscomp.defineProperty(k,e,{configurable:!0,writable:!0,value:r})}};$jscomp.polyfill("Object.assign",function(e){return e||$jscomp.assign},"es6","es3");$jscomp.polyfill("Object.entries",function(e){return e?e:function(e){var k=[],d;for(d in e)$jscomp.owns(e,d)&&k.push([d,e[d]]);return k}},"es8","es3");
$jscomp.polyfill("Math.sign",function(e){return e?e:function(e){e=Number(e);return 0===e||isNaN(e)?e:0<e?1:-1}},"es6","es3");$jscomp.checkEs6ConformanceViaProxy=function(){try{var e={},r=Object.create(new $jscomp.global.Proxy(e,{get:function(k,d,q){return k==e&&"q"==d&&q==r}}));return!0===r.q}catch(k){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var e=0;return function(r){return $jscomp.SYMBOL_PREFIX+(r||"")+e++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var e=$jscomp.global.Symbol.iterator;e||(e=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[e]&&$jscomp.defineProperty(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var e=$jscomp.global.Symbol.asyncIterator;e||(e=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.arrayIterator=function(e){var r=0;return $jscomp.iteratorPrototype(function(){return r<e.length?{done:!1,value:e[r++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(e){$jscomp.initSymbolIterator();e={next:e};e[$jscomp.global.Symbol.iterator]=function(){return this};return e};$jscomp.makeIterator=function(e){$jscomp.initSymbolIterator();var r=e[Symbol.iterator];return r?r.call(e):$jscomp.arrayIterator(e)};
$jscomp.polyfill("WeakMap",function(e){function r(){if(!e||!Object.seal)return!1;try{var d=Object.seal({}),m=Object.seal({}),b=new e([[d,2],[m,3]]);if(2!=b.get(d)||3!=b.get(m))return!1;b.delete(d);b.set(m,4);return!b.has(d)&&4==b.get(m)}catch(n){return!1}}function k(d){$jscomp.owns(d,q)||$jscomp.defineProperty(d,q,{value:{}})}function d(d){var m=Object[d];m&&(Object[d]=function(b){k(b);return m(b)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(e&&$jscomp.ES6_CONFORMANCE)return e}else if(r())return e;
var q="$jscomp_hidden_"+Math.random();d("freeze");d("preventExtensions");d("seal");var m=0,u=function(d){this.id_=(m+=Math.random()+1).toString();if(d){$jscomp.initSymbol();$jscomp.initSymbolIterator();d=$jscomp.makeIterator(d);for(var e;!(e=d.next()).done;)e=e.value,this.set(e[0],e[1])}};u.prototype.set=function(d,m){k(d);if(!$jscomp.owns(d,q))throw Error("WeakMap key fail: "+d);d[q][this.id_]=m;return this};u.prototype.get=function(d){return $jscomp.owns(d,q)?d[q][this.id_]:void 0};u.prototype.has=
function(d){return $jscomp.owns(d,q)&&$jscomp.owns(d[q],this.id_)};u.prototype.delete=function(d){return $jscomp.owns(d,q)&&$jscomp.owns(d[q],this.id_)?delete d[q][this.id_]:!1};return u},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(e){function r(){if($jscomp.ASSUME_NO_NATIVE_MAP||!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var d=Object.seal({x:4}),b=new e($jscomp.makeIterator([[d,"s"]]));if("s"!=b.get(d)||1!=b.size||b.get({x:4})||b.set({x:4},"t")!=b||2!=b.size)return!1;var n=b.entries(),m=n.next();if(m.done||m.value[0]!=d||"s"!=m.value[1])return!1;m=n.next();return m.done||4!=m.value[0].x||"t"!=m.value[1]||!n.next().done?!1:!0}catch(p){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(e&&$jscomp.ES6_CONFORMANCE)return e}else if(r())return e;$jscomp.initSymbol();$jscomp.initSymbolIterator();var k=new WeakMap,d=function(d){this.data_={};this.head_=u();this.size=0;if(d){d=$jscomp.makeIterator(d);for(var b;!(b=d.next()).done;)b=b.value,this.set(b[0],b[1])}};d.prototype.set=function(d,b){d=0===d?0:d;var n=q(this,d);n.list||(n.list=this.data_[n.id]=[]);n.entry?n.entry.value=b:(n.entry={next:this.head_,previous:this.head_.previous,head:this.head_,
key:d,value:b},n.list.push(n.entry),this.head_.previous.next=n.entry,this.head_.previous=n.entry,this.size++);return this};d.prototype.delete=function(d){d=q(this,d);return d.entry&&d.list?(d.list.splice(d.index,1),d.list.length||delete this.data_[d.id],d.entry.previous.next=d.entry.next,d.entry.next.previous=d.entry.previous,d.entry.head=null,this.size--,!0):!1};d.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=u();this.size=0};d.prototype.has=function(d){return!!q(this,d).entry};
d.prototype.get=function(d){return(d=q(this,d).entry)&&d.value};d.prototype.entries=function(){return m(this,function(d){return[d.key,d.value]})};d.prototype.keys=function(){return m(this,function(d){return d.key})};d.prototype.values=function(){return m(this,function(d){return d.value})};d.prototype.forEach=function(d,b){for(var n=this.entries(),m;!(m=n.next()).done;)m=m.value,d.call(b,m[1],m[0],this)};d.prototype[Symbol.iterator]=d.prototype.entries;var q=function(d,b){var n=b&&typeof b;"object"==
n||"function"==n?k.has(b)?n=k.get(b):(n=""+ ++N,k.set(b,n)):n="p_"+b;var m=d.data_[n];if(m&&$jscomp.owns(d.data_,n))for(d=0;d<m.length;d++){var p=m[d];if(b!==b&&p.key!==p.key||b===p.key)return{id:n,list:m,index:d,entry:p}}return{id:n,list:m,index:-1,entry:void 0}},m=function(d,b){var n=d.head_;return $jscomp.iteratorPrototype(function(){if(n){for(;n.head!=d.head_;)n=n.previous;for(;n.next!=n.head;)return n=n.next,{done:!1,value:b(n)};n=null}return{done:!0,value:void 0}})},u=function(){var d={};return d.previous=
d.next=d.head=d},N=0;return d},"es6","es3");
$jscomp.polyfill("Set",function(e){function r(){if($jscomp.ASSUME_NO_NATIVE_SET||!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var d=Object.seal({x:4}),q=new e($jscomp.makeIterator([d]));if(!q.has(d)||1!=q.size||q.add(d)!=q||1!=q.size||q.add({x:4})!=q||2!=q.size)return!1;var m=q.entries(),u=m.next();if(u.done||u.value[0]!=d||u.value[1]!=d)return!1;u=m.next();return u.done||u.value[0]==d||4!=u.value[0].x||u.value[1]!=u.value[0]?!1:m.next().done}catch(N){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(e&&$jscomp.ES6_CONFORMANCE)return e}else if(r())return e;$jscomp.initSymbol();$jscomp.initSymbolIterator();var k=function(d){this.map_=new Map;if(d){d=$jscomp.makeIterator(d);for(var e;!(e=d.next()).done;)this.add(e.value)}this.size=this.map_.size};k.prototype.add=function(d){d=0===d?0:d;this.map_.set(d,d);this.size=this.map_.size;return this};k.prototype.delete=function(d){d=this.map_.delete(d);this.size=this.map_.size;return d};k.prototype.clear=
function(){this.map_.clear();this.size=0};k.prototype.has=function(d){return this.map_.has(d)};k.prototype.entries=function(){return this.map_.entries()};k.prototype.values=function(){return this.map_.values()};k.prototype.keys=k.prototype.values;k.prototype[Symbol.iterator]=k.prototype.values;k.prototype.forEach=function(d,e){var m=this;this.map_.forEach(function(q){return d.call(e,q,q,m)})};return k},"es6","es3");
(function(e){"object"===typeof exports&&"undefined"!==typeof module?module.exports=e():"function"===typeof define&&define.amd?define([],e):("undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:this).imsc=e()})(function(){return function(){function e(r,k,d){function q(u,K){if(!k[u]){if(!r[u]){var b="function"==typeof require&&require;if(!K&&b)return b(u,!0);if(m)return m(u,!0);K=Error("Cannot find module '"+u+"'");throw K.code="MODULE_NOT_FOUND",K;}K=
k[u]={exports:{}};r[u][0].call(K.exports,function(b){return q(r[u][1][b]||b)},K,K.exports,e,r,k,d)}return k[u].exports}for(var m="function"==typeof require&&require,u=0;u<d.length;u++)q(d[u]);return q}return e}()({1:[function(e,r,k){(function(d,e,m,u,k){function q(h,b){var f=h.styleAttrs&&h.styleAttrs["http://www.w3.org/ns/ttml#styling backgroundColor"];if("span"===h.kind)!f&&b&&(h.styleAttrs||(h.styleAttrs={}),h.styleAttrs["http://www.w3.org/ns/ttml#styling backgroundColor"]=b);else if(f&&delete h.styleAttrs["http://www.w3.org/ns/ttml#styling backgroundColor"],
h.contents)for(var g=0;g<h.contents.length;g++)q(h.contents[g],f||b)}function b(h){if("contents"in h){var f="styleAttrs"in h?h.styleAttrs[u.byName.ruby.qname]:null;f="span"===h.kind&&("container"===f||"textContainer"===f||"baseContainer"===f);for(var g=h.contents.length-1;0<=g;g--)!f||"styleAttrs"in h.contents[g]&&u.byName.ruby.qname in h.contents[g].styleAttrs?b(h.contents[g]):delete h.contents[g]}}function n(h,b,f,g){var d=g&&"seq"===g.timeContainer,l=0;g&&(l=d&&f?f.end:g.begin);b.begin=b.explicit_begin?
b.explicit_begin+l:l;f=b.begin;g=null;for(var z in b.sets)n(h,b.sets[z],g,b),f="seq"===b.timeContainer?b.sets[z].end:Math.max(f,b.sets[z].end),g=b.sets[z];if("contents"in b)for(var m in b.contents)n(h,b.contents[m],g,b),f="seq"===b.timeContainer?b.contents[m].end:Math.max(f,b.contents[m].end),g=b.contents[m];else f=d?b.begin:Number.POSITIVE_INFINITY;b.end=null!==b.explicit_end&&null!==b.explicit_dur?Math.min(b.begin+b.explicit_dur,l+b.explicit_end):null===b.explicit_end&&null!==b.explicit_dur?b.begin+
b.explicit_dur:null!==b.explicit_end&&null===b.explicit_dur?l+b.explicit_end:f;delete b.explicit_begin;delete b.explicit_dur;delete b.explicit_end;h._registerEvent(b)}function G(b){this.node=b}function p(){this.events=[];this.head=new t;this.body=null}function t(){this.styling=new E;this.layout=new D}function E(){this.styles={};this.initials={}}function x(){this.styleRefs=this.styleAttrs=this.id=null}function r(){this.styleAttrs=null}function D(){this.regions={}}function v(b,h){this.kind="image";
this.src=b;this.type=h}function H(b){this.id=b}function h(b){this.regionID=b}function l(b){this.styleAttrs=b}function f(b){this.sets=b}function g(b){this.contents=b}function B(b,h,f){this.explicit_begin=b;this.explicit_end=h;this.explicit_dur=f}function w(){this.kind="body"}function R(){this.kind="div"}function y(){this.kind="p"}function O(){this.kind="span"}function T(){this.kind="span"}function C(){this.kind="br"}function P(){}function A(){}function N(b){var h=null;b&&(b=b.attributes["xml:id"]||
b.attributes.id)&&(h=b.value||null);return h}function I(b){return b&&"style"in b.attributes?b.attributes.style.value.split(" "):[]}function U(b,h){var f={};if(null!==b)for(var g in b.attributes){var d=b.attributes[g].uri+" "+b.attributes[g].local,n=u.byQName[d];if(void 0!==n){var l=n.parse(b.attributes[g].value);null!==l?(f[d]=l,n===u.byName.zIndex&&M(h,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):L(h,"Cannot parse styling attribute "+d+" --\x3e "+b.attributes[g].value)}}return f}
function Q(b,h,f){for(var g in b.attributes)if(b.attributes[g].uri===h&&b.attributes[g].local===f)return b.attributes[g].value;return null}function ba(b,h){b=Q(b,m.ns_tts,"extent");if(null===b)return null;var f=b.split(" ");if(2!==f.length)return M(h,"Malformed extent (ignoring)"),null;b=k.parseLength(f[0]);f=k.parseLength(f[1]);return f&&b?{h:f,w:b}:(M(h,"Malformed extent values (ignoring)"),null)}function W(b,h,f){var g=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/,d=/^(\d{2,}):(\d\d):(\d\d):(\d{2,})$/,
n=/^(\d+(?:\.\d+)?)t$/,l=/^(\d+(?:\.\d+)?)ms$/,m=/^(\d+(?:\.\d+)?)s$/,B=/^(\d+(?:\.\d+)?)h$/,p=/^(\d+(?:\.\d+)?)m$/,e,z=null;null!==(e=/^(\d+(?:\.\d+)?)f$/.exec(f))?null!==h&&(z=parseFloat(e[1])/h):null!==(e=n.exec(f))?null!==b&&(z=parseFloat(e[1])/b):null!==(e=l.exec(f))?z=parseFloat(e[1])/1E3:null!==(e=m.exec(f))?z=parseFloat(e[1]):null!==(e=B.exec(f))?z=3600*parseFloat(e[1]):null!==(e=p.exec(f))?z=60*parseFloat(e[1]):null!==(e=g.exec(f))?z=3600*parseInt(e[1])+60*parseInt(e[2])+parseFloat(e[3]):
null!==(e=d.exec(f))&&null!==h&&(z=3600*parseInt(e[1])+60*parseInt(e[2])+parseInt(e[3])+(null===e[4]?0:parseInt(e[4])/h));return z}function Y(b,h,f){for(;0<h.styleRefs.length;){var g=h.styleRefs.pop();g in b.styles?(Y(b,b.styles[g],f),X(b.styles[g].styleAttrs,h.styleAttrs)):L(f,"Non-existant style id referenced")}}function Z(b,h,f,g){for(var d=h.length-1;0<=d;d--){var n=h[d];n in b.styles?X(b.styles[n].styleAttrs,f):L(g,"Non-existant style id referenced")}}function X(b,h){for(var f in b)f in h||(h[f]=
b[f])}function M(b,h){if(b&&b.warn&&b.warn(h))throw h;}function L(b,h){if(b&&b.error&&b.error(h))throw h;}function F(b,h){b&&b.fatal&&b.fatal(h);throw h;}function aa(b,h){for(var f=0,g=b.length-1,d;f<=g;){d=Math.floor((f+g)/2);var n=b[d];if(n<h)f=d+1;else if(n>h)g=d-1;else return{found:!0,index:d}}return{found:!1,index:f}}d.fromXML=function(h,f,g){var d=e.parser(!0,{xmlns:!0}),l=[],B=[],z=[],S=0,k=null;d.onclosetag=function(b){if(l[0]instanceof P)null!==k.head&&null!==k.head.styling&&Z(k.head.styling,
l[0].styleRefs,l[0].styleAttrs,f),delete l[0].styleRefs;else if(l[0]instanceof E)for(var h in l[0].styles)Y(l[0],l[0].styles[h],f);else if(l[0]instanceof y||l[0]instanceof O){if(1<l[0].contents.length){b=[l[0].contents[0]];for(h=1;h<l[0].contents.length;h++)l[0].contents[h]instanceof T&&b[b.length-1]instanceof T?b[b.length-1].text+=l[0].contents[h].text:b.push(l[0].contents[h]);l[0].contents=b}l[0]instanceof O&&1===l[0].contents.length&&l[0].contents[0]instanceof T&&(l[0].text=l[0].contents[0].text,
delete l[0].contents)}else if(l[0]instanceof G)if(l[0].node.uri===m.ns_tt&&"metadata"===l[0].node.local)S--;else if(0<S&&g&&"onCloseTag"in g)g.onCloseTag();z.shift();B.shift();l.shift()};d.ontext=function(b){if(void 0!==l[0])if(l[0]instanceof O||l[0]instanceof y){if(l[0]instanceof O){var h=l[0].styleAttrs[u.byName.ruby.qname];if("container"===h||"textContainer"===h||"baseContainer"===h)return}h=new T;h.initFromText(k,l[0],b,z[0],f);l[0].contents.push(h)}else if(l[0]instanceof G&&0<S&&g&&"onText"in
g)g.onText(b)};d.onopentag=function(b){function h(b){m.ttaf_map[b.uri]&&(b.uri=m.ttaf_map[b.uri])}var d=b.attributes["xml:space"];d?z.unshift(d.value):0===z.length?z.unshift("default"):z.unshift(z[0]);(d=b.attributes["xml:lang"])?B.unshift(d.value):0===B.length?B.unshift(""):B.unshift(B[0]);h(b);if(b.attributes)for(var n in b.attributes)b.attributes.hasOwnProperty(n)&&h(b.attributes[n]);if(b.uri===m.ns_tt)if("tt"===b.local)null!==k&&F(f,"Two <tt> elements at ("+this.line+","+this.column+")"),k=new p,
k.initFromNode(b,f),l.unshift(k);else if("head"===b.local)l[0]instanceof p||F(f,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),l.unshift(k.head);else if("styling"===b.local)l[0]instanceof t||F(f,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),l.unshift(k.head.styling);else if("style"===b.local)if(l[0]instanceof E){var e=new x;e.initFromNode(b,f);e.id?k.head.styling.styles[e.id]=e:L(f,"<style> element missing @id attribute");l.unshift(e)}else l[0]instanceof
P?(e=new x,e.initFromNode(b,f),X(e.styleAttrs,l[0].styleAttrs),l.unshift(e)):F(f,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")");else if("initial"===b.local)if(l[0]instanceof E){n=new r;n.initFromNode(b,f);for(e in n.styleAttrs)k.head.styling.initials[e]=n.styleAttrs[e];l.unshift(n)}else F(f,"Parent of <initial> element is not <styling> at ("+this.line+","+this.column+")");else if("layout"===b.local)l[0]instanceof t||F(f,"Parent of <layout> element is not <head> at "+
this.line+","+this.column+")"),l.unshift(k.head.layout);else if("region"===b.local)l[0]instanceof D||F(f,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")"),e=new P,e.initFromNode(k,b,f),!e.id||e.id in k.head.layout.regions?L(f,"Ignoring <region> with duplicate or missing @id at "+this.line+","+this.column+")"):k.head.layout.regions[e.id]=e,l.unshift(e);else if("body"===b.local)l[0]instanceof p||F(f,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),
null!==k.body&&F(f,"Second <body> element at "+this.line+","+this.column+")"),e=new w,e.initFromNode(k,b,f),k.body=e,l.unshift(e);else if("div"===b.local){l[0]instanceof R||l[0]instanceof w||F(f,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")");e=new R;e.initFromNode(k,l[0],b,f);if(n=e.styleAttrs[u.byName.backgroundImage.qname])e.contents.push(new v(n)),delete e.styleAttrs[u.byName.backgroundImage.qname];l[0].contents.push(e);l.unshift(e)}else"image"===b.local?(l[0]instanceof
R||F(f,"Parent of <image> element is not <div> at "+this.line+","+this.column+")"),e=new v,e.initFromNode(k,l[0],b,f),l[0].contents.push(e),l.unshift(e)):"p"===b.local?(l[0]instanceof R||F(f,"Parent of <p> element is not <div> at "+this.line+","+this.column+")"),e=new y,e.initFromNode(k,l[0],b,f),l[0].contents.push(e),l.unshift(e)):"span"===b.local?(l[0]instanceof O||l[0]instanceof y||F(f,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")"),e=new O,e.initFromNode(k,l[0],
b,z[0],f),l[0].contents.push(e),l.unshift(e)):"br"===b.local?(l[0]instanceof O||l[0]instanceof y||F(f,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")"),e=new C,e.initFromNode(k,l[0],b,f),l[0].contents.push(e),l.unshift(e)):"set"===b.local?(l[0]instanceof O||l[0]instanceof y||l[0]instanceof R||l[0]instanceof w||l[0]instanceof P||l[0]instanceof C||F(f,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")"),e=new A,e.initFromNode(k,
l[0],b,f),l[0].sets.push(e),l.unshift(e)):l.unshift(new G(b));else l.unshift(new G(b));if(l[0]instanceof G)if(b.uri===m.ns_tt&&"metadata"===b.local)S++;else if(0<S&&g&&"onOpenTag"in g){e=[];for(var q in b.attributes)e[b.attributes[q].uri+" "+b.attributes[q].local]={uri:b.attributes[q].uri,local:b.attributes[q].local,value:b.attributes[q].value};g.onOpenTag(b.uri,b.local,e)}};d.write(h).close();delete k.head.styling.styles;h=!1;for(var V in k.head.layout.regions){h=!0;break}h||(V=P.prototype.createDefaultRegion(k,
f),k.head.layout.regions[V.id]=V);for(var H in k.head.layout.regions)n(k,k.head.layout.regions[H],null,null);k.body&&n(k,k.body,null,null);k.body&&b(k.body);k.body&&q(k.body);return k};p.prototype.initFromNode=function(b,h){var f=Q(b,m.ns_ttp,"cellResolution"),l=15;var g=32;null!==f&&(f=/(\d+) (\d+)/.exec(f),null!==f?(g=parseInt(f[1]),l=parseInt(f[2])):M(h,"Malformed cellResolution value (using initial value instead)"));this.cellLength={h:new k.ComputedLength(0,1/l),w:new k.ComputedLength(1/g,0)};
l=Q(b,m.ns_ttp,"frameRate");f=30;null!==l&&(g=/(\d+)/.exec(l),null!==g?f=parseInt(g[1]):M(h,"Malformed frame rate attribute (using initial value instead)"));g=Q(b,m.ns_ttp,"frameRateMultiplier");var d=1;null!==g&&(g=/(\d+) (\d+)/.exec(g),null!==g?d=parseInt(g[1])/parseInt(g[2]):M(h,"Malformed frame rate multiplier attribute (using initial value instead)"));f*=d;d=1;g=Q(b,m.ns_ttp,"tickRate");null===g?null!==l&&(d=f):(g=/(\d+)/.exec(g),null!==g?d=parseInt(g[1]):M(h,"Malformed tick rate attribute (using initial value instead)"));
this.effectiveFrameRate=f;this.tickRate=d;g=Q(b,m.ns_ittp,"aspectRatio");null===g&&(g=Q(b,m.ns_ttp,"displayAspectRatio"));l=null;null!==g&&(f=/(\d+)\s+(\d+)/.exec(g),null!==f?(g=parseInt(f[1]),f=parseInt(f[2]),0!==g&&0!==f?l=g/f:L(h,"Illegal aspectRatio values (ignoring)")):L(h,"Malformed aspectRatio attribute (ignoring)"));this.aspectRatio=l;l=Q(b,m.ns_ttp,"timeBase");null!==l&&"media"!==l&&F(h,"Unsupported time base");b=ba(b,h);null===b?this.pxLength={h:null,w:null}:("px"===b.h.unit&&"px"===b.w.unit||
F(h,"Extent on TT must be in px or absent"),this.pxLength={h:new k.ComputedLength(0,1/b.h.value),w:new k.ComputedLength(1/b.w.value,0)});this.dimensions={h:new k.ComputedLength(0,1),w:new k.ComputedLength(1,0)}};p.prototype._registerEvent=function(b){if(!(b.end<=b.begin)){var h=aa(this.events,b.begin);h.found||this.events.splice(h.index,0,b.begin);b.end!==Number.POSITIVE_INFINITY&&(h=aa(this.events,b.end),h.found||this.events.splice(h.index,0,b.end))}};p.prototype.getMediaTimeRange=function(){return[this.events[0],
this.events[this.events.length-1]]};p.prototype.getMediaTimeEvents=function(){return this.events};x.prototype.initFromNode=function(b,h){this.id=N(b);this.styleAttrs=U(b,h);this.styleRefs=I(b)};r.prototype.initFromNode=function(b,h){this.styleAttrs={};for(var f in b.attributes)if(b.attributes[f].uri===m.ns_itts||b.attributes[f].uri===m.ns_ebutts||b.attributes[f].uri===m.ns_tts)this.styleAttrs[b.attributes[f].uri+" "+b.attributes[f].local]=b.attributes[f].value};v.prototype.initFromNode=function(b,
g,d,n){(this.src="src"in d.attributes?d.attributes.src.value:null)||L(n,"Invalid image@src attribute");(this.type="type"in d.attributes?d.attributes.type.value:null)||L(n,"Invalid image@type attribute");l.prototype.initFromNode.call(this,b,g,d,n);B.prototype.initFromNode.call(this,b,g,d,n);f.prototype.initFromNode.call(this,b,g,d,n);h.prototype.initFromNode.call(this,b,g,d,n)};H.prototype.initFromNode=function(b,h,f,g){this.id=N(f)};h.prototype.initFromNode=function(b,h,f,g){this.regionID=f&&"region"in
f.attributes?f.attributes.region.value:""};l.prototype.initFromNode=function(b,h,f,g){this.styleAttrs=U(f,g);null!==b.head&&null!==b.head.styling&&Z(b.head.styling,I(f),this.styleAttrs,g)};f.prototype.initFromNode=function(b,h,f,g){this.sets=[]};g.prototype.initFromNode=function(b,h,f,g){this.contents=[]};B.prototype.initFromNode=function(b,h,f,g){h=null;f&&"begin"in f.attributes&&(h=W(b.tickRate,b.effectiveFrameRate,f.attributes.begin.value),null===h&&M(g,"Malformed begin value "+f.attributes.begin.value+
" (using 0)"));var l=null;f&&"dur"in f.attributes&&(l=W(b.tickRate,b.effectiveFrameRate,f.attributes.dur.value),null===l&&M(g,"Malformed dur value "+f.attributes.dur.value+" (ignoring)"));var d=null;f&&"end"in f.attributes&&(d=W(b.tickRate,b.effectiveFrameRate,f.attributes.end.value),null===d&&M(g,"Malformed end value (ignoring)"));this.explicit_begin=h;this.explicit_end=d;this.explicit_dur=l;(b=f&&"timeContainer"in f.attributes?f.attributes.timeContainer.value:null)&&"par"!==b?"seq"===b?g="seq":
(L(g,"Illegal value of timeContainer (assuming 'par')"),g="par"):g="par";this.timeContainer=g};w.prototype.initFromNode=function(b,d,n){l.prototype.initFromNode.call(this,b,null,d,n);B.prototype.initFromNode.call(this,b,null,d,n);f.prototype.initFromNode.call(this,b,null,d,n);h.prototype.initFromNode.call(this,b,null,d,n);g.prototype.initFromNode.call(this,b,null,d,n)};R.prototype.initFromNode=function(b,d,n,e){l.prototype.initFromNode.call(this,b,d,n,e);B.prototype.initFromNode.call(this,b,d,n,e);
f.prototype.initFromNode.call(this,b,d,n,e);h.prototype.initFromNode.call(this,b,d,n,e);g.prototype.initFromNode.call(this,b,d,n,e)};y.prototype.initFromNode=function(b,d,n,e){l.prototype.initFromNode.call(this,b,d,n,e);B.prototype.initFromNode.call(this,b,d,n,e);f.prototype.initFromNode.call(this,b,d,n,e);h.prototype.initFromNode.call(this,b,d,n,e);g.prototype.initFromNode.call(this,b,d,n,e)};O.prototype.initFromNode=function(b,d,n,e,m){l.prototype.initFromNode.call(this,b,d,n,m);B.prototype.initFromNode.call(this,
b,d,n,m);f.prototype.initFromNode.call(this,b,d,n,m);h.prototype.initFromNode.call(this,b,d,n,m);g.prototype.initFromNode.call(this,b,d,n,m);this.space=e};T.prototype.initFromText=function(b,h,f,g,l){B.prototype.initFromNode.call(this,b,h,null,l);this.text=f;this.space=g};C.prototype.initFromNode=function(b,f,g,l){h.prototype.initFromNode.call(this,b,f,g,l);B.prototype.initFromNode.call(this,b,f,g,l)};P.prototype.createDefaultRegion=function(b,h){var f=new P;f.id="";l.prototype.initFromNode.call(f,
b,null,{name:"region",attributes:{"tts:displayAlign":{name:"tts:displayAlign",value:"after",prefix:"tts",local:"displayAlign",uri:"http://www.w3.org/ns/ttml#styling"},"tts:extent":{name:"tts:extent",value:"80% 20%",prefix:"tts",local:"extent",uri:"http://www.w3.org/ns/ttml#styling"},"tts:origin":{name:"tts:origin",value:"10% 70%",prefix:"tts",local:"origin",uri:"http://www.w3.org/ns/ttml#styling"},"tts:overflow":{name:"tts:overflow",value:"visible",prefix:"tts",local:"overflow",uri:"http://www.w3.org/ns/ttml#styling"}},
ns:{"":"http://www.w3.org/ns/ttml",ebuttm:"urn:ebu:tt:metadata",ebutts:"urn:ebu:tt:style",ittp:"http://www.w3.org/ns/ttml/profile/imsc1#parameter",itts:"http://www.w3.org/ns/ttml/profile/imsc1#styling",ttm:"http://www.w3.org/ns/ttml#metadata",ttp:"http://www.w3.org/ns/ttml#parameter",tts:"http://www.w3.org/ns/ttml#styling",xml:"http://www.w3.org/XML/1998/namespace"},prefix:"",local:"region",uri:"http://www.w3.org/ns/ttml",isSelfClosing:!0},h);f.sets=[];B.call(f,0,Number.POSITIVE_INFINITY,null);return f};
P.prototype.initFromNode=function(b,h,g){H.prototype.initFromNode.call(this,b,null,h,g);B.prototype.initFromNode.call(this,b,null,h,g);f.prototype.initFromNode.call(this,b,null,h,g);this.styleAttrs=U(h,g);this.styleRefs=I(h)};A.prototype.initFromNode=function(b,h,f,g){B.prototype.initFromNode.call(this,b,h,f,g);b=U(f,g);this.value=this.qname=null;for(var l in b){if(this.qname){L(g,"More than one style specified on set");break}this.qname=l;this.value=b[l]}}})("undefined"===typeof k?this.imscDoc={}:
k,"undefined"===typeof sax?e("sax"):sax,"undefined"===typeof imscNames?e("./names"):imscNames,"undefined"===typeof imscStyles?e("./styles"):imscStyles,"undefined"===typeof imscUtils?e("./utils"):imscUtils)},{"./names":5,"./styles":6,"./utils":7,sax:void 0}],2:[function(e,r,k){(function(d,e,m,k){function q(b){var h={};b=Object.entries(b);for(var f in b){var g=k.parseColor(b[f][0]),d=k.parseColor(b[f][1]);g&&d&&(h[g.toString()]=d)}return h}function u(h,l,f){if("region"===f.kind){var g=document.createElement("div");
g.style.position="absolute"}else if("body"===f.kind)g=document.createElement("div");else if("div"===f.kind)g=document.createElement("div");else if("image"===f.kind){if(g=document.createElement("img"),null!==h.imgResolver&&null!==f.src){var d=h.imgResolver(f.src,g);d&&(g.src=d);g.height=h.regionH;g.width=h.regionW}}else if("p"===f.kind)g=document.createElement("p");else if("span"===f.kind)if("container"===f.styleAttrs[m.byName.ruby.qname])g=document.createElement("ruby"),h.ruby=!0;else if("base"===
f.styleAttrs[m.byName.ruby.qname])g=document.createElement("rb");else if("text"===f.styleAttrs[m.byName.ruby.qname])g=document.createElement("rt");else if("baseContainer"===f.styleAttrs[m.byName.ruby.qname])g=document.createElement("rbc");else if("textContainer"===f.styleAttrs[m.byName.ruby.qname])g=document.createElement("rtc");else{if("delimiter"===f.styleAttrs[m.byName.ruby.qname])return;g=document.createElement("span")}else"br"===f.kind&&(g=document.createElement("br"));if(g){l.appendChild(g);
g.style.margin="0";if("region"===f.kind)if(l=f.styleAttrs[m.byName.writingMode.qname],"lrtb"===l||"lr"===l)h.ipd="lr",h.bpd="tb";else if("rltb"===l||"rl"===l)h.ipd="rl",h.bpd="tb";else if("tblr"===l)h.ipd="tb",h.bpd="lr";else{if("tbrl"===l||"tb"===l)h.ipd="tb",h.bpd="rl"}else"p"===f.kind&&"tb"===h.bpd&&(h.ipd="ltr"===f.styleAttrs[m.byName.direction.qname]?"lr":"rl");for(var e in E)l=E[e],d=f.styleAttrs[l.qname],void 0!==d&&null!==l.map&&l.map(h,g,f,d);e=g;(l=f.styleAttrs[m.byName.linePadding.qname])&&
!l.isZero()&&(d=l.multiply(l.toUsedLength(h.w,h.h),h.options.sizeAdjust),0<d&&(d=Math.ceil(d)+"px","tb"===h.bpd?(e.style.paddingLeft=d,e.style.paddingRight=d):(e.style.paddingTop=d,e.style.paddingBottom=d),h.lp=l));(l=f.styleAttrs[m.byName.multiRowAlign.qname])&&"auto"!==l&&(e=document.createElement("span"),e.style.display="inline-block",e.style.textAlign=l,g.appendChild(e),h.mra=l);(l=f.styleAttrs[m.byName.rubyReserve.qname])&&"none"!==l[0]&&(h.rubyReserve=l);f.styleAttrs[m.byName.fillLineGap.qname]&&
(h.flg=!0);if("span"===f.kind&&f.text)if((l=f.styleAttrs[m.byName.textEmphasis.qname])&&"none"!==l.style&&(h.textEmphasis=!0),m.byName.textCombine.qname in f.styleAttrs&&"all"===f.styleAttrs[m.byName.textCombine.qname][0])g.textContent=f.text,l&&p(h,g,f,l);else{d="";for(var k=0;k<f.text.length;k++){d+=f.text.charAt(k);var q=f.text.charCodeAt(k);if(55296>q||56319<q||k===f.text.length)q=document.createElement("span"),q.textContent=d,l&&p(h,q,f,l),g.appendChild(q),d=""}}for(var t in f.contents)u(h,e,
f.contents[t]);t=[];if((h.lp||h.mra||h.flg||h.ruby||h.textEmphasis||h.rubyReserve)&&"p"===f.kind){G(h,e,t,null);if(h.rubyReserve){for(l=0;l<t.length;l++){d=document.createElement("ruby");k=document.createElement("rb");k.textContent="\u200b";d.appendChild(k);var r=h.rubyReserve[1].toUsedLength(h.w,h.h)+"px";"both"===h.rubyReserve[0]||"outside"===h.rubyReserve[0]&&1==t.length?(k=document.createElement("rtc"),k.style[D]=J?"after":"under",k.textContent="\u200b",k.style.fontSize=r,q=document.createElement("rtc"),
q.style[D]=J?"before":"over",q.textContent="\u200b",q.style.fontSize=r,d.appendChild(k),d.appendChild(q)):(k=document.createElement("rtc"),k.textContent="\u200b",k.style.fontSize=r,k.style[D]="after"===h.rubyReserve[0]||"outside"===h.rubyReserve[0]&&0<l?J?"after":"tb"===h.bpd||"rl"===h.bpd?"under":"over":J?"before":"tb"===h.bpd||"rl"===h.bpd?"over":"under",d.appendChild(k));k=null;for(q=0;q<t[l].rbc.length;q++)if("ruby"===t[l].rbc[q].localName){k=t[l].rbc[q];for(q=0;q<k.style.length;q++)d.style.setProperty(k.style.item(q),
k.style.getPropertyValue(k.style.item(q)));break}k=k||t[l].elements[0].node;k.parentElement.insertBefore(d,k)}h.rubyReserve=null}if(h.ruby||h.rubyReserve){for(l=0;l<t.length;l++)for(d=0;d<t[l].rbc.length;d++)t[l].rbc[d].style[D]||(t[l].rbc[d].style[D]=J?0===l?"before":"after":"tb"===h.bpd?0===l?"over":"under":"rl"===h.bpd?0===l?"over":"under":0===l?"under":"over");h.ruby=null}if(h.textEmphasis){for(l=0;l<t.length;l++)for(d=0;d<t[l].te.length;d++)t[l].te[d].style[H]&&"none"!==t[l].te[d].style[H]||
(t[l].te[d].style[H]="tb"===h.bpd?0===l?"left over":"left under":"rl"===h.bpd?0===l?"right under":"left under":0===l?"left under":"right under");h.textEmphasis=null}if(h.mra){for(l=0;l<t.length-1;l++)k=t[l].elements.length,0!==k&&!1===t[l].br&&(d=document.createElement("br"),k=t[l].elements[k-1].node,k.parentElement.insertBefore(d,k.nextSibling));h.mra=null}if(h.lp){l=h.lp.multiply(h.lp.toUsedLength(h.w,h.h),h.options.sizeAdjust);for(var v in t)d=t[v].elements[t[v].start_elem],k=t[v].elements[t[v].end_elem],
q=Math.ceil(l)+"px",r="-"+Math.ceil(l)+"px",0!==t[v].elements.length&&("lr"===h.ipd?(d.node.style.borderLeftColor=d.bgcolor||"#00000000",d.node.style.borderLeftStyle="solid",d.node.style.borderLeftWidth=q,d.node.style.marginLeft=r):"rl"===h.ipd?(d.node.style.borderRightColor=d.bgcolor||"#00000000",d.node.style.borderRightStyle="solid",d.node.style.borderRightWidth=q,d.node.style.marginRight=r):"tb"===h.ipd&&(d.node.style.borderTopColor=d.bgcolor||"#00000000",d.node.style.borderTopStyle="solid",d.node.style.borderTopWidth=
q,d.node.style.marginTop=r),"lr"===h.ipd?(k.node.style.borderRightColor=k.bgcolor||"#00000000",k.node.style.borderRightStyle="solid",k.node.style.borderRightWidth=q,k.node.style.marginRight=r):"rl"===h.ipd?(k.node.style.borderLeftColor=k.bgcolor||"#00000000",k.node.style.borderLeftStyle="solid",k.node.style.borderLeftWidth=q,k.node.style.marginLeft=r):"tb"===h.ipd&&(k.node.style.borderBottomColor=k.bgcolor||"#00000000",k.node.style.borderBottomStyle="solid",k.node.style.borderBottomWidth=q,k.node.style.marginBottom=
r));h.lp=null}if(h.flg){l=n(e.getBoundingClientRect(),h);v=l.before;l=l.after;d=Math.sign(l-v);for(k=0;k<=t.length;k++){q=0===k?v:k===t.length?l:(t[k].before+t[k-1].after)/2;if(0<k)for(var x=0;x<t[k-1].elements.length;x++)if(null!==t[k-1].elements[x].bgcolor){var A=t[k-1].elements[x];0>d*(A.after-q)&&(r=Math.ceil(Math.abs(q-A.after))+"px",A.node.style.backgroundColor=A.bgcolor,"lr"===h.bpd?A.node.style.paddingRight=r:"rl"===h.bpd?A.node.style.paddingLeft=r:"tb"===h.bpd&&(A.node.style.paddingBottom=
r))}if(k<t.length)for(x=0;x<t[k].elements.length;x++)A=t[k].elements[x],null!==A.bgcolor&&0<d*(A.before-q)&&(r=Math.ceil(Math.abs(A.before-q))+"px",A.node.style.backgroundColor=A.bgcolor,"lr"===h.bpd?A.node.style.paddingLeft=r:"rl"===h.bpd?A.node.style.paddingRight=r:"tb"===h.bpd&&(A.node.style.paddingTop=r))}h.flg=null}}"region"===f.kind&&(G(h,e,t),"tb"===h.bpd&&h.enableRollUp&&0<f.contents.length&&"after"===f.styleAttrs[m.byName.displayAlign.qname]&&(f=new b(""===f.id?"_":f.id,t),h.currentISDState[f.id]=
f,h.previousISDState&&f.id in h.previousISDState&&0<h.previousISDState[f.id].plist.length&&1<f.plist.length&&f.plist[f.plist.length-2].text===h.previousISDState[f.id].plist[h.previousISDState[f.id].plist.length-1].text&&(h=g.firstElementChild,f=f.plist[f.plist.length-1].after-f.plist[f.plist.length-1].before,h.style.bottom="-"+f+"px",h.style.transition="transform 0.4s",h.style.position="relative",h.style.transform="translateY(-"+f+"px)")))}else if(h=h.errorHandler,f="Error processing ISD element kind: "+
f.kind,h&&h.error&&h.error(f))throw f;}function b(b,d){this.id=b;this.plist=d}function n(b,d){var f={before:null,after:null,start:null,end:null};"tb"===d.bpd?(f.before=b.top,f.after=b.bottom,"lr"===d.ipd?(f.start=b.left,f.end=b.right):(f.start=b.right,f.end=b.left)):"lr"===d.bpd?(f.before=b.left,f.after=b.right,f.start=b.top,f.end=b.bottom):"rl"===d.bpd&&(f.before=b.right,f.after=b.left,f.start=b.top,f.end=b.bottom);return f}function G(b,d,f,g){if("rt"!==d.localName&&"rtc"!==d.localName)if(g=d.style.backgroundColor||
g,0===d.childElementCount)if("span"===d.localName||"rb"===d.localName){var h=d.getBoundingClientRect();if(0!==h.height&&0!==h.width){b=n(h,b);if(!(h=0===f.length)){h=b.before;var l=b.after,e=f[f.length-1].before,k=f[f.length-1].after;h=!(l<k&&h>e||k<=l&&e>=h)}h?f.push({before:b.before,after:b.after,start:b.start,end:b.end,start_elem:0,end_elem:0,elements:[],rbc:[],te:[],text:"",br:!1}):(h=Math.sign(b.after-b.before),l=Math.sign(b.end-b.start),0>h*(b.before-f[f.length-1].before)&&(f[f.length-1].before=
b.before),0<h*(b.after-f[f.length-1].after)&&(f[f.length-1].after=b.after),0>l*(b.start-f[f.length-1].start)&&(f[f.length-1].start=b.start,f[f.length-1].start_elem=f[f.length-1].elements.length),0<l*(b.end-f[f.length-1].end)&&(f[f.length-1].end=b.end,f[f.length-1].end_elem=f[f.length-1].elements.length));f[f.length-1].text+=d.textContent;f[f.length-1].elements.push({node:d,bgcolor:g,before:b.before,after:b.after})}}else"br"===d.localName&&0!==f.length&&(f[f.length-1].br=!0);else for(d=d.firstChild;d;)d.nodeType===
Node.ELEMENT_NODE&&(G(b,d,f,g),"ruby"===d.localName||"rtc"===d.localName?0<f.length&&f[f.length-1].rbc.push(d):"span"===d.localName&&d.style[v]&&"none"!==d.style[v]&&0<f.length&&f[f.length-1].te.push(d)),d=d.nextSibling}function p(b,d,f,g){if("none"===g.style)d.style[v]="none";else if(d.style[v]="auto"===g.style?"filled":g.style+" "+g.symbol,"before"===g.position||"after"===g.position)d.style[H]="tb"===b.bpd?"before"===g.position?"left over":"left under":"rl"===b.bpd?"before"===g.position?"right under":
"left under":"before"===g.position?"left under":"right under"}function t(b,d){this.qname=b;this.map=d}d.render=function(b,d,f,g,n,e,k,m,p,t){g=g||d.clientHeight;var h=n||d.clientWidth;null!==b.aspectRatio&&(n=g*b.aspectRatio,n>h?g=Math.round(h/b.aspectRatio):h=n);n=document.createElement("div");n.style.position="relative";n.style.width=h+"px";n.style.height=g+"px";n.style.margin="auto";n.style.top=0;n.style.bottom=0;n.style.left=0;n.style.right=0;n.style.zIndex=0;f={h:g,w:h,regionH:null,regionW:null,
imgResolver:f,displayForcedOnlyMode:e||!1,isd:b,errorHandler:k,previousISDState:m,enableRollUp:p||!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null,ruby:null,textEmphasis:null,rubyReserve:null,options:Object.assign({},t)||{}};f.options.colorAdjust&&(f.options.colorAdjust=q(f.options.colorAdjust));e=["region","body","div","p","span"];for(var l in e)k=e[l]+"BackgroundColorAdjust",f.options[k]&&(f.options[k]=q(f.options[k]));d.appendChild(n);for(var G in b.contents)u(f,n,b.contents[G]);
return f.currentISDState};var E=[new t("http://www.w3.org/ns/ttml#styling backgroundColor",function(b,d,f,g){(f=(f=b.options[f.kind+"BackgroundColorAdjust"])&&f[g.toString()])&&(g=f);f=g[3];0!==f&&(void 0!=b.options.backgroundOpacityScale&&(f*=b.options.backgroundOpacityScale),d.style.backgroundColor="rgba("+g[0].toString()+","+g[1].toString()+","+g[2].toString()+","+(f/255).toString()+")")}),new t("http://www.w3.org/ns/ttml#styling color",function(b,d,f,g){f=b.options.colorOpacityScale||1;var h=
b.options.colorAdjust;void 0!=h&&(h=h[g.toString()])&&(g=h);var l=g[0],n=g[1];h=g[2];g=g[3];b.options.hdr?(b=Math.pow(l/255,2),f=Math.pow(n/255,2),h=Math.pow(h/255,2),b=.627403895934699*b+.3292830383778848*f+.0433130656874172*h,f=.0690972893582321*b+.919540395075459*f+.0113623155663092*h,h=.0163914388751502*b+.0880133078772256*f+.895595253247623*h,b*=.265,f*=.265,h*=.265,a=.17883277,bb=1-4*a,c=.5-a*Math.log(4*a),b=b<=1/12?Math.pow(3*b,.5):a*Math.log(12*b-bb)+c,f=f<=1/12?Math.pow(3*f,.5):a*Math.log(12*
f-bb)+c,h=h<=1/12?Math.pow(3*h,.5):a*Math.log(12*h-bb)+c,g=[b,f,h,g],b="color(display-p3 "+g[0].toString()+" "+g[1].toString()+" "+g[2].toString()+")",d.style.color=b,console.log(b)):(g=[l,n,h,g],d.style.color="rgba("+g[0].toString()+","+g[1].toString()+","+g[2].toString()+","+(f*g[3]/255).toString()+")")}),new t("http://www.w3.org/ns/ttml#styling direction",function(b,d,f,g){d.style.direction=g}),new t("http://www.w3.org/ns/ttml#styling display",function(b,d,f,g){}),new t("http://www.w3.org/ns/ttml#styling displayAlign",
function(b,d,f,g){d.style.display="flex";d.style.flexDirection="column";"before"===g?d.style.justifyContent="flex-start":"center"===g?d.style.justifyContent="center":"after"===g&&(d.style.justifyContent="flex-end")}),new t("http://www.w3.org/ns/ttml#styling extent",function(b,d,f,g){b.regionH=g.h.toUsedLength(b.w,b.h);b.regionW=g.w.toUsedLength(b.w,b.h);var h=g=0;if(f=f.styleAttrs["http://www.w3.org/ns/ttml#styling padding"])g=f[0].toUsedLength(b.w,b.h)+f[2].toUsedLength(b.w,b.h),h=f[1].toUsedLength(b.w,
b.h)+f[3].toUsedLength(b.w,b.h);d.style.height=b.regionH-g+"px";d.style.width=b.regionW-h+"px"}),new t("http://www.w3.org/ns/ttml#styling fontFamily",function(b,d,f,g){f=[];b.options.fontFamily&&(g=b.options.fontFamily.split(","));for(var h in g)g[h]=g[h].trim(),"monospaceSerif"===g[h]?(f.push("Courier New"),f.push('"Liberation Mono"'),f.push("Courier"),f.push("monospace")):"proportionalSansSerif"===g[h]||"default"===g[h]?(f.push("Arial"),f.push("Helvetica"),f.push('"Liberation Sans"'),f.push("sans-serif")):
"monospace"===g[h]?f.push("monospace"):"sansSerif"===g[h]?f.push("sans-serif"):"serif"===g[h]?f.push("serif"):"monospaceSansSerif"===g[h]?(f.push("Consolas"),f.push("monospace")):"proportionalSerif"===g[h]?f.push("serif"):f.push(g[h]);d.style.fontFamily=f.join(",")}),new t("http://www.w3.org/ns/ttml#styling shear",function(b,d,f,g){0!==g&&(f=-.9*g,d.style.transform="tb"===b.bpd?"skewX("+f+"deg)":"skewY("+f+"deg)")}),new t("http://www.w3.org/ns/ttml#styling fontSize",function(b,d,f,g){d.style.fontSize=
g.multiply(g.toUsedLength(b.w,b.h),b.options.sizeAdjust)+"px"}),new t("http://www.w3.org/ns/ttml#styling fontStyle",function(b,d,f,g){d.style.fontStyle=g}),new t("http://www.w3.org/ns/ttml#styling fontWeight",function(b,d,f,g){d.style.fontWeight=g}),new t("http://www.w3.org/ns/ttml#styling lineHeight",function(b,d,f,g){d.style.lineHeight="normal"===g?"normal":g.multiply(g.multiply(g.toUsedLength(b.w,b.h),b.options.sizeAdjust),b.options.lineHeightAdjust)+"px"}),new t("http://www.w3.org/ns/ttml#styling opacity",
function(b,d,f,g){f=g;void 0!=b.options.regionOpacityScale&&(f*=b.options.regionOpacityScale);d.style.opacity=f}),new t("http://www.w3.org/ns/ttml#styling origin",function(b,d,f,g){d.style.top=g.h.toUsedLength(b.w,b.h)+"px";d.style.left=g.w.toUsedLength(b.w,b.h)+"px"}),new t("http://www.w3.org/ns/ttml#styling overflow",function(b,d,f,g){d.style.overflow=g}),new t("http://www.w3.org/ns/ttml#styling padding",function(b,d,f,g){f=[];f[0]=g[0].toUsedLength(b.w,b.h)+"px";f[1]=g[3].toUsedLength(b.w,b.h)+
"px";f[2]=g[2].toUsedLength(b.w,b.h)+"px";f[3]=g[1].toUsedLength(b.w,b.h)+"px";d.style.padding=f.join(" ")}),new t("http://www.w3.org/ns/ttml#styling position",function(b,d,f,g){d.style.top=g.h.toUsedLength(b.w,b.h)+"px";d.style.left=g.w.toUsedLength(b.w,b.h)+"px"}),new t("http://www.w3.org/ns/ttml#styling rubyAlign",function(b,d,f,g){d.style.rubyAlign="spaceAround"===g?"space-around":"center"}),new t("http://www.w3.org/ns/ttml#styling rubyPosition",function(b,d,f,g){if("before"===g||"after"===g)d.parentElement.style[D]=
J?g:"tb"===b.bpd?"before"===g?"over":"under":"rl"===b.bpd?"before"===g?"over":"under":"before"===g?"under":"over"}),new t("http://www.w3.org/ns/ttml#styling showBackground",null),new t("http://www.w3.org/ns/ttml#styling textAlign",function(b,d,f,g){d.style.textAlign="start"===g?"rl"===b.ipd?"right":"left":"end"===g?"rl"===b.ipd?"left":"right":g}),new t("http://www.w3.org/ns/ttml#styling textDecoration",function(b,d,f,g){d.style.textDecoration=g.join(" ").replace("lineThrough","line-through")}),new t("http://www.w3.org/ns/ttml#styling textOutline",
function(b,d,f,g){}),new t("http://www.w3.org/ns/ttml#styling textShadow",function(b,d,f,g){f=f.styleAttrs[m.byName.textOutline.qname];var h=b.options.textOutline;if(h)if("none"===h)f=h;else{var n={};h=h.split(" ");if(0!==h.length&&2>=h.length){var e=k.parseColor(h[0]);n.color=e;null!==e&&h.shift();1===h.length&&(h=k.parseLength(h[0]))&&(n.thickness=h,f=n)}}if("none"===g&&"none"===f)d.style.textShadow="";else{n=[];"none"!==f&&(f="rgba("+f.color[0].toString()+","+f.color[1].toString()+","+f.color[2].toString()+
","+(f.color[3]/255).toString()+")",n.push("1px 1px 1px "+f),n.push("-1px 1px 1px "+f),n.push("1px -1px 1px "+f),n.push("-1px -1px 1px "+f));if("none"!==g)for(var l in g)n.push(g[l].x_off.toUsedLength(b.w,b.h)+"px "+g[l].y_off.toUsedLength(b.w,b.h)+"px "+g[l].b_radius.toUsedLength(b.w,b.h)+"px rgba("+g[l].color[0].toString()+","+g[l].color[1].toString()+","+g[l].color[2].toString()+","+(g[l].color[3]/255).toString()+")");d.style.textShadow=n.join(",")}}),new t("http://www.w3.org/ns/ttml#styling textCombine",
function(b,d,f,g){d.style.textCombineUpright=g.join(" ")}),new t("http://www.w3.org/ns/ttml#styling textEmphasis",function(b,d,f,g){}),new t("http://www.w3.org/ns/ttml#styling unicodeBidi",function(b,d,f,g){d.style.unicodeBidi="bidiOverride"===g?"bidi-override":g}),new t("http://www.w3.org/ns/ttml#styling visibility",function(b,d,f,g){d.style.visibility=g}),new t("http://www.w3.org/ns/ttml#styling wrapOption",function(b,d,f,g){d.style.whiteSpace="wrap"===g?"preserve"===f.space?"pre-wrap":"normal":
"preserve"===f.space?"pre":"noWrap"}),new t("http://www.w3.org/ns/ttml#styling writingMode",function(b,d,f,g){if("lrtb"===g||"lr"===g)d.style.writingMode="horizontal-tb";else if("rltb"===g||"rl"===g)d.style.writingMode="horizontal-tb";else if("tblr"===g)d.style.writingMode="vertical-lr";else if("tbrl"===g||"tb"===g)d.style.writingMode="vertical-rl"}),new t("http://www.w3.org/ns/ttml#styling zIndex",function(b,d,f,g){d.style.zIndex=g}),new t("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",
function(b,d,f,g){b.displayForcedOnlyMode&&!1===g&&(d.style.visibility="hidden")})],r;for(r in E);var J="webkitRubyPosition"in window.getComputedStyle(document.documentElement),D=J?"webkitRubyPosition":"rubyPosition",v="webkitTextEmphasisStyle"in window.getComputedStyle(document.documentElement)?"webkitTextEmphasisStyle":"textEmphasisStyle",H="webkitTextEmphasisPosition"in window.getComputedStyle(document.documentElement)?"webkitTextEmphasisPosition":"textEmphasisPosition"})("undefined"===typeof k?
this.imscHTML={}:k,"undefined"===typeof imscNames?e("./names"):imscNames,"undefined"===typeof imscStyles?e("./styles"):imscStyles,"undefined"===typeof imscUtils?e("./utils"):imscUtils)},{"./names":5,"./styles":6,"./utils":7}],3:[function(e,r,k){(function(d,e,k,u){function m(d,e,G,r,v,H,h,l,f){if(e<h.begin||e>=h.end)return null;H="regionID"in h&&""!==h.regionID?h.regionID:H;if(null!==v&&H!==G.id&&(!("contents"in h)||"contents"in h&&0===h.contents.length||""!==H))return null;var g=new p(h);for(E in h.sets)e<
h.sets[E].begin||e>=h.sets[E].end||(g.styleAttrs[h.sets[E].qname]=h.sets[E].value);var E={};for(var w in g.styleAttrs)if(E[w]=!0,"region"===g.kind&&w===k.byName.writingMode.qname&&!(k.byName.direction.qname in g.styleAttrs)){var x=g.styleAttrs[w];if("lrtb"===x||"lr"===x)g.styleAttrs[k.byName.direction.qname]="ltr";else if("rltb"===x||"rl"===x)g.styleAttrs[k.byName.direction.qname]="rtl"}if(null!==v)for(var y in k.all)if(w=k.all[y],w.qname===k.byName.textDecoration.qname){x=v.styleAttrs[w.qname];var D=
g.styleAttrs[w.qname],J=[];void 0===D?J=x:-1===D.indexOf("none")?((-1===D.indexOf("noUnderline")&&-1!==x.indexOf("underline")||-1!==D.indexOf("underline"))&&J.push("underline"),(-1===D.indexOf("noLineThrough")&&-1!==x.indexOf("lineThrough")||-1!==D.indexOf("lineThrough"))&&J.push("lineThrough"),(-1===D.indexOf("noOverline")&&-1!==x.indexOf("overline")||-1!==D.indexOf("overline"))&&J.push("overline")):J.push("none");g.styleAttrs[w.qname]=J}else w.qname!==k.byName.fontSize.qname||w.qname in g.styleAttrs||
"span"!==g.kind||"textContainer"!==g.styleAttrs[k.byName.ruby.qname]?w.qname!==k.byName.fontSize.qname||w.qname in g.styleAttrs||"span"!==g.kind||"text"!==g.styleAttrs[k.byName.ruby.qname]?w.inherit&&w.qname in v.styleAttrs&&!(w.qname in g.styleAttrs)&&(g.styleAttrs[w.qname]=v.styleAttrs[w.qname]):(x=v.styleAttrs[k.byName.fontSize.qname],g.styleAttrs[w.qname]="textContainer"===v.styleAttrs[k.byName.ruby.qname]?x:new u.ComputedLength(.5*x.rw,.5*x.rh)):(x=v.styleAttrs[k.byName.fontSize.qname],g.styleAttrs[w.qname]=
new u.ComputedLength(.5*x.rw,.5*x.rh));for(var C in k.all)if(y=k.all[C],!(y.qname in g.styleAttrs||y.qname===k.byName.position.qname&&k.byName.origin.qname in g.styleAttrs||y.qname===k.byName.origin.qname&&k.byName.position.qname in g.styleAttrs)&&(w=d.head.styling.initials[y.qname]||y.initial,null!==w&&("region"===g.kind||!1===y.inherit&&null!==w)))if(w=y.parse(w),null!==w)g.styleAttrs[y.qname]=w,E[y.qname]=!0;else if(y="Invalid initial value for '"+y.qname+"' on element '"+g.kind,l&&l.error&&l.error(y))throw y;
for(var K in k.all)if(C=k.all[K],C.qname in E&&null!==C.compute)if(y=C.compute(d,v,g,g.styleAttrs[C.qname],f),null!==y)g.styleAttrs[C.qname]=y;else if(g.styleAttrs[C.qname]=C.compute(d,v,g,C.parse(C.initial),f),C="Style '"+C.qname+"' on element '"+g.kind+"' cannot be computed",l&&l.error&&l.error(C))throw C;if("none"===g.styleAttrs[k.byName.display.qname])return null;if(null===v)var A=null===r?[]:[r];else"contents"in h&&(A=h.contents);for(var N in A)v=m(d,e,G,r,g,H,A[N],l,f),null!==v&&g.contents.push(v.element);
for(var I in g.styleAttrs)d=!1,"span"===g.kind&&(e=g.styleAttrs[k.byName.ruby.qname],(d=("container"===e||"textContainer"===e||"baseContainer"===e)&&-1!==t.indexOf(I))||(d="container"!==e&&I===k.byName.rubyAlign.qname),d||(d=!("textContainer"===e||"text"===e)&&I===k.byName.rubyPosition.qname)),d||(d=-1===k.byQName[I].applies.indexOf(g.kind)),d&&delete g.styleAttrs[I];I=g.styleAttrs[k.byName.ruby.qname];if("p"===g.kind||"span"===g.kind&&("textContainer"===I||"text"===I))I=[],b(g,I),q(I),n(g);return"div"===
g.kind&&k.byName.backgroundImage.qname in g.styleAttrs||"br"===g.kind||"image"===g.kind||"contents"in g&&0<g.contents.length||"span"===g.kind&&null!==g.text||"region"===g.kind&&"always"===g.styleAttrs[k.byName.showBackground.qname]?{region_id:H,element:g}:null}function q(b){function d(b){return"br"===b.kind||/[\r\n\t ]$/.test(b.text)}function n(b){return"br"===b.kind||"preserve"===b.space&&/^[\r\n]/.test(b.text)}for(var e,k=0;k<b.length;)if(e=b[k],"br"===e.kind||"preserve"===e.space)k++;else{var p=
e.text.replace(/[\t\r\n ]+/g," ");/^[ ]/.test(p)&&(0===k||d(b[k-1]))&&(p=p.substring(1));e.text=p;0===p.length?b.splice(k,1):k++}for(k=0;k<b.length;k++)e=b[k],"br"===e.kind||"preserve"===e.space?k++:/[ ]$/.test(e.text)&&(k===b.length-1||n(b[k+1]))&&(e.text=e.text.slice(0,-1))}function b(d,n){for(var e in d.contents){var p=d.contents[e],m=p.styleAttrs[k.byName.ruby.qname];if("span"!==p.kind||"textContainer"!==m&&"text"!==m)"contents"in p?b(p,n):("span"===p.kind&&0!==p.text.length||"br"===p.kind)&&
n.push(p)}}function n(b){if("br"===b.kind)return!1;if("text"in b)return 0===b.text.length;if("contents"in b){for(var d=b.contents.length;d--;)n(b.contents[d])&&b.contents.splice(d,1);return 0===b.contents.length}}function G(b){this.contents=[];this.aspectRatio=b.aspectRatio}function p(b){this.kind=b.kind||"region";b.id&&(this.id=b.id);this.styleAttrs={};for(var d in b.styleAttrs)this.styleAttrs[d]=b.styleAttrs[d];"src"in b&&(this.src=b.src);"type"in b&&(this.type=b.type);if("text"in b)this.text=b.text;
else if("region"===this.kind||"contents"in b)this.contents=[];"space"in b&&(this.space=b.space)}d.generateISD=function(b,d,n){function e(b,d){function f(d){return!(b<d.begin||b>=d.end)}if(d.contents){var g={},h;for(h in d)g[h]=d[h];g.contents=[];d.contents.filter(f).forEach(function(d){d=e(b,d);d.regionID&&l.add(d.regionID);null!==d&&g.contents.push(d)});return g}return d}var k=new G(b),p={},h={},l=new Set;h=e(d,b.body);0===l.size&&b.head.layout.regions.hasOwnProperty("")&&l.add("");l.forEach(function(f){f=
m(b,d,b.head.layout.regions[f],h,null,"",b.head.layout.regions[f],n,p);null!==f&&k.contents.push(f.element)});return k};var t=[k.byName.color.qname,k.byName.textCombine.qname,k.byName.textDecoration.qname,k.byName.textEmphasis.qname,k.byName.textOutline.qname,k.byName.textShadow.qname]})("undefined"===typeof k?this.imscISD={}:k,"undefined"===typeof imscNames?e("./names"):imscNames,"undefined"===typeof imscStyles?e("./styles"):imscStyles,"undefined"===typeof imscUtils?e("./utils"):imscUtils)},{"./names":5,
"./styles":6,"./utils":7}],4:[function(e,r,k){k.generateISD=e("./isd").generateISD;k.fromXML=e("./doc").fromXML;k.renderHTML=e("./html").render},{"./doc":1,"./html":2,"./isd":3}],5:[function(e,r,k){e="undefined"===typeof k?this.imscNames={}:k;e.ns_tt="http://www.w3.org/ns/ttml";e.ns_tts="http://www.w3.org/ns/ttml#styling";e.ns_ttp="http://www.w3.org/ns/ttml#parameter";e.ns_xml="http://www.w3.org/XML/1998/namespace";e.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling";e.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter";
e.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt";e.ns_ebutts="urn:ebu:tt:style";e.ttaf_map={"http://www.w3.org/2006/10/ttaf1":e.ns_tt,"http://www.w3.org/2006/10/ttaf1#style":e.ns_tts,"http://www.w3.org/2006/10/ttaf1#parameter":e.ns_ttp}},{}],6:[function(e,r,k){(function(d,e,k){function m(b,d,e,k,m,q,r,u){this.name=d;this.ns=b;this.qname=b+" "+d;this.inherit=m;this.animatable=q;this.initial=e;this.applies=k;this.parse=r;this.compute=u}d.all=[new m(e.ns_tts,"backgroundColor","transparent",
["body","div","p","region","span"],!1,!0,k.parseColor,null),new m(e.ns_tts,"color","white",["span"],!0,!0,k.parseColor,null),new m(e.ns_tts,"direction","ltr",["p","span"],!0,!0,function(b){return b},null),new m(e.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,function(b){return b},null),new m(e.ns_tts,"displayAlign","before",["region"],!1,!0,function(b){return b},null),new m(e.ns_tts,"extent","auto",["tt","region"],!1,!0,function(b){if("auto"===b)return b;var d=b.split(" ");if(2!==
d.length)return null;b=k.parseLength(d[0]);return(d=k.parseLength(d[1]))&&b?{h:d,w:b}:null},function(b,d,e,p,m){if("auto"===p)d=new k.ComputedLength(0,1);else if(d=k.toComputedLength(p.h.value,p.h.unit,null,b.dimensions.h,null,b.pxLength.h),null===d)return null;if("auto"===p)b=new k.ComputedLength(1,0);else if(b=k.toComputedLength(p.w.value,p.w.unit,null,b.dimensions.w,null,b.pxLength.w),null===b)return null;return{h:d,w:b}}),new m(e.ns_tts,"fontFamily","default",["p","span"],!0,!0,function(b){b=
b.split(",");var d=[],e;for(e in b)"'"!==b[e].charAt(0)&&'"'!==b[e].charAt(0)?"default"===b[e]?d.push("monospaceSerif"):d.push(b[e]):d.push(b[e]);return d},null),new m(e.ns_tts,"shear","0%",["p"],!0,!0,k.parseLength,function(b,d,e,k){if("%"===k.unit)b=100<Math.abs(k.value)?100*Math.sign(k.value):k.value;else return null;return b}),new m(e.ns_tts,"fontSize","1c",["p","span"],!0,!0,k.parseLength,function(b,e,m,p,t){return k.toComputedLength(p.value,p.unit,null!==e?e.styleAttrs[d.byName.fontSize.qname]:
b.cellLength.h,null!==e?e.styleAttrs[d.byName.fontSize.qname]:b.cellLength.h,b.cellLength.h,b.pxLength.h)}),new m(e.ns_tts,"fontStyle","normal",["span"],!0,!0,function(b){return b},null),new m(e.ns_tts,"fontWeight","normal",["span"],!0,!0,function(b){return b},null),new m(e.ns_tts,"lineHeight","normal",["p"],!0,!0,function(b){return"normal"===b?b:k.parseLength(b)},function(b,e,m,p,t){if("normal"===p)b=p;else if(b=k.toComputedLength(p.value,p.unit,m.styleAttrs[d.byName.fontSize.qname],m.styleAttrs[d.byName.fontSize.qname],
b.cellLength.h,b.pxLength.h),null===b)return null;return b}),new m(e.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new m(e.ns_tts,"origin","auto",["region"],!1,!0,function(b){if("auto"===b)return b;var d=b.split(" ");if(2!==d.length)return null;b=k.parseLength(d[0]);return(d=k.parseLength(d[1]))&&b?{h:d,w:b}:null},function(b,d,e,p,m){if("auto"===p)d=new k.ComputedLength(0,0);else if(d=k.toComputedLength(p.h.value,p.h.unit,null,b.dimensions.h,null,b.pxLength.h),null===d)return null;if("auto"===
p)b=new k.ComputedLength(0,0);else if(b=k.toComputedLength(p.w.value,p.w.unit,null,b.dimensions.w,null,b.pxLength.w),null===b)return null;return{h:d,w:b}}),new m(e.ns_tts,"overflow","hidden",["region"],!1,!0,function(b){return b},null),new m(e.ns_tts,"padding","0px",["region"],!1,!0,function(b){b=b.split(" ");if(4<b.length)return null;var d=[],e;for(e in b){var p=k.parseLength(b[e]);if(!p)return null;d.push(p)}return d},function(b,e,m,p,t){if(1===p.length)e=[p[0],p[0],p[0],p[0]];else if(2===p.length)e=
[p[0],p[1],p[0],p[1]];else if(3===p.length)e=[p[0],p[1],p[2],p[1]];else if(4===p.length)e=[p[0],p[1],p[2],p[3]];else return null;p=m.styleAttrs[d.byName.writingMode.qname];if("lrtb"===p||"lr"===p)e=[e[0],e[3],e[2],e[1]];else if("rltb"===p||"rl"===p)e=[e[0],e[1],e[2],e[3]];else if("tblr"===p)e=[e[3],e[0],e[1],e[2]];else if("tbrl"===p||"tb"===p)e=[e[3],e[2],e[1],e[0]];else return null;p=[];for(var n in e)if(0===e[n].value)p[n]=new k.ComputedLength(0,0);else if(p[n]=k.toComputedLength(e[n].value,e[n].unit,
m.styleAttrs[d.byName.fontSize.qname],"0"===n||"2"===n?m.styleAttrs[d.byName.extent.qname].h:m.styleAttrs[d.byName.extent.qname].w,"0"===n||"2"===n?b.cellLength.h:b.cellLength.w,"0"===n||"2"===n?b.pxLength.h:b.pxLength.w),null===p[n])return null;return p}),new m(e.ns_tts,"position","top left",["region"],!1,!0,function(b){return k.parsePosition(b)},function(b,e,m,p){e=k.toComputedLength(p.v.offset.value,p.v.offset.unit,null,new k.ComputedLength(-m.styleAttrs[d.byName.extent.qname].h.rw,b.dimensions.h.rh-
m.styleAttrs[d.byName.extent.qname].h.rh),null,b.pxLength.h);if(null===e)return null;"bottom"===p.v.edge&&(e=new k.ComputedLength(-e.rw-m.styleAttrs[d.byName.extent.qname].h.rw,b.dimensions.h.rh-e.rh-m.styleAttrs[d.byName.extent.qname].h.rh));var n=k.toComputedLength(p.h.offset.value,p.h.offset.unit,null,new k.ComputedLength(b.dimensions.w.rw-m.styleAttrs[d.byName.extent.qname].w.rw,-m.styleAttrs[d.byName.extent.qname].w.rh),null,b.pxLength.w);if(null===e)return null;"right"===p.h.edge&&(n=new k.ComputedLength(b.dimensions.w.rw-
n.rw-m.styleAttrs[d.byName.extent.qname].w.rw,-n.rh-m.styleAttrs[d.byName.extent.qname].w.rh));return{h:e,w:n}}),new m(e.ns_tts,"ruby","none",["span"],!1,!0,function(b){return b},null),new m(e.ns_tts,"rubyAlign","center",["span"],!0,!0,function(b){return"center"!==b&&"spaceAround"!==b?null:b},null),new m(e.ns_tts,"rubyPosition","outside",["span"],!0,!0,function(b){return b},null),new m(e.ns_tts,"rubyReserve","none",["p"],!0,!0,function(b){var d=b.split(" ");b=[null,null];if(0===d.length||2<d.length||
"none"!==d[0]&&"both"!==d[0]&&"after"!==d[0]&&"before"!==d[0]&&"outside"!==d[0])return null;b[0]=d[0];if(2===d.length&&"none"!==d[0])if(d=k.parseLength(d[1]))b[1]=d;else return null;return b},function(b,e,m,p,t){if("none"===p[0])return p;b=null===p[1]?new k.ComputedLength(.5*m.styleAttrs[d.byName.fontSize.qname].rw,.5*m.styleAttrs[d.byName.fontSize.qname].rh):k.toComputedLength(p[1].value,p[1].unit,m.styleAttrs[d.byName.fontSize.qname],m.styleAttrs[d.byName.fontSize.qname],b.cellLength.h,b.pxLength.h);
return null===b?null:[p[0],b]}),new m(e.ns_tts,"showBackground","whenActive",["region"],!1,!0,function(b){return b},null),new m(e.ns_tts,"textAlign","start",["p"],!0,!0,function(b){return b},function(b,d,e,k,m){return"left"===k?"start":"right"===k?"end":k}),new m(e.ns_tts,"textCombine","none",["span"],!0,!0,function(b){b=b.split(" ");return 1!==b.length||"none"!==b[0]&&"all"!==b[0]?null:[b[0]]},null),new m(e.ns_tts,"textDecoration","none",["span"],!0,!0,function(b){return b.split(" ")},null),new m(e.ns_tts,
"textEmphasis","none",["span"],!0,!0,function(b){b=b.split(" ");var d={style:null,symbol:null,color:null,position:null},e;for(e in b)if("none"===b[e]||"auto"===b[e])d.style=b[e];else if("filled"===b[e]||"open"===b[e])d.style=b[e];else if("circle"===b[e]||"dot"===b[e]||"sesame"===b[e])d.symbol=b[e];else if("current"===b[e])d.color=b[e];else if("outside"===b[e]||"before"===b[e]||"after"===b[e])d.position=b[e];else if(d.color=k.parseColor(b[e]),null===d.color)return null;null==d.style&&null==d.symbol?
d.style="auto":(d.symbol=d.symbol||"circle",d.style=d.style||"filled");d.position=d.position||"outside";d.color=d.color||"current";return d},null),new m(e.ns_tts,"textOutline","none",["span"],!0,!0,function(b){if("none"===b)return b;var d={};b=b.split(" ");if(0===b.length||2<b.length)return null;var e=k.parseColor(b[0]);d.color=e;null!==e&&b.shift();if(1!==b.length)return null;b=k.parseLength(b[0]);if(!b)return null;d.thickness=b;return d},function(b,e,m,p,t){if("none"===p)return p;e={};e.color=null===
p.color?m.styleAttrs[d.byName.color.qname]:p.color;e.thickness=k.toComputedLength(p.thickness.value,p.thickness.unit,m.styleAttrs[d.byName.fontSize.qname],m.styleAttrs[d.byName.fontSize.qname],b.cellLength.h,b.pxLength.h);return null===e.thickness?null:e}),new m(e.ns_tts,"textShadow","none",["span"],!0,!0,k.parseTextShadow,function(b,e,m,p){if("none"===p)return p;e=[];for(var n in p){var q={};q.x_off=k.toComputedLength(p[n][0].value,p[n][0].unit,null,m.styleAttrs[d.byName.fontSize.qname],null,b.pxLength.w);
if(null===q.x_off)return null;q.y_off=k.toComputedLength(p[n][1].value,p[n][1].unit,null,m.styleAttrs[d.byName.fontSize.qname],null,b.pxLength.h);if(null===q.y_off)return null;if(null===p[n][2])q.b_radius=0;else if(q.b_radius=k.toComputedLength(p[n][2].value,p[n][2].unit,null,m.styleAttrs[d.byName.fontSize.qname],null,b.pxLength.h),null===q.b_radius)return null;q.color=null===p[n][3]?m.styleAttrs[d.byName.color.qname]:p[n][3];e.push(q)}return e}),new m(e.ns_tts,"unicodeBidi","normal",["span","p"],
!1,!0,function(b){return b},null),new m(e.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,function(b){return b},null),new m(e.ns_tts,"wrapOption","wrap",["span"],!0,!0,function(b){return b},null),new m(e.ns_tts,"writingMode","lrtb",["region"],!1,!0,function(b){return b},null),new m(e.ns_tts,"zIndex","auto",["region"],!1,!0,function(b){"auto"!==b&&(b=parseInt(b),isNaN(b)&&(b=null));return b},null),new m(e.ns_ebutts,"linePadding","0c",["p"],!0,!1,k.parseLength,function(b,d,e,
m,q){return k.toComputedLength(m.value,m.unit,null,null,b.cellLength.w,null)}),new m(e.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,function(b){return b},null),new m(e.ns_smpte,"backgroundImage",null,["div"],!1,!1,function(b){return b},null),new m(e.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,function(b){return"true"===b?!0:!1},null),new m(e.ns_itts,"fillLineGap","true",["p"],!0,!0,function(b){return"true"===b?!0:!1},null)];d.byQName={};for(var q in d.all)d.byQName[d.all[q].qname]=
d.all[q];d.byName={};for(var r in d.all)d.byName[d.all[r].name]=d.all[r]})("undefined"===typeof k?this.imscStyles={}:k,"undefined"===typeof imscNames?e("./names"):imscNames,"undefined"===typeof imscUtils?e("./utils"):imscUtils)},{"./names":5,"./utils":7}],7:[function(e,r,k){(function(d){var e=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,k=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,r=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,N={transparent:[0,0,0,0],black:[0,
0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};d.parseColor=function(b){var d,m=null,p=N[b.toLowerCase()];void 0!==p?m=p:null!==(d=e.exec(b))?m=[parseInt(d[1],16),parseInt(d[2],
16),parseInt(d[3],16),void 0!==d[4]?parseInt(d[4],16):255]:null!==(d=k.exec(b))?m=[parseInt(d[1]),parseInt(d[2]),parseInt(d[3]),255]:null!==(d=r.exec(b))&&(m=[parseInt(d[1]),parseInt(d[2]),parseInt(d[3]),parseInt(d[4])]);return m};var K=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%|rh|rw)$/;d.parseLength=function(b){var d,e=null;null!==(d=K.exec(b))&&(e={value:parseFloat(d[1]),unit:d[2]});return e};d.parseTextShadow=function(b){b=b.split(",");var e=[],k;for(k in b){var m=b[k].split(" ");if(1===m.length&&
"none"===m[0])return"none";if(1<m.length&&5>m.length){var q=[null,null,null,null],r=d.parseLength(m.shift());if(null===r)return null;q[0]=r;r=d.parseLength(m.shift());if(null===r)return null;q[1]=r;if(0!==m.length&&(r=d.parseLength(m[0]),null!==r&&(q[2]=r,m.shift()),0!==m.length)){m=d.parseColor(m[0]);if(null===m)return null;q[3]=m}e.push(q)}}return e};d.parsePosition=function(b){b=b.split(" ");var e=function(b){return"center"===b||"left"===b||"top"===b||"bottom"===b||"right"===b};if(4<b.length)return null;
for(var k in b)if(!e(b[k])){var m=d.parseLength(b[k]);if(null===m)return null;b[k]=m}k={h:{edge:"left",offset:{value:50,unit:"%"}},v:{edge:"top",offset:{value:50,unit:"%"}}};for(m=0;m<b.length;){var q=b[m++];if(e(q)){var r={value:0,unit:"%"};2!==b.length&&m<b.length&&!e(b[m])&&(r=b[m++]);"right"===q?(k.h.edge=q,k.h.offset=r):"bottom"===q?(k.v.edge=q,k.v.offset=r):"left"===q?k.h.offset=r:"top"===q&&(k.v.offset=r)}else if(1===b.length||2===b.length)1===m?k.h.offset=q:k.v.offset=q;else return null}return k};
d.ComputedLength=function(b,d){this.rw=b;this.rh=d};d.ComputedLength.prototype.toUsedLength=function(b,d){return b*this.rw+d*this.rh};d.ComputedLength.prototype.multiply=function(b,d){return d?b*d:b};d.ComputedLength.prototype.isZero=function(){return 0===this.rw&&0===this.rh};d.toComputedLength=function(b,e,k,m,q,r){return"%"===e&&m?new d.ComputedLength(m.rw*b/100,m.rh*b/100):"em"===e&&k?new d.ComputedLength(k.rw*b,k.rh*b):"c"===e&&q?new d.ComputedLength(b*q.rw,b*q.rh):"px"===e&&r?new d.ComputedLength(b*
r.rw,b*r.rh):"rh"===e?new d.ComputedLength(0,b/100):"rw"===e?new d.ComputedLength(b/100,0):null}})("undefined"===typeof k?this.imscUtils={}:k)},{}]},{},[4])(4)});
